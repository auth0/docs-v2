---
title: User Authentication
description: Learn how to use Auth for MCP to seamlessly authenticate users in MCP-based applications.
mode: "wide"
---

Authentication is the process of proving a user’s identity before granting them access to a resource. In this quickstart, you’ll learn how to bring [Universal Login](https://auth0.com/docs/authenticate/login/auth0-universal-login) to your MCP-based applications and leverage OAuth 2.0 and OpenID Connect to securely authenticate users.

When a user authenticates with an identity provider through Auth0, Auth0 can pass user information to the MCP server in order to allow the user to access the appropriate tools and resources.

By the end of this quickstart, you should have an MCP server that can:

* Let users sign up and log in using a username and password or a Google account.  
* Authenticate and authorize users using OAuth 2.0 and OpenID Connect.  
* Let users use specific tools based on their roles.

## Pre-requisites

<Steps>
  <Step title="Create or log in to your Auth0 Account">
      To continue with this quickstart, you need to have an [Auth0 account](https://auth0.com/signup).
  </Step>
  <Step title="Enable your Tenant to use the Resource Parameter Compatibility Profile">
      To use the `resource` parameter in your access tokens, you need to enable the compatibility profile

      1. Navigate to Settings and click on the **Advanced** tab  
      2. Scroll down to the Settings section, find and enable **Resource Parameter Compatibility Profile**.
      <Frame>
        <img
          className="hidden dark:block"
          src="/img/mcp/enable_resource_param_compatibility_dark.png"
          alt="Resource Parameter Compatibility Profile enabled"
        />
        <img
          className="block dark:hidden"
          src="/img/mcp/enable_resource_param_compatibility_light.png"
          alt="Resource Parameter Compatibility Profile enabled"
        />
      </Frame>
      Resource Parameter Compatibility Profile is available under the Early Access program. Go to the [Early Access section](/mcp/intro/overview#early-access) to learn how to gain access.
      FreePlay Toronto Retro Arcade Bar
  </Step>
  <Step title="Install the Auth0 CLI ">
      This guide uses [Auth0 CLI](https://auth0.github.io/auth0-cli/) to configure an Auth0 tenant for secure MCP tool access.
      1. Follow the [Auth0 CLI installation instructions](https://auth0.github.io/auth0-cli/).  
      2. Log in to your account with the Auth0 CLI:
        ```shell wrap lines
        auth0 login --scopes "read:client_grants,create:client_grants,delete:client_grants,read:clients,create:clients,update:clients,read:resource_servers,create:resource_servers,update:resource_servers,read:roles,create:roles,update:roles,update:tenant_settings,read:connections,update:connections"
        ```

        Confirm you are in the correct tenant by double-checking on the terminal the tenant domain, or run the command below:

        ```shell
        auth0 tenants list
        ```

        If more than one tenant is configured, the default tenant will be indicated by an arrow.
  </Step>
</Steps>


## Configure Tenant Settings

To allow third-party clients like [MCP inspector](https://modelcontextprotocol.io/docs/tools/inspector) to use a connection like username-and-password or a social connection, you need to promote the connection to a domain level. [Learn more about enabling third-party applications](https://auth0.com/docs/get-started/applications/confidential-and-public-applications/enable-third-party-applications).

<Steps>
  <Step title="List your connection">
    List your connections to get their IDs
    ```shell
    auth0 api get connections
    ```
  </Step>
  <Step title="Choose your connections">
    From the list, identify which connections you want to use for the MCP server and copy the ID.  
      * For the username and password database, look for the connection with the strategy `auth0`.  
      * For Google social connection, look for the connection with the strategy `google-oauth2`.  
  </Step>
  <Step title="Upgrade the connection to domain-level">
    For each of those specific connection IDs, run the following command to mark it as a domain-level connection. Replace `YOUR_CONNECTION_ID` with the actual ID (e.g., `con_XXXXXXXXXXXXXXXX`)

    ```shell wrap lines
    auth0 api patch connections/YOUR_CONNECTION_ID --data '{"is_domain_connection": true}'
    ```
  </Step>
</Steps>

## Create an API to Represent Your MCP Server

The API (also known as a Resource Server) represents your protected MCP Server and sets it as the default for your tenant.

```shell wrap lines

auth0 api post resource-servers --data '{
  "identifier": "http://localhost:3001/",
  "name": "MCP Tools API",
  "signing_alg": "RS256",
  "token_dialect": "rfc9068_profile_authz",
  "enforce_policies": true,
  "scopes": [
    {"value": "tool:whoami", "description": "Access the WhoAmI tool"},
    {"value": "tool:greet", "description": "Access the Greeting tool"}
  ]
}'
```

Note that `rfc9068_profile_authz` is used instead of ` rfc9068_profile` as the [token dialect](https://auth0.com/docs/get-started/apis/enable-role-based-access-control-for-apis#token-dialect-options) to enable RBAC.

## Configure Roles and Permissions

The sample application in this quickstart is prepared to show different tools depending on the role of a given user. For example an Tool Administrator will have access to different tools from an Tool User.

If your application doesn’t require that level of access, i.e. all users have access to available tools, this step is not required for your use case.

Let’s create roles that allow you to control which users can access which tools.

### Create roles

For each role you need (e.g., "Tool Administrator", "Tool User"), run the create command as below.

```shell wrap lines
# Example for an admin role
auth0 roles create --name "Tool Administrator" --description "Grants access to all MCP tools"

# Example for a basic user role
auth0 roles create --name "Tool User" --description "Grants access to basic MCP tools"
```

Save the ID from the output (they start with `rol_`) as you’ll need them for the next step.

### Assign permissions to roles

After creating roles, assign the API permissions to it:

```shell wrap lines
# Example for admin role (all scopes)
auth0 roles permissions add YOUR_ADMIN_ROLE_ID --api-id "http://localhost:3001/" --permissions "tool:whoami,tool:greet"

# Example for user role (one scope)
auth0 roles permissions add YOUR_USER_ROLE_ID --api-id "http://localhost:3001/" --permissions "tool:whoami"
```

### Assign Roles to Users

Find users and assign them to the roles. You can search by their email address:

```shell wrap lines
auth0 users search --query "email:\"example@google.com\""
```

Copy the user ID (`USERID`) from last command’s output then assign the role to the user:

```shell wrap lines
auth0 users roles assign "USER_ID_HERE" --roles "YOUR_ROLE_ID_HERE"
```

## Clone the sample app

Clone the repository and navigate to the correct folder:

```shell wrap lines
git clone https://github.com/auth0-samples/auth0-ai-samples.git
cd auth0-ai-samples/auth-for-mcp/fastmcp-mcp-js
```

This repository contains the code for various MCP servers examples, for this quickstart you are going to use the FastMCP MCP Server with Auth0 Integration in JavaScript.

## Install packages

Ensure you have npm installed or follow the instructions to [install npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm) in its documentation. In the `fastmcp-mcp-js` directory, install the required packages:

```shell
npm install
```

## Create your environment file

In the `fastmcp-mcp-js` directory, create a new `.env` file and add the following content:

```shell
AUTH0_DOMAIN=<your-auth0-domain>
AUTH0_AUDIENCE=http://localhost:3001
PORT=3001
MCP_SERVER_URL=http://localhost:3001
```

To get your Auth0 application’s `AUTH0_DOMAIN`, run the following command:

```shell
auth0 tenants list
```

Copy the domain under `TENANT` from the output and update the corresponding variable on the `.env`.

## Run your application

Run this command to start your server:

```shell
npm run start
```

## Create an Application to Represent Your MCP Client

The MCP client will provide the interface to connect to your MCP server. For this quickstart we will use [MCP Inspector](https://modelcontextprotocol.io/docs/tools/inspector) as our client.

Run this command to create the client:

```shell wrap lines
auth0 api post clients --data '{
  "name": "MCP Inspector",
  "app_type": "non_interactive",
  "is_first_party": false,
  "callbacks": ["http://localhost:6274/oauth/callback"],
  "grant_types": ["authorization_code"],
  "token_endpoint_auth_method": "client_secret_post",
  "logo_uri": "https://avatars.githubusercontent.com/u/182288589"
}' | jq -r '"\nClient ID:     " + .client_id + "\nClient Secret:     " +  .client_secret'
```

Save the `Client ID` and `Client Secret` from the command output.

## Run your MCP client and log in

Now, with your server running in a separate terminal window, run the [MCP Inspector](https://modelcontextprotocol.io/docs/tools/inspector):

```shell
npx @modelcontextprotocol/inspector@latest
```

This will open the MCP Inspector interface on your default browser.

<Frame>
  <img
    src="/img/mcp/mcp_inspector_configured.png"
    alt="MCP Inspector page after running it"
  />
</Frame>

In the MCP Inspector, select `Streamable HTTP` as the **Transport Type** and enter `http://localhost:3001/mcp` as the URL.

Open the Authentication menu on the navigation menu on the left, and add the `Client ID` and `Client Secret` from the [client creation step](#create-an-application-to-represent-your-mcp-client) in the corresponding fields and click **Connect.**

When you connect to the server for the first time you will be guided through the authentication process using the Auth0 Universal Login. You’ll see the consent screen where you can check the tools you have access:

<Frame>
  <img
    class="img-sizing"
    src="/img/mcp/consent_screen_while_logging_in.png"
    alt="Consent modal while authenticating"
  />
</Frame>

Use the same user you gave access to the tools in the previous step. You can sign in with that account on future visits.

<Info>If you don’t see tools listed on the consent screen that’s because you are not logging in with the correct user</Info>

<Frame>
  <img
    src="/img/mcp/mcp_inspector_after_login.png"
    alt="MCP Inspector page after running it"
  />
</Frame>

Below you find the code for the server configuration:

```javascript wrap lines
import "dotenv/config";

import { FastMCP } from "fastmcp";
import { FastMCPAuthSession } from "./types.js";
import { MCP_TOOL_SCOPES, registerTools } from "./tools.js";
import { authenticate } from "./auth0.js";

const PORT = parseInt(process.env.PORT ?? "3001", 10);
const AUTH0_DOMAIN = process.env.AUTH0_DOMAIN as string;
const AUTH0_AUDIENCE = process.env.AUTH0_AUDIENCE as string;

export const server = new FastMCP<FastMCPAuthSession>({
  name: "FastMCP Auth0 Example Server",
  version: "1.0.0",
  authenticate,
  oauth: {
    enabled: true,
    protectedResource: {
      resource: AUTH0_AUDIENCE,
      authorizationServers: [`https://${AUTH0_DOMAIN}/`],
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
    authorizationServer: {
      issuer: `https://${AUTH0_DOMAIN}/`,
      authorizationEndpoint: `https://${AUTH0_DOMAIN}/authorize`,
      tokenEndpoint: `https://${AUTH0_DOMAIN}/oauth/token`,
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      responseTypesSupported: ["code"],
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
  },
});

const start = async () => {
  registerTools(server);

  try {
    await server.start({
      transportType: "httpStream",
      httpStream: {
        port: PORT,
        endpoint: "/mcp",
        stateless: true,
      },
    });
  } catch (err) {
    console.error(err);
    process.exit(1);
  }
};

start();
```

Let’s break it down.

The FastMCP will call the `authenticate` function [implemented here](https://github.com/auth0-samples/auth0-ai-samples/blob/main/auth-for-mcp/fastmcp-mcp-js/src/auth0.ts) to authenticate the request before creating a new session.

```javascript highlight={5}
// ...
export const server = new FastMCP<FastMCPAuthSession>({
  name: "FastMCP Auth0 Example Server",
  version: "1.0.0",
  authenticate,
  oauth: {
    enabled: true,
    protectedResource: {
      resource: AUTH0_AUDIENCE,
      authorizationServers: [`https://${AUTH0_DOMAIN}/`],
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
    authorizationServer: {
      issuer: `https://${AUTH0_DOMAIN}/`,
      authorizationEndpoint: `https://${AUTH0_DOMAIN}/authorize`,
      tokenEndpoint: `https://${AUTH0_DOMAIN}/oauth/token`,
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      responseTypesSupported: ["code"],
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
  },
});

// ...
```

The `oauth` configuration implements the OAuth server discovery by enabling the RFC-compliant OAuth endpoints

* Only active when server runs with HTTP-based transports (`httpStream` or `SSE`)  
* Ignored completely for `stdio` transport layer

```javascript highlight={6-21}
// ...
export const server = new FastMCP<FastMCPAuthSession>({
  name: "FastMCP Auth0 Example Server",
  version: "1.0.0",
  authenticate,
  oauth: {
    enabled: true,
    protectedResource: {
      resource: AUTH0_AUDIENCE,
      authorizationServers: [`https://${AUTH0_DOMAIN}/`],
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
    authorizationServer: {
      issuer: `https://${AUTH0_DOMAIN}/`,
      authorizationEndpoint: `https://${AUTH0_DOMAIN}/authorize`,
      tokenEndpoint: `https://${AUTH0_DOMAIN}/oauth/token`,
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      responseTypesSupported: ["code"],
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
  },
});
// ...
```

The `protectedResource` configuration is responsible for exposing the `/.well-known/oauth-protected-resource` endpoint and tells OAuth clients:

* What resource they're accessing (audience)  
* Which authorization servers can issue valid tokens  
* Where to find public keys for token verification

```javascript highlight={8-13}
// ...
export const server = new FastMCP<FastMCPAuthSession>({
  name: "FastMCP Auth0 Example Server",
  version: "1.0.0",
  authenticate,
  oauth: {
    enabled: true,
    protectedResource: {
      resource: AUTH0_AUDIENCE,
      authorizationServers: [`https://${AUTH0_DOMAIN}/`],
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
    authorizationServer: {
      issuer: `https://${AUTH0_DOMAIN}/`,
      authorizationEndpoint: `https://${AUTH0_DOMAIN}/authorize`,
      tokenEndpoint: `https://${AUTH0_DOMAIN}/oauth/token`,
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      responseTypesSupported: ["code"],
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
  },
});
// ...
```

The `authorizationServer` configuration is responsible for exposing the `/.well-known/oauth-authorization-server`: This enables backward compatibility for clients that expect authorization server metadata to be available directly from this MCP server

```javascript highlight={14-21}
// ...
export const server = new FastMCP<FastMCPAuthSession>({
  name: "FastMCP Auth0 Example Server",
  version: "1.0.0",
  authenticate,
  oauth: {
    enabled: true,
    protectedResource: {
      resource: AUTH0_AUDIENCE,
      authorizationServers: [`https://${AUTH0_DOMAIN}/`],
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
    authorizationServer: {
      issuer: `https://${AUTH0_DOMAIN}/`,
      authorizationEndpoint: `https://${AUTH0_DOMAIN}/authorize`,
      tokenEndpoint: `https://${AUTH0_DOMAIN}/oauth/token`,
      jwksUri: `https://${AUTH0_DOMAIN}/.well-known/jwks.json`,
      responseTypesSupported: ["code"],
      scopesSupported: ["openid", "profile", "email", ...MCP_TOOL_SCOPES],
    },
  },
});
// ...
```

## Run your tools

Users with the **Tool User** role will only see the `whoami` tool:

<Frame>
  <img
    src="/img/mcp/tools_list_tool_user_role.png"
    alt="List of tools for an user with the Tool User role"
  />
</Frame>

Whereas users with the **Tool Administrator** role will see both the `greet` and the `whoami` tools:  

<Frame>
  <img
    src="/img/mcp/tools_list_tool_administrator_role.png"
    alt="List of tools for an user with the Tool Administrator role"
  />
</Frame>

Now, click on the tool you want to use and **Run Tool**.

<Frame>
  <img
    src="/img/mcp/whoami_tool_call_through_mcp_inspector.png"
    alt="WhoAmI tool call response in MCP Inspector"
  />
</Frame>

## Next steps

* To learn how to enable Dynamic Client Registration (DCR), complete the [Metadata Discovery and Client Registration](./metadata-discovery-and-client-registration) quickstart.
* Learn more about [User Authentication](/mcp/intro/user-authentication).
