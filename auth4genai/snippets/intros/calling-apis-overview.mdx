import { CustomTocs } from "/snippets/common/tocs.mdx";
import { OverviewTocs } from "/snippets/common/overview-tocs.mdx";

## Why using this feature

- Secure delegation: OAuth/OIDC + Token Vault
- One flow, many providers: Works across Google/Microsoft/Slack/Salesforce, etc.
- Less plumbing: Agents/tools call APIs without custom token handling.

<CodeGroup>

```javascript src/lib/auth0-ai.ts
import { Auth0AI } from "@auth0/ai-langchain";

const auth0AI = new Auth0AI();

export const withGoogleCalendar = auth0AI.withTokenForConnection({
  connection: "google-oauth2",
  scopes: ["https://www.googleapis.com/auth/calendar.freebusy"],
});
```

</CodeGroup>

## How it works

Generative AI apps and agents often need to call third-party APIs to fulfill user requests—for example:
- A sales assistant might read a user’s calendar to schedule a meeting
- Access documents to summarize them.
- Query a CRM like Salesforce for customer info.

Auth0 AI – Calling APIs provides a secure, consistent way for agents to act on a user’s behalf.

<Frame>
<img
  className="block dark:hidden"
  src="https://cdn.auth0.com/website/auth0-ai/assets/diagrams/calling-apis-light.png"
  alt="Calling APIs"
/>

<img
  className="hidden dark:block"
  src="https://cdn.auth0.com/website/auth0-ai/assets/diagrams/calling-apis.png"
  alt="Calling APIs"
/>
</Frame>

<Steps>
  <Step title="User request to AI Agent">
    In this first step, the user initiates the flow by making a natural language request to the AI agent. The request is a plain-text instruction like: “Add doctor’s appointment next Friday, 2 p.m.”
    - Intent Expression: The user communicates what they want done (create an appointment) in natural language, without needing to interact with the calendar directly.
    - Input Capture: The AI Agent receives this request and extracts the key details — event type (doctor’s appointment), date (next Friday), and time (2 p.m.).

    This step sets the stage for the AI Agent to process the request and decide which tool to use.
  </Step>
  <Step title="AI Agent Decides to Use Calendar Tool">
    After receiving the user’s request, the AI Agent processes the input and determines the next action.
    - Intent Understanding: The AI Agent recognizes that the request is about creating a calendar event, not just storing text or performing another task.
    - Tool Selection: Based on this understanding, it decides the appropriate action is to call the Add to Calendar Tool, which is responsible for interfacing with the calendar system.

    This decision moves the flow from simple text interpretation into executing the right tool to fulfill the user’s intent.
  </Step>
  <Step title="User Authentication and Consent">
    When the Add to Calendar Tool checks authorization, Auth0 AI validates the user in two steps:
    - **Authentication**: Redirects the user to their Identity Provider (e.g., Google, Microsoft).
    May enforce MFA, passwordless login, or risk-based checks.
    Ensures the request comes from a verified, legitimate user.
    - **Consent**: Presents a screen with the requested OAuth scopes (e.g., add/manage calendar events).

    The user approves or denies access; approval grants the AI Agent permission to act. Consent is recorded, and Auth0 AI exchanges tokens tied to the approved scopes.
  </Step>
  <Step title="Token Exchange">
    After authentication and consent, the final step is Token Exchange, where Auth0 AI enables secure access to third-party APIs without exposing sensitive credentials.
    - Exchange a valid Auth0 refresh token for a federated access token from Token Vault.
    - Securely obtain the credentials needed to call the third-party API.
    - Allow users to continue without having to re-authenticate.
    - Remove the need for your application to store or manage sensitive credentials.
  </Step>
  <Step title="Call Calendar API with Access Token">
    Once a valid Calendar API Access Token (AT) has been obtained through the Token Exchange, the Add to Calendar tool can perform its core function:
    - Call the Calendar API: The tool uses the Calendar API AT to authenticate requests.
    - Add Events: It creates new calendar events on behalf of the user (e.g., meetings, reminders).
    - Security: The access token ensures that only the approved, scope-limited actions (like adding events) can be performed.
    - Outcome: Events are successfully added to the user’s calendar without requiring them to re-enter credentials or manually interact with the calendar provider.
  </Step>
  <Step title="Event Confirmation">
    After the event is added to the calendar, the system completes the flow by confirming the result back to the user.
    - API Response: The Calendar API returns a confirmation (event ID, details, and status).
    - Tool Notification: The Add to Calendar Tool captures this response and passes it back to the AI Agent.
    - AI Agent Reply: The AI Agent turns the confirmation into a clear, user-friendly message (e.g., “Doctor’s appointment added”).
    - Outcome: The flow ends with a verified, human-readable confirmation that the event is successfully on the user’s calendar.
  </Step>

</Steps>

## Get started

To begin using Auth0 for calling your APIs in your GenAI applications, refer to the following resources:

<Columns>
  <Card
    title="Calling first-party APIs"
    horizontal
    href="/calling-apis/langgraph/get-started/call-your-apis-on-users-behalf"
  >
    Learn how Auth for GenAI enables AI agents to call first-party APIs on the user’s behalf.
  </Card>
  <Card
    title="Calling third-party Party APIs"
    horizontal
    href="/calling-apis/langgraph/get-started/call-others-apis-on-users-behalf"
  >
    Learn how Auth for GenAI enables AI agents to call other’s APIs on the user’s behalf.
  </Card>
</Columns>

## How-Tos

<Columns>
  <Card
    title="Check Google Calendar Availability"
    horizontal
    href="/calling-apis/langgraph/how-tos/check-google-calendar-availability"
  >
    Use OpenAI, NextJS, and the Auth0-AI SDKs to check your Google Calendar availability.
  </Card>
  <Card
    title="List GitHub Repositories"
    horizontal
    href="/calling-apis/langgraph/how-tos/list-github-repositories"
  >
    Use OpenAI, NextJS, and the Auth0-AI SDKs to list your GitHub repositores
  </Card>
  <Card
    title="List Slack Channels"
    horizontal
    href="/calling-apis/langgraph/how-tos/list-slack-channels"
  >
    Use OpenAI, NextJS, and the Auth0-AI SDKs to list your Slack channels
  </Card>
</Columns>

<Panel>
  <OverviewTocs
    sections={[
      {
        title: "SDKs",
        links: [
          { label: "Auth0 AI / LangChain", href: "https://www.npmjs.com/package/@auth0/ai-langchain" },
          { label: "NextJS-Auth0", href: "https://github.com/auth0/nextjs-auth0" }
        ]
      },
      {
        title: "Learn more",
        links: [
          { label: "What is Token vault", href: "https://www.npmjs.com/package/@auth0/ai-langchain" },
          { label: "Auth0 Docs for APIs", href: "https://auth0.com/docs/get-started/apis" }
        ]
      },
      {
        title: "Integrations",
        links: [
          { label: "Google", href: "/integrations/google", target: "_self" }
        ]
      }
    ]}
  />
</Panel>
