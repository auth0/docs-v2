---
mode: wide
description: This guide demonstrates how to use Auth0 Actions Modules
sidebarTitle: Write Your First Action Module
title: Write Your First Action Module
---

import {AuthCodeGroup} from "/snippets/AuthCodeGroup.jsx";

## Get Started

This quickstart demonstrates how to add Auth0 authentication to a React application. You'll build a secure single-page app with login, logout, and user profile features using the Auth0 React SDK.

Starting from the based on [Goal 1](#goal-1:-notify-slack-on-user-login), now you are creating an Action Module that sends a logs to an external service from multiple Actions.

<Steps>
  <Step title="Create an Action Module" stepNumber={1}>
    To use an Action Module from an specific Action, you first need to create the Action Module and then add/use it in an Action.

    <Tabs>
      <Tab title="Dashboard">
        1. Navigate to [Auth0 Dashboard > Actions > Library](https://manage.auth0.com/#/actions/library) then select **Modules**.
        2. Select **Create Module**.
        2. Enter a **Name** and select **Create**.

        The Code Editor appears:

        <Frame>![Actions Modules Code Editor](/docs/images/customize/actions/modules/actions-modules-editor.png)</Frame>
      </Tab>
      <Tab title="Management API">
      </Tab>
      <Tab title="Terraform">
      </Tab>
    </Tabs>
  </Step>
  <Step title="Add Custom Logic" stepNumber={2}>
    Now, let’s write some code!

    Add the following code to your Action Module:

    ```javascript lines
    module.exports = {
      sendLog: async (code, message) => {
        try {
          await fetch(actions.secrets.SERVICE_URL, {
            method: 'POST',
            headers: {
              'X-API-Key': actions.secrets.API_KEY,
            },
            body: JSON.stringify({
              code,
              message
            }),
          });
        } catch (err) {
          throw new Error('External service failure');
        }

        return;
      }
    };
    ```
  </Step>
  <Step title="Add a Secret" stepNumber={3}>
    Next up, you need to create a new app on your Auth0 tenant and add the environment variables to your project.

    You can choose to do this automatically by running a CLI command or do it manually via the Dashboard:

    Each Action Module can contain Secret key/values pairs, which are suitable for holding sensitive information, such as API Keys, Certificates, and also values that may change across environments.

    Let’s store the external service URL as a Secret.

    1. Select the Key Icon from the code editor's left sidebar
    2. Select **Add Secret**.
    3. Give the Secret the following name: `SERVICE_URL`.
    4. Paste in the external service URL.
    5. Select **Create**.

    You’ll see that the Secret has been added to the Action and you can use the new secret via intelligent code complete by typing `actions.secrets`.

    <Frame>![Actions Modules Code Editor - Your Secret has been added in the Secrets section.](/docs/images/customize/actions/modules/actions-modules-secret.png)</Frame>

    <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

    Once a Secret has been created, its value will never be revealed. Auth0 encrypts all Secrets and stores them securely.

    </Callout>

    Let's repeat the steps to store an API_KEY to be sent in the headers to the external service, if it's required.
  </Step>
  <Step title="Save the Draft" stepNumber={4}>
    Select **Save Draft**. Your Action is saved, but it won’t be executed as part of any user flows yet. With Actions, you have the opportunity to create, edit, and test Actions before they affect any traffic in your Auth0 tenant. Once you’re happy with the behavior of the Action, you’ll deploy the Action and add it to a Flow later.
  </Step>
  <Step title="Publish the Action Module" stepNumber={6}>
    Now that we’re satisfied that the Action is working as expected, it’s time to deploy it.

    Select **Deploy**. Deploying an Action takes a snapshot of the Action at that time and records it as an **Action Version**.

    Select **Version History**, and you should see the Action recorded as Version 1:

    <Frame>![Actions: Version History](/docs/images/cdy7uua7fh8z/53sn70cXoxUHibc3Bmk7Og/193af512ac2b58f3d60ab36ca5499d90/Screen_Shot_2022-02-10_at_10.02.47_AM.png)</Frame>

    You are now free to update your Action and save it without affecting Version 1 of your Action. Auth0 will only execute the currently deployed version of an Action, so until you deploy an action again, Version 1 will be executed by Auth0.
  </Step>
  <Step title="Attach the Action Module to an Action" stepNumber={7}>
    The final step in configuring a new Action so that it’s executed as part of your tenant’s traffic is to attach it to a Flow.

    1. Navigate to [Auth0 Dashboard > Actions > Flows](https://manage.auth0.com/#/actions/flows) to see a list of the available Flows:
    2. Select the [Login flow](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger) and drag `my-slack-action` into the flow.

      <Frame>![Actions Flows: Login Flow](/docs/images/cdy7uua7fh8z/6hU7sKWtGzSx9Z8dhsXbvp/0253fb4e9eac1133cc9626385622c54e/Login_Action_-_English.png)</Frame>
    3. Select **Apply**.

    The Action is now running for real user traffic within your tenant. If you’d like a more robust testing environment, consider [setting up multiple Auth0 environments](/docs/get-started/auth0-overview/create-tenants/set-up-multiple-environments).
  </Step>
</Steps>

<Check>
  **Checkpoint**

  You should now have a fully functional Auth0 login page running on your [localhost](http://localhost:5173/)
</Check>

---

## Advanced Usage

<Accordion title="Add a Dependency">
  This particular example doesn't require a dependency for the Action Module, but when needed you can add dependencies to the Action Module by:

  1. Select the Dependency icon (cube icon) in the sidebar.
  2. For **Name**, enter `[NPM package name]`.
  3. For **Version**, by default, your Action Module will use the latest version of the dependency at the time the dependency was added.
  3. Select **Create**, and the Dependency should be added to the Action:

  <Frame>![Actions Code Editor: Your dependency has been added.](/docs/images/customize/actions/modules/actions-modules-dependency.png)</Frame>

  <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

  When you save this Action, the latest version of your dependency will be resolved and replaced with a specific version number to keep future updates to the package from breaking your Action.

  You can provide an spcific version to be used instead of latest.

  </Callout>
</Accordion>

<Accordion title="Debug and Observe Action Modules">
  Configure your Auth0Provider to include an API audience and use the `getAccessTokenSilently` method:

  ```jsx src/main.jsx
  import { Auth0Provider } from '@auth0/auth0-react';

  const root = ReactDOM.createRoot(document.getElementById('root'));

  root.render(
    <Auth0Provider
      domain={import.meta.env.VITE_AUTH0_DOMAIN}
      clientId={import.meta.env.VITE_AUTH0_CLIENT_ID}
      authorizationParams={{
        redirect_uri: window.location.origin,
        audience: "YOUR_API_IDENTIFIER"
      }}
    >
      <App />
    </Auth0Provider>
  );
  ```

  Then make authenticated API calls:

  ```jsx src/components/ApiCall.jsx
  import { useState } from 'react';
  import { useAuth0 } from '@auth0/auth0-react';

  function ApiCall() {
    const { getAccessTokenSilently } = useAuth0();
    const [apiResponse, setApiResponse] = useState(null);

    const callProtectedApi = async () => {
      try {
        const token = await getAccessTokenSilently();

        const response = await fetch('/api/protected', {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });

        const data = await response.json();
        setApiResponse(data);
      } catch (error) {
        console.error('API call failed:', error);
      }
    };

    return (
      <div>
        <button onClick={callProtectedApi}>Call API</button>
        {apiResponse && <pre>{JSON.stringify(apiResponse, null, 2)}</pre>}
      </div>
    );
  }

  export default ApiCall;
  ```
</Accordion>
