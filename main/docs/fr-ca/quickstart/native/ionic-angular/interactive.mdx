---
title: "Ajouter la connexion à votre application Ionic Angular avec Capacitor"
permalink: "interactive"
'description': "Ce guide explique comment intégrer Auth0 avec une application Ionic (Angular) et Capacitor en utilisant la trousse SDK Angular Auth0."
'og:title': "Ajouter la connexion à votre application Ionic Angular avec Capacitor"
'og:description': "Ce guide explique comment intégrer Auth0 avec une application Ionic (Angular) et Capacitor en utilisant la trousse SDK Angular Auth0."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/ionic.jpeg"
'twitter:title': "Ajouter la connexion à votre application Ionic Angular avec Capacitor"
'twitter:description': "Ce guide explique comment intégrer Auth0 avec une application Ionic (Angular) et Capacitor en utilisant la trousse SDK Angular Auth0."
sidebarTitle: Ionic & Capacitor (Angular)
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import AppModule from "/snippets/quickstart/native/ionic-angular/app.module.ts.mdx";
import AppComponent from "/snippets/quickstart/native/ionic-angular/app.component.ts.mdx";
import Loginbutton from "/snippets/quickstart/native/ionic-angular/login-button.ts.mdx";
import Logoutbutton from "/snippets/quickstart/native/ionic-angular/logout-button.ts.mdx";
import Userprofile from "/snippets/quickstart/native/ionic-angular/user-profile.ts.mdx";

import {AuthCodeGroup} from "/snippets/AuthCodeGroup.jsx";

export const sections = [
  { id: "démarrage", title: "Démarrage" },
  { id: "configuration-d-auth0", title: "Configuration d’Auth0" },
  { id: "installer-la-trousse-sdk-react-auth0", title: "Installer la trousse SDK React Auth0" },
  { id: "enregistrer-et-configurer-le-module-d-authentification", title: "Enregistrer et configurer le module d’authentification" },
  { id: "ajouter-une-fonctionnalité-de-connexion-à-votre-application", title: "Ajouter une fonctionnalité de connexion à votre application" },
  { id: "gérer-la-callback-de-connexion", title: "Gérer la callback de connexion" },
  { id: "ajouter-une-fonctionnalité-de-déconnexion-à-votre-application", title: "Ajouter une fonctionnalité de déconnexion à votre application" },
  { id: "afficher-le-profil-utilisateur", title: "Afficher le profil utilisateur" }
]

<Recipe>
  <Content>
    Auth0 vous permet d’ajouter rapidement l’authentification et d’accéder aux informations relatives au profil de l’utilisateur dans votre application. Ce guide explique comment intégrer Auth0 avec une application Ionic (Angular) & Capacitor en utilisant la [trousse SDK Angular Auth0](https://github.com/auth0/auth0-angular).

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Ce guide de démarrage rapide suppose que vous avez déjà une application [Ionic](https://ionicframework.com/) en cours d’exécution avec [Capacitor](https://capacitorjs.com/). Si ce n’est pas le cas, consultez [Using Capacitor with Ionic Framework guide (Utiliser Capacitor avec le cadre d’applications Ionic)](https://capacitorjs.com/docs/getting-started/with-ionic)  pour commencer avec une application simple ou clonez nos [our sample apps (exemples d’applications)](https://github.com/auth0-samples/auth0-ionic-samples).

      Vous devez également être familiarisé avec [Capacitor development workflow (le flux de production de développement Capacitor)](https://capacitorjs.com/docs/basics/workflow).
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      Pour utiliser les services Auth0, vous devez avoir une application installée dans Auth0 Dashboard. L’application Auth0 est l’endroit où vous allez configurer le fonctionnement de l’authentification pour votre projet.

      <Info>
      Tout au long de cet article, `YOUR\_PACKAGE\_ID` est l’identifiant du package de votre application. Ceci peut être trouvé et configuré dans le champ `appId` de votre fichier `capacitor.config.ts` . Voir [Capacitor’s Config schema (Schéma de configuration du Capacitor)](https://capacitorjs.com/docs/config#schema) pour plus d’informations.
      </Info>

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente le projet avec lequel vous souhaitez effectuer l’intégration. Dans Auth0, il est attribué à chaque application un identifiant client unique alphanumérique que votre code d’application utilisera pour appeler les API Auth0 via la trousse SDK.

      Tous les paramètres que vous configurez à l’aide de ce guide rapide seront automatiquement mis à jour pour votre application dans le [Dashboard](https://manage.auth0.com/#/), qui est l’endroit où vous pourrez gérer vos applications à l’avenir.

      Si vous préférez explorer une configuration complète, consultez plutôt un exemple d’application.

      ### Configurer les URL de rappel

      Une URL de rappel est une URL intégrée dans votre application vers laquelle vous souhaitez qu’Auth0 redirige les utilisateurs après leur authentification. Si elle n’est pas définie, les utilisateurs ne seront pas redirigés vers votre application après s’être connectés.

      <Info>
      Si vous suivez notre projet à titre d’exemple, définissez ceci sur :
      `YOUR\_PACKAGE\_ID://{yourDomain}/capacitor/YOUR\_PACKAGE\_ID/callback`
      </Info>

      ### Configuration des URL de déconnexion

      Une URL de déconnexion est une URL intégrée dans votre application vers laquelle vous souhaitez qu’Auth0 redirige les utilisateurs après leur déconnexion. Si elle n’est pas définie, les utilisateurs ne pourront pas se déconnecter de votre application et recevront un message d’erreur.

      <Info>
      Si vous suivez notre projet à titre d’exemple, définissez ceci sur :
      `YOUR\_PACKAGE\_ID://{yourDomain}/capacitor/YOUR\_PACKAGE\_ID/callback`
      </Info>

      ### Configurer les origines autorisées

      Pour pouvoir faire des requêtes à partir de votre application d’origine vers Auth0, définissez les **origines autorisées** dans vos [Application Settings (Paramètres d’application)](https://manage.auth0.com/#/applications/%7ByourClientId%7D/settings).

      <Info>
      Si vous suivez notre projet à titre d’exemple, définissez ceci sur `capacitor://localhost, http://localhost` pour iOS et Android respectivement.
      </Info>

      Enfin, assurez-vous que le **type d’application** pour votre application est défini sur **Native** dans les [Application Settings (Paramètres d’application)](https://manage.auth0.com/#/applications/%7ByourClientId%7D/settings).
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Exécutez la commande suivante dans le répertoire de votre projet pour installer la trousse SDK Angular Auth0 :

      `npm install @auth0/auth0-angular`

      La trousse SDK expose plusieurs types qui vous aident à intégrer Auth0 avec votre application Angular, y compris un module et un service d’authentification.

      ### Installer les plugiciels Capacitor

      Ce guide rapide et cet exemple utilisent certains des plugiciels officiels Capacitor. Installez-les dans votre application à l’aide de la commande suivante :

      `npm install @capacitor/browser @capacitor/app`

      - [`@capacitor/browser`](https://capacitorjs.com/docs/apis/browser) : Vous permet d’interagir avec le navigateur de système de l’appareil, et est utilisé pour ouvrir l’URL vers le point de terminaison d’autorisation d’Auth0.
      - [`@capacitor/app`](https://capacitorjs.com/docs/apis/app) : Vous permet de vous abonner à des événements d’application de haut niveau, utiles pour la gestion des Callbacks depuis Auth0.

      <Info>
      Le plugiciel de navigateur de Capacitor sur iOS utilise [`SFSafariViewController`](https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller), qui sur iOS 11+ ne partage pas les témoins avec Safari sur l’appareil. Cela signifie que SSO ne fonctionnera pas sur ces appareils. Si vous avez besoin de SSO, veuillez utiliser un plugiciel compatible qui utilise [ASWebAuthenticationSession](https://developer.apple.com/documentation/authenticationservices/aswebauthenticationsession).
      </Info>
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      La trousse SDK exporte `AuthModule`, un module qui contient tous les services nécessaires au fonctionnement de la trousse SDK. Ce module doit être enregistré avec votre application et être configuré avec votre domaine Auth0 et votre identifiant client.

      La fonction `AuthModule.forRoot` prend la configuration suivante :

      - `domain` : La valeur `domain` présente dans les **paramètres** de l’application que vous avez créée dans Auth0 Dashboard, ou votre domaine personnalisé si vous utilisez la fonctionnalité Domaines personnalisés d’Auth0.
      - `clientId` : La valeur de l’identifiant du client présente dans les **paramètres** de l’application que vous avez créée dans Auth0 Dashboard.
      - `useRefreshTokens` : Pour utiliser auth0-angular avec Ionic sur Android et iOS, il est nécessaire d’activer les jetons d’actualisation.
      - `useRefreshTokensFallback` : Pour utiliser auth0-angular avec Ionic sur Android et iOS, il est nécessaire de désactiver le iframe de substitution.
      - `authorizationParams.redirect_uri` : L’URL pour rediriger vos utilisateurs après qu’ils se sont authentifiés avec Auth0.

      <Warning>
      Pour conserver l’authentification après la fermeture et la réouverture de l’application, vous pouvez définir `cacheLocation` sur `localstorage` lors de la configuration du SDK, mais soyez conscient des [risques liés au stockage de jetons dans localstorage](/docs/libraries/auth0-single-page-app-sdk#change-storage-options). De plus, localstorage devrait être traité comme **transitoire** dans l’application Capacitor car les données pourraient être récupérées de façon inattendue dans certaines circonstances. Veuillez lire les [directives sur le stockage dans la documentation Capacitor](https://capacitorjs.com/docs/guides/storage#why-cant-i-just-use-localstorage-or-indexeddb).
      En outre, le SDK a la capacité [d’utiliser une implémentation de cache personnalisée](https://github.com/auth0/auth0-spa-js/blob/master/EXAMPLES.md#creating-a-custom-cache) pour stocker des jetons, si vous avez une exigence d’utiliser un mécanisme de stockage plus sûr et persistant.
      **Notez** que nous recommandons **de ne pas** utiliser le [plugiciel Capacitor pour stocker](https://capacitorjs.com/docs/apis/storage) les jetons, car cela est soutenu par [UserDefaults](https://developer.apple.com/documentation/foundation/userdefaults) et [SharedPreferences](https://developer.android.com/reference/android/content/SharedPreferences) sur iOS et Android respectivement. Les données stockées à l’aide de ces API ne sont pas cryptées, non sécurisées et peuvent également être synchronisées dans le nuage.
      </Warning>

      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré votre application avec la trousse SDK Angular Auth0, exécutez votre application pour vérifier que la trousse SDK est initialisée sans erreur et que votre application s’exécute comme auparavant.
      </Note>
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      Dans une application Capacitor, le [plugiciel de navigateur Capacitor](https://capacitorjs.com/docs/apis/browser) effectue une redirection vers la [page de connexion universelle Auth0](https://auth0.com/universal-login). Définissez le paramètre `openUrl` sur la fonction `loginWithRedirect` pour utiliser `Browser.open` de sorte que l’URL soit ouverte à l’aide du composant navigateur du système de l’appareil ([SFSafariViewController](https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller) sur iOS et les [Onglets Personnalisés Chrome](https://developer.chrome.com/docs/android/custom-tabs) sur Android).

      <Info>
      Par défaut, la méthode `loginWithRedirect` de la trousse SDK utilise `window.location.href` pour accéder à la page de connexion dans l’application de navigateur par défaut sur l’appareil de l’utilisateur plutôt que dans le composant de navigateur système approprié pour la plate-forme. L’utilisateur quitterait votre application pour s’authentifier et pourrait rendre l’expérience utilisateur sous-optimale.
      </Info>

      <Note>
      ##### Point de contrôle
      La fonction `loginWithRedirect` indique à la trousse SDK d’initier le flux de connexion, en utilisant la fonction `Browser.open` pour ouvrir l’URL de connexion avec le composant navigateur du système de la plateforme en définissant le paramètre `openUrl`. Cela permet à votre utilisateur de se connecter à votre application. Les utilisateurs sont redirigés vers la page de connexion à Auth0 et ne reçoivent aucune erreur.
      </Note>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      Une fois que les utilisateurs sont connectés avec la page de connexion universelle, ils sont redirigés vers votre application via une URL avec un schéma d’URL personnalisé. L’événement `appUrlOpen` doit être géré depuis votre application. Vous pouvez appeler la méthode `handleRedirectCallback` depuis la trousse SDK Auth0 pour initier l’état de l’authentification.

      Vous pouvez utiliser cette méthode uniquement sur une redirection depuis Auth0. Pour vérifier le succès, vérifiez la présence du `code` et des paramètres `state` dans l’URL.

      La méthode `Browser.close()` devrait fermer le navigateur lorsque cet événement est déclenché.

      Notez que la callback de l’événement `appUrlOpen` est enveloppé dans `ngZone.run`. Les modifications aux observables survenant lorsque `handleRedirectCallback` est exécuté sont détectées par l’application Angular. Pour en savoir plus sur cette fonctionnalité, veuillez consulter [Utiliser Angular avec Capacitator](https://capacitorjs.com/docs/guides/angular). Sinon, l’écran ne se met pas à jour pour afficher l’état authentifié après la connexion.

      <Info>
      Cet article suppose que vous utiliserez des schémas d’URL personnalisés pour gérer le rappel dans votre application. Pour ce faire, enregistrez votre `YOUR\_PACKAGE\_ID` comme schéma d’URL pour la plateforme de votre choix. Pour en savoir plus, lire [Defining a Custom URL Scheme (Définition d’un schéma d’URL personnalisé)](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) pour iOS ou [Create Deep Links to App Content (Création de liens profonds vers le contenu des applications)](https://developer.android.com/training/app-links/deep-linking) pour Android.
      </Info>

      <Note>
      ##### Point de contrôle
      Ajoutez `appUrlOpen` au composant `App` de votre application et connectez-vous. La fenêtre du navigateur devrait se fermer une fois que l’utilisateur s’authentifie et se connecte à votre application.
      </Note>
      </Section>

      <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      Maintenant que les utilisateurs peuvent se connecter, vous devez configurer une façon de se déconnecter. Les utilisateurs doivent être redirigés vers le point de terminaison de déconnexion Auth0 dans le navigateur pour effacer leur session de navigation. Encore une fois, le plugiciel du navigateur de Capacitor doit effectuer cette redirection afin que l’utilisateur ne quitte pas votre application et ne vive pas une expérience frustrante.

      Pour y parvenir avec Ionic et Capacitor en conjonction avec le SDK Auth0 :

      - Créez l’URL de votre application vers laquelle Auth0 doit rediriger après la déconnexion. Il s’agit d’une URL qui utilise votre schéma personnalisé enregistré et le domaine Auth0. Ajoutez-la à votre configuration **URL de déconnexions autorisées** dans Auth0 Dashboard
      - Déconnectez-vous de la trousse SDK en appelant `logout` et transmettez votre URL de redirection comme paramètre `logoutParams.returnTo`.
      - Définissez le paramètre `openUrl` sur un callback qui utilise le plugiciel de navigateur Capacitor pour ouvrir l’URL à l’aide de `Browser.open`.

      <Info>
      De la même manière que pour l’étape de connexion, si vous ne définissez pas `openUrl` lors de l’appel de `logout`, le SDK redirige l’utilisateur vers l’URL de déconnexion à l’aide de l’application de navigateur par défaut sur l’appareil, ce qui offre une expérience utilisateur sous-optimale.
      </Info>

      <Note>
      ##### Point de contrôle
      Fournir un moyen pour vos utilisateurs de se déconnecter de votre application. Vérifiez la redirection vers Auth0, puis vers l’adresse que vous avez spécifiée dans le paramètre `returnTo`. Assurez-vous que les utilisateurs ne sont plus connectés à votre application.
      </Note>
      </Section>

      <Section id={sections[7].id} title={sections[7].title} stepNumber="8">
      La trousse SDK Auth0 récupère les informations de profil associées aux utilisateurs connectés dans n’importe quel composant dont vous avez besoin, comme leur nom ou leur image de profil, pour personnaliser l’interface utilisateur. Les informations de profil sont disponibles via la propriété `user$` exposée par `AuthService`.

      <Note>
      ##### Point de contrôle
      Fournir un moyen pour que vos utilisateurs puissent voir leurs détails de profil utilisateur dans l’application et vérifiez que vous êtes en mesure de récupérer et d’afficher les informations de votre profil à l’écran une fois que vous avez ouvert une session.
      </Note>
      </Section>

    ## Étapes suivantes

    Beau travail! Si vous en êtes arrivé là, vous devriez avoir la connexion, la déconnexion et les informations de profil utilisateur actives dans votre application.

    Cela conclut notre tutoriel de démarrage rapide, mais il y a tellement plus à explorer. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    *   [Auth0 Dashboard](https://manage.auth0.com/#) : apprenez à configurer et gérer votre locataire et vos applications Auth0
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) : découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <AuthCodeGroup>
          <AppModule/>
          <AppComponent/>
          <Loginbutton/>
          <Logoutbutton/>
          <Userprofile/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <AuthCodeGroup>
          <Loginbutton/>
          <AppModule/>
          <AppComponent/>
          <Logoutbutton/>
          <Userprofile/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <AuthCodeGroup>
          <AppComponent/>
          <AppModule/>
          <Loginbutton/>
          <Logoutbutton/>
          <Userprofile/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[6].id}>
        <AuthCodeGroup>
          <Logoutbutton/>
          <AppModule/>
          <AppComponent/>
          <Loginbutton/>
          <Userprofile/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[7].id}>
        <AuthCodeGroup>
          <Userprofile/>
          <AppModule/>
          <AppComponent/>
          <Loginbutton/>
          <Logoutbutton/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
