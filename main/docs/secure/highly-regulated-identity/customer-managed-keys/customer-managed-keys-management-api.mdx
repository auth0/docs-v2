---
description: Learn how to configure Customer Managed Keys with the Management
  API
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Configure Customer Managed Keys with the Management API
'og:url': https://auth0.com/docs/
permalink: customer-managed-keys-management-api
title: Configure Customer Managed Keys with the Management API
'twitter:description': Learn how to configure Customer Managed Keys with the Management
  API
'twitter:title': Configure Customer Managed Keys with the Management API
---
Auth0 secures your tenant secrets and data using an Auth0 Environment Root Key, at the top of the envelope encryption key hierarchy.  The Auth0 Environment Root Key and Customer Provided Root Key are stored in the hardware security module (HSM) of the corresponding Auth0 Cloud Service Provider,  AWS or Azure.

## Bring Your Own Key

Using Bring Your Own Key, users with the [Key Management Editor role](/docs/get-started/manage-dashboard-access/add-dashboard-users) can use the [Auth0 Management API](https://auth0.com/docs/api/management/v2) to replace the default Auth0 Environment Root Key with their own Customer provided Root Key. Customers can securely upload their own Root Key which contains their own cryptographic material to:

* Meet custom key generation and provenance requirements for the Environment Root Key
* Meet specific key installation or lifespan requirements for the Environment Root Key
* Keep a copy of the Customer Provided Root Key on customer premises.

<Warning>

By importing your own Customer Provided Root Key with Bring Your Own Key, you are implicitly deauthorizing Auth0 from managing the lifecycle of the Customer Provided Root Key, except for its deletion.

</Warning>

You can create and manage your Customer Provided Root Key using the <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip>, following these steps:

1. Call the [Create the new encryption key](https://auth0.com/docs/api/management/v2/keys/post-encryption) endpoint to initiate the Bring Your Own Key process and obtain the `kid` (key identifier) of the pre-activated Customer Provided Root Key without cryptographic material.

   <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

   This endpoint returns the kid value which is the key’s unique identifier.

   </Callout>
2. Call the [Create the public wrapping key](https://auth0.com/docs/api/management/v2/keys/post-encryption-wrapping-key) endpoint to create and return a public wrapping key.
3. In your environment, generate your own cryptographic key material and wrap (encrypt) it with the public wrapping key to create a Wrapped Encryption Key (the Customer Provided Root Key).
4. Call the [Import the encryption key](https://auth0.com/docs/api/management/v2/keys/post-encryption-key) endpoint to import your Customer Provided Root Key to Auth0.

## Cryptographic material requirements

Use your key management system to wrap your own cryptographic material with the public wrapping key and create the Wrapped Encryption Key. Use these settings for the [CKM_RSA_AES_KEY_WRAP](https://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/cos01/pkcs11-curr-v2.40-cos01.html#_Toc408226894) algorithm parameters based on your Auth0 Cloud Service Provider (AWS or Azure):

### Auth0 on AWS cloud

* Public wrapping key length: 3072 bits
* Algorithm: CKG_MGF1_SHA256
* Temporary AES key length for CKM_AES_KEY_WRAP_PAD: 256 bits
* Customer provided root key type: 256 bits long AES symmetric key

### Auth0 on Azure cloud

* Public wrapping key length: 2048 bits
* Algorithm: CKG_MGF1_SHA-1
* Temporary AES key length for CKM_AES_KEY_WRAP_PAD: 256 bits
* Customer Provided Root Key type: 2048 bits long RSA private key
* Private key encoding: PKCS #8 - ASN.1 DER

## Permissions

Use the following permissions to provide access to the encryption keys endpoints.

<table class="table">
<thead>
<tr>
<th><b>Permissions</b></th>
<th><b>Descriptions</b></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read:encryption_keys</code></td>
<td>Users can search and retrieve keys in the Auth0 tenant. This includes reading from the <code>/api/v2/keys/encryption</code>, <code>/api/v2/keys/encryption/{kid}</code> endpoints.</td>
</tr>
<tr>
<td><code>create:encryption_keys</code></td>
<td>Users can create their own Customer Provided Root Key and Public wrapping key through the <code>/api/v2/keys/encryption</code> and <code>/api/v2/keys/encryption/{kid}/wrapping-key</code> endpoints.</td>
</tr>
<tr>
<td><code>delete:encryption_keys</code></td>
<td>Users can delete their own Customer Provided Root Key through the 
            <code>/api/v2/keys/encryption/{kid}</code> endpoint.</td>
</tr>
<tr>
<td><code>update:encryption_keys</code></td>
<td>Users can import their own Customer Provided Root Key through the 
            <code>/api/v2/keys/encryption/{kid}</code> endpoint.</td>
</tr>
</tbody>
</table>

## Endpoints

* Use the [Get all encryption keys](https://auth0.com/docs/api/management/v2/keys/get-encryption-keys) endpoint to retrieve information about the existing current Environment Root Key or Customer Provided Root Key, and Tenant Master Key.
* Use the [Get the encryption key by its key id](https://auth0.com/docs/api/management/v2/keys/get-encryption-key) endpoint to retrieve information about the specified key.
* Use the [Create the new encryption key](https://auth0.com/docs/api/management/v2/keys/post-encryption) endpoint to create a pre-activated Customer Provided Root Key placeholder.
* Use the [Create the public wrapping key](https://auth0.com/docs/api/management/v2/keys/post-encryption-wrapping-key) endpoint to retrieve a Public Wrapping key to wrap your cryptographic material.
* Use the [Import the encryption key](https://auth0.com/docs/api/management/v2/keys/post-encryption-key) endpoint to import a new Customer Provided Root Key material.
* Use the [Delete the encryption key by its key id](https://auth0.com/docs/api/management/v2/keys/delete-encryption-key) endpoint to delete an existing Customer Provided Root Key and opt out of using Bring Your Own Keys. The Auth0 Environment Root Key is used to re-encrypt the key hierarchy. This operation does not negatively impact existing data and authentication flows.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

If the Customer Managed Keys feature is not enabled in your tenant, calling the API endpoint(s) will return the error: `This feature is not enabled for this tenant`.

</Callout>