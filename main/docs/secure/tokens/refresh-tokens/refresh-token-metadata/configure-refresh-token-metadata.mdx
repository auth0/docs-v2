---
description: Learn how to configure Auth0 refresh token metadata
title: Configure Refresh Token Metadata
---

<Warning>

Refresh Token Metadata is currently in Early Access for Enterprise customers only. By using this feature, you agree to the applicable Free Trial terms in Okta's [Master Subscription Agreement](https://www.okta.com/legal). To learn more about Auth0's product release cycle, read [Product Release Stages](https://auth0.com/docs/troubleshoot/product-lifecycle/product-release-stages).

</Warning>

To configure refresh token metadata, you can use an Auth0 [Post-Login Action](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger) and the [Management API](https://auth0.com/docs/api/management/v2).

## Auth0 Post-Login Actions

You can manage refresh token metadata CRUD operations using the `api.refreshToken` objects with a [post-login Action](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger). This allows you to manage refresh token metadata based on user or context-specific logic.

### Retrieve existing refresh token metadata

Use the `event.refresh_token.metadata` object to read the refresh token metadata:

```javascript lines
const deviceName = event.refresh_token?.metadata?.deviceName;
```

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">
The `event.refresh_token.metadata` object includes metadata set in: 
	* Previous Actions within the same flow 
	* Prior transactions if the refresh token was reused during a refresh token exchange
</Callout>

### Add or update existing metadata

Use the `api.refreshToken.setMetadata()` method to set or update the refresh token metadata:

```javascript lines
api.refreshToken.setMetadata("deviceName", "Auth0's iPhone");
```

Changes are immediately available in the `event.refresh_token` object in subsequent Actions. 

### Delete refresh token metadata

Use the following `api.refreshToken` methods to delete refresh token metadata:

* `api.refreshToken.deleteMetadata("key")` deletes the specified refresh token metadata

* `api.refreshToken.evictMetadata()` deletes all refresh token metadata 

To learn more about these objects, review:

* [Event object](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-event-object): Learn about the refresh token Event object and properties.
* [API object](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-api-object): Learn about the refresh token API object and methods.

## Auth0 Management API

You can manage refresh token metadata CRUD (create, replace, update, delete) requests using the Management API:

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">
Calls to the `/api/v2/refresh-tokens/{id}` endpoint require a [Management API access token](/docs/secure/tokens/access-tokens) with the `update:refresh_tokens` scope.
</Callout>

### Retrieve existing refresh token metadata

Make a `GET` request to the [`/api/v2/refresh-tokens/{id}`](https://auth0.com/docs/api/management/v2/refresh-tokens/get-refresh-token) endpoint:

```bash lines
GET /api/v2/refresh-tokens/{id}
```

### Add or update existing refresh token metadata

Make a `PATCH` request to the [`/api/v2/refresh-tokens/{id}`](https://auth0.com/docs/api/management/v2/refresh-tokens/patch-refresh-token) endpoint:

```bash lines
PATCH /api/v2/refresh-tokens/{id}
Content-Type: application/json

{
  "refresh_token_metadata": {
    "my_metadata": "my new metadata"
  }
}
```

### Delete refresh token metadata

Make a `PATCH` request to the [`/api/v2/refresh-tokens/{id}`](https://auth0.com/docs/api/management/v2/refresh-tokens/patch-refresh-token) endpoint with an empty metadata object:

```bash lines
PATCH /api/v2/refresh-tokens/{id}
Content-Type: application/json

{
  "refresh_token_metadata": {}
}
```

## Use case: Store organization context

You can use refresh token metadata to store organization context for downstream systems such as audit, analytics, and revocation pipelines.

Post-Login Action code:

```javascript lines
/**
 * Post-Login Action
 * Adds organization context to refresh token metadata so it appears in subsequent Actions
 * and the Management API.
 */
exports.onExecutePostLogin = async (event, api) => {
  // Only proceed if the transaction targets an Organization
  if (!event.organization) return;

  // Keep values short and string-only (refresh token metadata requires strings)
  const orgId = String(event.organization.id || "");
  const orgSlug = String(event.organization.name || "");
  const orgDisplay = String(event.organization.display_name || orgSlug);

  // Minimal, idempotent writes (only a few keys to stay well under limits)
  api.refreshToken.setMetadata("org_id", orgId);
  api.refreshToken.setMetadata("org_slug", orgSlug);
  api.refreshToken.setMetadata("org_name", orgDisplay);
};
```

The refresh token metadata is available for subsequent Actions and retrievable via the [Management API](https://auth0.com/docs/api/management/v2).

* In subsequent Actions, you can query the data via the `event.refresh_token.metadata` object:

```javascript lines
const orgId = event.refresh_token?.metadata?.org_id;
```

* If you use the Management API, you can query the data via the [/api/v2/refresh-tokens/{id}](https://auth0.com/docs/api/management/v2/refresh-tokens/get-refresh-token) endpoint:

```bash lines
GET /api/v2/refresh-tokens/{id}
```

Sample response:

```json lines
{
  "refresh_token_metadata": {
    "org_id": "org_abc123",
    "org_slug": "acme",
    "org_name": "Acme Corp"
  }
}
```

## Use case: Track device information

You can use refresh token metadata to track device information for security and audit purposes.

```javascript lines
exports.onExecutePostLogin = async (event, api) => {
  // Store device information in refresh token metadata
  const deviceInfo = {
    ip: event.request?.ip || "unknown",
    userAgent: event.request?.user_agent || "unknown",
    geoip: event.request?.geoip?.country_code || "unknown"
  };

  api.refreshToken.setMetadata("initial_ip", deviceInfo.ip);
  api.refreshToken.setMetadata("user_agent", deviceInfo.userAgent);
  api.refreshToken.setMetadata("country", deviceInfo.geoip);
};
```

## Error handling

You can review refresh token metadata log events by navigating to [Dashboard > Monitoring > Logs](https://manage.auth0.com/#/logs) or retrieve logs using the [Management API logs](/docs/api/management/v2/logs/get-logs) endpoint.

* If an error occurs while adding or updating refresh token metadata with Actions, the authentication transaction fails and an error is returned to the callback URL.

A failure `f` event code is logged with its corresponding error:

```json lines
{
  "error": "access_denied",
  "error_description": "Failed to set refresh token metadata: Invalid metadata: Metadata keys may only include letters, numbers, underscores, or hyphens",
  "state": "my-custom-state"
}
```

* If a failure occurs when managing refresh token metadata using the Auth0 Management API, the API responds with an `HTTP status: 400` error and its corresponding message:

```json lines
{
  "statusCode": 400,
  "message": "Metadata must not exceed 25 entries. Each key and value must be â‰¤ 255 characters."
}
```

## Learn more

* [Refresh Token Metadata](/docs/secure/tokens/refresh-tokens/refresh-token-metadata)
* [Refresh Tokens with Actions](/docs/secure/tokens/refresh-tokens/manage-refresh-tokens-actions)
* [Refresh Tokens](/docs/secure/tokens/refresh-tokens)
* [Post-Login Event Object](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-event-object)
* [Post-Login API Object](/docs/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-api-object)
