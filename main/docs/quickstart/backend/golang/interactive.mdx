---
mode: wide
description: This tutorial demonstrates how to add authorization to a Go API using go-jwt-middleware.
sidebarTitle: Go API
title: Add Authorization to Your Go Application
---
import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Config from "/snippets/quickstart/backend/golang/config.go.mdx";
import Validator from "/snippets/quickstart/backend/golang/validator.go.mdx";
import Claims from "/snippets/quickstart/backend/golang/claims.go.mdx";
import Middleware from "/snippets/quickstart/backend/golang/middleware.go.mdx";
import Handlers from "/snippets/quickstart/backend/golang/handlers.go.mdx";
import Main from "/snippets/quickstart/backend/golang/main.go.mdx";

import {QuickstartButtons} from "/snippets/QuickstartButtons.jsx";

import {AuthCodeGroup} from "/snippets/AuthCodeGroup.jsx";

<QuickstartButtons githubLink="https://github.com/auth0-samples/auth0-golang-api-samples/tree/master/01-Quickstart-Go-API" />

export const sections = [
  { id: "prerequisites", title: "Prerequisites" },
  { id: "configure-api", title: "Configure Auth0 API" },
  { id: "define-permissions", title: "Define permissions" },
  { id: "install-dependencies", title: "Install dependencies" },
  { id: "configure-your-application", title: "Configure your application" },
  { id: "create-custom-claims", title: "Create custom claims" },
  { id: "create-jwt-validator", title: "Create JWT validator" },
  { id: "create-http-middleware", title: "Create HTTP middleware" },
  { id: "protect-api-endpoints", title: "Protect API endpoints" },
  { id: "checkpoint", title: "Checkpoint" }
]

<Recipe>
  <Content>
    This guide demonstrates how to integrate Auth0 with any new or existing Go API application using [go-jwt-middleware](https://github.com/auth0/go-jwt-middleware).
    
    Each Auth0 API uses the API Identifier, which your application needs to validate the access token.

    <Info>
    **New to Auth0?** Learn [how Auth0 works](/docs/get-started/auth0-overview) and read about [implementing API authentication and authorization](/docs/get-started/authentication-and-authorization-flow) using the OAuth 2.0 framework.
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Before we begin, make sure you have the following:

      <CardGroup cols={2}>
        <Card title="Go 1.24+" icon="golang" iconType="duotone">
          Required for v3 of go-jwt-middleware (which uses generics). Check your version with `go version`
        </Card>
        <Card title="Auth0 Account" icon="shield-check" iconType="duotone">
          Sign up for free at [auth0.com/signup](https://auth0.com/signup)
        </Card>
        <Card title="Code Editor" icon="code" iconType="duotone">
          VS Code, GoLand, or your preferred editor
        </Card>
        <Card title="Terminal Access" icon="terminal" iconType="duotone">
          Command line for running Go commands
        </Card>
      </CardGroup>

      <Tip>
        **New to Go?** This tutorial assumes basic familiarity with Go syntax and HTTP servers. Check out [Go by Example](https://gobyexample.com/) if you need a refresher.
      </Tip>
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      Create an API in your Auth0 Dashboard to get started.

      <Steps>
        <Step title="Navigate to APIs">
          Go to the [APIs](https://manage.auth0.com/#/apis) section in the Auth0 dashboard and click **Create API**.

          <Frame>![Create API](https://cdn2.auth0.com/docs/1.14550.0/media/articles/server-apis/create-api.png)</Frame>
        </Step>

        <Step title="Configure API settings">
          - **Name**: `Quickstarts` (or any descriptive name)
          - **Identifier**: `https://quickstarts/api` (this becomes your `audience`)
          - **Signing Algorithm**: Leave as **RS256** (recommended)

          <Tip>
          The API Identifier is a logical identifier - it doesn't need to be a real URL.
          </Tip>
        </Step>

        <Step title="Understand RS256">
          Your API uses **RS256** (asymmetric algorithm):
          - Auth0 signs tokens with a **private key**
          - Your API verifies tokens with a **public key** (from JWKS)
          - Public keys are fetched from: `https://{yourDomain}/.well-known/jwks.json`
        </Step>
      </Steps>
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Permissions let you define how resources can be accessed on behalf of the user with a given access token.

      In your API settings, click the **Permissions** tab and create the following permission:

      | Permission | Description |
      |------------|--------------|
      | `read:messages` | Read messages from the API |

      <Frame>![Configure Permissions](https://cdn2.auth0.com/docs/1.14550.0/media/articles/server-apis/configure-permissions.png)</Frame>

      <Info>
      This tutorial uses the `read:messages` scope to protect the scoped endpoint.
      </Info>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      Set up your Go project structure and install the required dependencies.

      <Steps>
        <Step title="Create project directory">
          ```bash
          mkdir myapi && cd myapi
          ```
        </Step>

        <Step title="Initialize Go module">
          ```bash
          go mod init github.com/yourorg/myapi
          ```
        </Step>

        <Step title="Install dependencies">
          ```bash
          go get github.com/auth0/go-jwt-middleware/v3
          go get github.com/joho/godotenv
          ```
        </Step>

        <Step title="Download all dependencies">
          ```bash
          go mod download
          ```
        </Step>
      </Steps>

      <Accordion title="View complete go.mod file">
        ```go
        // go.mod
        module github.com/yourorg/myapi

        go 1.24

        require (
            github.com/auth0/go-jwt-middleware/v3 v3.0.0
            github.com/joho/godotenv v1.5.1
        )
        ```
      </Accordion>

      <Warning>
        **Go 1.24+ Required**: This implementation uses generics for type-safe claims handling. Verify your version with `go version`.
      </Warning>
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      Create a `.env` file in your project root to store Auth0 configuration:

      ```env lines
      # The URL of your Auth0 Tenant Domain.
      # If you're using a Custom Domain, set this to that value instead.
      AUTH0_DOMAIN='{yourDomain}'

      # Your Auth0 API's Identifier
      # Example: https://quickstarts/api
      AUTH0_AUDIENCE='{yourApiIdentifier}'
      ```

      Create a config package to load and validate these environment variables in `internal/config/auth.go` (see the code in the right sidebar).

      <AccordionGroup>
        <Accordion title="Why use a config package?" icon="gear">
          **Benefits of centralized configuration**:
          - Single source of truth for environment variables
          - Clear error messages for missing configuration
          - Type-safe configuration access
          - Easy to test and mock
        </Accordion>

        <Accordion title="Security best practices" icon="shield-check">
          - Never commit `.env` files to version control
          - Add `.env` to your `.gitignore` file
          - Use different `.env` files for different environments
          - Validate all required config on startup (fail fast)
        </Accordion>
      </AccordionGroup>
    </Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      Create custom claims to extract and validate application-specific data from JWTs in `internal/auth/claims.go` (see the code in the right sidebar).

      <AccordionGroup>
        <Accordion title="Why custom claims?" icon="fingerprint">
          **Custom claims allow you to**:
          - Extract permissions (scopes) from JWT tokens
          - Validate claim formatting automatically
          - Add domain-specific authorization logic
          - Keep business logic separate from validation

          **Automatic Validation**: The `Validate` method is called automatically by the middleware after parsing the JWT.
        </Accordion>

        <Accordion title="Validation behavior" icon="shield-check">
          The `Validate` method ensures:
          - **Scope is optional** - allows tokens without scopes (for `/api/private` endpoint)
          - **Format validation** - when scope exists, checks for proper formatting
          - **No whitespace issues** - prevents malformed scope strings
          - **Called automatically** - runs before your handlers execute
        </Accordion>

        <Accordion title="HasScope method" icon="code">
          The `HasScope` helper method:
          - Parses space-separated scopes (e.g., `"read:messages write:messages"`)
          - Returns `false` if scope is empty (prevents false positives)
          - Used in handlers to enforce permission-based access
        </Accordion>
      </AccordionGroup>
    </Section>

    <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      Create the JWT validator in `internal/auth/validator.go` (see the code in the right sidebar).

      <AccordionGroup>
        <Accordion title="What does the validator do?" icon="shield-check">
          The validator performs these security checks on every JWT:
          - **Signature verification** using Auth0's public keys (JWKS)
          - **Issuer validation** - `iss` claim matches your Auth0 domain
          - **Audience validation** - `aud` claim matches your API identifier
          - **Expiration check** - token hasn't expired (`exp` claim)
          - **Time validity** - token is currently valid (`nbf` and `iat` claims)
        </Accordion>

        <Accordion title="Key features explained" icon="lightbulb">
          **Options Pattern**: Uses functional options like `validator.WithAllowedClockSkew()` for flexible configuration

          **JWKS Caching**: Automatically fetches and caches Auth0's public keys every 5 minutes, reducing network calls

          **Algorithm Specification**: Explicitly sets RS256 to prevent [algorithm confusion attacks](https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/)

          **Clock Skew Tolerance**: Allows 30 seconds for distributed system clock differences
        </Accordion>

        <Accordion title="Why separate validator from middleware?" icon="layer-group">
          The **core-adapter architecture** separates JWT validation logic (core) from HTTP concerns (adapter). This means:
          - You can reuse the same validator across different frameworks
          - Easier to test validation logic in isolation
          - Can use with HTTP, gRPC, or any other transport
        </Accordion>
      </AccordionGroup>
    </Section>

    <Section id={sections[7].id} title={sections[7].title} stepNumber="8">
      Create the HTTP middleware that wraps your validator in `internal/auth/middleware.go` (see the code in the right sidebar).

      Built-in structured logging using Go's standard `log/slog` package. The middleware will log token validation events for debugging.

      The middleware:
      - Extracts JWT from `Authorization: Bearer <token>` header
      - Validates token using the core validator
      - Skips validation for OPTIONS requests (CORS preflight)
      - Injects validated claims into request context
      - Returns RFC 6750 compliant error responses on failure
    </Section>

    <Section id={sections[8].id} title={sections[8].title} stepNumber="9">
      Create API handlers with different protection levels in `internal/handlers/api.go` and the main server in `cmd/server/main.go` (see the code in the right sidebar).

      **Generic Claims Feature**:
      - `GetClaims[*validator.ValidatedClaims]` uses generics for compile-time type safety
      - No runtime type assertions that can panic
      - IDE autocomplete for claim fields
      - Custom claims implement `Validate(ctx context.Context) error` for domain-specific validation

      **Endpoint Protection Levels:**
      1. **Public** (`/api/public`): No authentication required
      2. **Private** (`/api/private`): Valid JWT required
      3. **Scoped** (`/api/private-scoped`): Valid JWT + specific scope (`read:messages`) required

      **Production Features:**
      - Graceful shutdown handling
      - Configurable timeouts (read, write, idle)
      - Proper error handling
      - Environment variable configuration
    </Section>

    <Section id={sections[9].id} title={sections[9].title} stepNumber="10">
      Now let's test your implementation to make sure everything works correctly.

      <Steps>
        <Step title="Start your server">
          ```bash
          go run cmd/server/main.go
          ```

          You should see: `Server starting on :8080`
          
          <Info>
          The server automatically loads environment variables from your `.env` file using godotenv.
          </Info>
        </Step>

        <Step title="Get a test token">
          <Tabs>
            <Tab title="From Auth0 Dashboard">
              1. Go to your API in the [Auth0 Dashboard](https://manage.auth0.com/#/apis)
              2. Click the **Test** tab
              3. Click **Copy Token** to get a valid JWT

              <Frame>
                <img src="/docs/images/cdy7uua7fh8z/6jeVBuypOGX5qMRXeJn5ow/5e79037f6c852d2043789d622bdb9562/Quickstart_Example_App_-_English.png" />
              </Frame>
            </Tab>

            <Tab title="Via Client Credentials">
              Implement the [Client Credentials Flow](https://auth0.com/docs/get-started/authentication-and-authorization-flow/client-credentials-flow) for machine-to-machine authentication.
            </Tab>
          </Tabs>
        </Step>

        <Step title="Test public endpoint">
          This endpoint should work without authentication:

          ```bash
          curl http://localhost:8080/api/public
          ```

          <Check>**Expected**: 200 OK with message "Hello from a public endpoint!"</Check>
        </Step>

        <Step title="Test private endpoint (without token)">
          This should fail with a 401 error:

          ```bash
          curl http://localhost:8080/api/private
          ```

          <Check>**Expected**: 401 Unauthorized `{"error": "invalid_token"}`</Check>
        </Step>

        <Step title="Test private endpoint (with token)">
          This should succeed with a valid token:

          ```bash
          curl -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
               http://localhost:8080/api/private
          ```

          <Check>**Expected**: 200 OK with user information</Check>
        </Step>

        <Step title="Test scoped endpoint">
          This requires the `read:messages` scope:

          ```bash
          curl -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
               http://localhost:8080/api/private-scoped
          ```

          <Check>**Expected**: 200 OK if token has `read:messages` scope, 403 Forbidden otherwise</Check>
        </Step>
      </Steps>

      <Note>
        **Checkpoint Complete!** If all tests passed, your Auth0 integration is working correctly. Your API now:
        - Validates JWTs from Auth0
        - Protects private endpoints
        - Enforces permission-based access
      </Note>
    </Section>

    ## Continue the Tutorial

    <CardGroup cols={2}>
      <Card title="Using Your API" icon="code" href="/docs/quickstart/backend/golang/02-using">
        Learn how to call your protected Go API from client applications with examples in cURL, Go, Java, Node.js, Python, Ruby, and Swift.
      </Card>
      <Card title="Troubleshooting Guide" icon="screwdriver-wrench" href="/docs/quickstart/backend/golang/03-troubleshooting">
        Comprehensive debugging guide covering common issues like invalid issuer, audience errors, JWKS problems, and more.
      </Card>
    </CardGroup>

    ### Quick Troubleshooting

    <AccordionGroup>
      <Accordion title="Invalid Audience Error" icon="triangle-exclamation">
        **Error Message:**
        ```json
        {"error": "invalid_token", "description": "aud claim mismatch"}
        ```

        **Solution:** Verify `AUTH0_AUDIENCE` exactly matches your API Identifier from the Auth0 Dashboard.

        ```bash
        # Correct
        AUTH0_AUDIENCE=https://quickstarts/api

        # Wrong (no trailing slash should be added)
        AUTH0_AUDIENCE=https://quickstarts/api/
        ```
      </Accordion>

      <Accordion title="JWKS Endpoint Unreachable" icon="triangle-exclamation">
        **Error Message:**
        ```
        error fetching keys: connection refused
        ```

        **Solutions:**
        - Check network connectivity to Auth0 (firewall/proxy settings)
        - Test JWKS endpoint manually:
          ```bash
          curl https://your-tenant.us.auth0.com/.well-known/jwks.json
          ```
        - Verify correct Auth0 region (us/eu/au)
      </Accordion>

      <Accordion title="Wrong Import Path" icon="triangle-exclamation">
        **Error Message:**
        ```
        cannot find package "github.com/auth0/go-jwt-middleware/v3/..."
        ```

        **Solution:** Ensure all imports use the `/v3` suffix:
        ```go
        // Correct
        import "github.com/auth0/go-jwt-middleware/v3/validator"

        // Wrong
        import "github.com/auth0/go-jwt-middleware/validator"
        ```
      </Accordion>

      <Accordion title="Token Expired Error" icon="triangle-exclamation">
        **Error Message:**
        ```json
        {"error": "invalid_token", "description": "token is expired"}
        ```

        **Solutions:**
        - Get a new token from the Auth0 Dashboard Test tab
        - Check if your server clock is synchronized
        - Adjust clock skew tolerance:
          ```go
          validator.WithAllowedClockSkew(60*time.Second)
          ```
      </Accordion>
    </AccordionGroup>

    <Accordion title="Advanced: DPoP Support" icon="lock">
      **DPoP (Demonstrating Proof-of-Possession)** per RFC 9449 provides enhanced security by preventing token theft through cryptographic key binding.

      **When to use DPoP:**
      - Financial APIs handling sensitive transactions
      - Healthcare APIs with patient data
      - High-security enterprise applications

      **Enable DPoP:**
      ```go
      // internal/auth/middleware.go
      func NewMiddleware(jwtValidator *validator.Validator) *jwtmiddleware.JWTMiddleware {
          return jwtmiddleware.New(
              jwtmiddleware.WithValidator(jwtValidator),
              jwtmiddleware.WithDPoPMode(jwtmiddleware.DPoPRequired),
              jwtmiddleware.WithLogger(slog.Default()),
          )
      }
      ```

      **DPoP Modes:**
      - `DPoPAllowed` (default): Accept both Bearer and DPoP tokens
      - `DPoPRequired`: Only accept DPoP tokens, reject Bearer
      - `DPoPDisabled`: Only accept Bearer tokens, reject DPoP

      Learn more in the [DPoP documentation](https://github.com/auth0/go-jwt-middleware#dpop-support).
    </Accordion>

    ### Best Practices

    **Security**:
    - Always use HTTPS in production
    - Validate algorithms explicitly (prevents algorithm confusion attacks)
    - Use short-lived access tokens (15-30 minutes) with refresh tokens
    - Enable DPoP for sensitive APIs
    - Never log tokens in plaintext

    **Performance**:
    - Reuse validator instances (create once at startup)
    - Configure JWKS cache appropriately (5-15 minute TTL)
    - Set reasonable HTTP timeouts
    - Use connection pooling (enabled by default in Go)

    **Maintainability**:
    - Use environment variables for credentials
    - Define type-safe custom claims structs
    - Enable structured logging with `slog`
    - Test with mock validators
    - Document custom claims with JSON tags

    ### Project Structure

    Recommended structure for production Go APIs:

    ```
    myapi/
    ├── cmd/
    │   └── server/
    │       └── main.go              # Application entry point
    ├── internal/
    │   ├── auth/
    │   │   ├── claims.go            # Custom claims definition
    │   │   ├── middleware.go        # JWT middleware setup
    │   │   └── validator.go         # Validator configuration
    │   ├── config/
    │   │   └── auth.go              # Environment configuration
    │   └── handlers/
    │       └── api.go               # HTTP handlers
    ├── .env                         # Environment variables (not committed)
    ├── .gitignore
    ├── go.mod
    ├── go.sum
    └── README.md
    ```

    ### Next Steps

    Now that you have a working Go API with Auth0 authentication, explore advanced features:

    <CardGroup cols={2}>
      <Card title="Custom Claims Validation" icon="code" href="https://github.com/auth0/go-jwt-middleware#custom-claims">
        Add domain-specific authorization logic with type-safe claims
      </Card>
      <Card title="Token Refresh" icon="arrows-rotate" href="https://auth0.com/docs/secure/tokens/refresh-tokens">
        Implement refresh token flow for long-lived sessions
      </Card>
      <Card title="DPoP Security" icon="lock" href="https://github.com/auth0/go-jwt-middleware#dpop-support">
        Enable proof-of-possession for enhanced security
      </Card>
      <Card title="Organizations" icon="building" href="https://auth0.com/docs/manage-users/organizations">
        Enable multi-tenant authorization for B2B apps
      </Card>
      <Card title="Production Checklist" icon="circle-check" href="https://auth0.com/docs/deploy-monitor/production-checks">
        Pre-launch security review and best practices
      </Card>
      <Card title="API Documentation" icon="book" href="https://github.com/auth0/go-jwt-middleware">
        Complete SDK reference and advanced examples
      </Card>
    </CardGroup>

  </Content>

  <SideMenu sections={sections}>
    <SideMenuSectionItem id={sections[0].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[1].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[2].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[3].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[4].id}>
      <AuthCodeGroup>
        <Config />
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[5].id}>
      <AuthCodeGroup>
        <Claims />
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[6].id}>
      <AuthCodeGroup>
        <Validator />
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[7].id}>
      <AuthCodeGroup>
        <Middleware />
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[8].id}>
      <AuthCodeGroup>
        <Handlers />
        <Main />
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[9].id}>
      <SignUpForm />
    </SideMenuSectionItem>
  </SideMenu>
</Recipe>
