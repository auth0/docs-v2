---
title: "Flutterアプリケーションにログインを追加する"
permalink: "interactive"
'description': "このガイドでは、FlutterアプリにAuth0 Flutter SDKを使ってAuth0を統合する方法を説明します。"
'og:title': "Flutterアプリケーションにログインを追加する"
'og:description': "このガイドでは、FlutterアプリにAuth0 Flutter SDKを使ってAuth0を統合する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/flutter.jpeg"
'twitter:title': "Flutterアプリケーションにログインを追加する"
'twitter:description': "このガイドでは、FlutterアプリにAuth0 Flutter SDKを使ってAuth0を統合する方法を説明します。"
sidebarTitle: Flutter
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Build from "/snippets/quickstart/native/flutter/build.gradle.mdx";
import MainView from "/snippets/quickstart/native/flutter/main_view.dart.mdx";
import MainView2 from "/snippets/quickstart/native/flutter/main_view.dart2.mdx";
import ProfileView from "/snippets/quickstart/native/flutter/profile_view.dart.mdx";

import {AuthCodeGroup} from "/snippets/AuthCodeGroup.jsx";

export const sections = [
  { id: "auth0を構成する", title: "Auth0を構成する" },
  { id: "auth0-flutter-sdkをインストールする", title: "Auth0 Flutter SDKをインストールする" },
  { id: "androidを構成する", title: "Androidを構成する" },
  { id: "ios-macosを構成する", title: "iOS/macOSを構成する" },
  { id: "アプリケーションにログインを追加する", title: "アプリケーションにログインを追加する" },
  { id: "アプリケーションにログアウトを追加する", title: "アプリケーションにログアウトを追加する" },
  { id: "ユーザープロファイル情報を表示する", title: "ユーザープロファイル情報を表示する" }
]

<Recipe>
  <Content>
    # Flutterアプリケーションにログインを追加する

    Auth0を使用すると、アプリケーションに手軽に認証を追加して、ユーザープロファイル情報にアクセスできます。このガイドでは、Flutterアプリに[Auth0 Flutter SDK](https://github.com/auth0/auth0-flutter)を使ってAuth0を統合する方法を説明します。

    <Info>
    Flutter SDKは現在、Android、iOS、macOS版のFlutterアプリのみに対応しています。
    </Info>

    このクイックスタートでは、すでに[Flutter](https://flutter.dev/)アプリが問題なく作動しているものとします。そうでない場合は、[Flutter「入門」ガイド](https://docs.flutter.dev/get-started/install)をチェックして、シンプルなアプリの始め方をご確認ください。

    [Flutterコマンドラインツール](https://docs.flutter.dev/reference/flutter-cli)の知識も必要になります。

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Auth0のサービスを利用するには、Auth0 Dashboadに設定済みのアプリケーションがある必要があります。Auth0アプリケーションは、プロジェクトに対してどのように認証が動作して欲しいかを構成する場所です。

      ### Auth0アプリケーションを構成する

      対話型のセレクターを使ってAuth0アプリケーションを新規作成するか、既存の**ネイティブ** のAuth0アプリケーションを選択します。Auth0のすべてのアプリケーションには英数字からなる一意のクライアントIDが割り当てられており、アプリケーションのコードがSDKを通じてAuth0 APIを呼び出す際に使用されます。

      このクイックスタートを使って構成されたすべての設定は、[Dashboard](https://manage.auth0.com/dashboard/us/auth0-dsepaid/)のアプリケーションを自動更新します。今後、アプリケーションの管理もDashboardで行えます。

      完了済みの構成を見てみたい場合は、サンプルアプリをご覧ください。

      ### Callback URLとログアウトURLを構成する

      Callback URLとログアウトURLは、ユーザーをアプリにリダイレクトで戻すために、Auth0が呼び出すURLです。 Auth0は、ユーザーを認証した後にCallback URLを呼び出し、セッションのクッキーを削除した後にログアウトURLを呼び出します。Callback URLとログアウトURLを設定しないと、ユーザーはアプリにログインやログアウトが行えなくなり、エラーが発生します。

      プラットフォームに合わせて、Callback URLとログアウトURLに以下の値を設定します。

      <Info>
      Androidでは、`SCHEME`プレースホルダーの値は`https`や他のカスタムスキームでも構いません。`https`スキームでは、[Androidアプリリンク](/docs/ja-jp/get-started/applications/enable-android-app-links-support)を有効にする必要があります。

      iOS 17.4以降とmacOS 14.4以降では、ユニバーサルリンク（`https`スキーム）をCallback URLとログアウトURLに使うことができます。有効にすると、SDKは、iOS/macOSの古いバージョンではカスタムURLスキームにフォールバックして、アプリの[バンドル識別子](https://developer.apple.com/documentation/appstoreconnectapi/bundle_ids)を使用します。**この機能にはXcode 15.3以降と有料のApple Developerアカウントが必要です** 。
      </Info>

      #### Android

      `SCHEME://{yourDomain}/android/YOUR_PACKAGE_NAME/callback`

      #### iOS

      `https://{yourDomain}/ios/YOUR_BUNDLE_IDENTIFIER/callback,`

      `YOUR_BUNDLE_IDENTIFIER://{yourDomain}/ios/YOUR_BUNDLE_IDENTIFIER/callback`

      #### macOS

      `https://{yourDomain}/macos/YOUR_BUNDLE_IDENTIFIER/callback,`

      `YOUR_BUNDLE_IDENTIFIER://{yourDomain}/macos/YOUR_BUNDLE_IDENTIFIER/callback`

      たとえば、iOSのバンドル識別子が`com.example.MyApp`でAuth0ドメインが`example.us.auth0.com`の場合には、次の値になります：

      `https://example.us.auth0.com/ios/com.example.MyApp/callback,`

      `com.example.MyApp://example.us.auth0.com/ios/com.example.MyApp/callback`
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      Auth0 Flutter SDKをプロジェクトに追加します：

      `flutter pub add auth0_flutter`
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Androidプラットフォームが開発対象でない場合には、この手順をスキップしてください。

      SDKにはマニフェストのプレースホルダーが必要です。Auth0は内部でプレースホルダーを使用して、認証のCallback URLを捉える`intent-filter`を定義します。Auth0テナントのドメインとCallback URLスキームを設定する必要があります。

      [サンプル](https://github.com/auth0-samples/auth0-flutter-samples/tree/main/sample/android)では、次のプレースホルダーを使用します：

      - `auth0Domain`：Auth0テナントのドメインです。通常、Auth0 Dashboardにある**アプリケーションの設定** の**［Domain（ドメイン）］** フィールドで確認できます。カスタムドメインを使用している場合には、この値をカスタムドメインの値に設定してください。
      - `auth0Scheme`：使用するスキームです。カスタムスキーム、または、[Androidアプリリンク](/docs/ja-jp/applications/enable-android-app-links)を利用したい場合はhttpsになります。この値の設定に関する詳細情報は、[Auth0.Android SDK README](https://github.com/auth0/Auth0.Android#a-note-about-app-deep-linking)をお読みください。

      <Info>
      アクティビティーに特別な`intent-filter`を宣言する必要はありません。これは、マニフェストのプレースホルダーをAuth0**ドメイン** と**スキーム** の値で定義したからです。リダイレクトはライブラリーによって処理されます。
      </Info>

      Android Studio内で**Sync Project with Gradle Files** を実行し、変更内容を適用します。
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      iOSまたはmacOSプラットフォームが開発対象でない場合には、この手順をスキップしてください。

      <Warning>
      この手順では、有料のApple Developerアカウントが必要です。Callback URLおよびログアウトURLとしてユニバーサルリンクを使用する必要があります。代わりにカスタムのURLスキームを使用する場合はこの手順をスキップしてください。
      </Warning>

      ### チームIDとバンドル識別子を構成する

      Auth0アプリケーションの[設定ページ](https://manage.auth0.com/#/applications/%7ByourClientId%7D/settings)に移動して最後までスクロールし、 **［Advanced Settings（詳細設定）］>［Device Settings（デバイス設定）］** を開きます。**［iOS］** セクションで**［Team ID（チームID）］** に[Apple Team ID](https://developer.apple.com/help/account/manage-your-team/locate-your-team-id/)を、**［App ID（アプリID）］** にアプリのバンドル識別子を設定します。

      <Frame>![null](/docs/images/ja-jp/cdy7uua7fh8z/7wetuICumueyqt6dbB32ro/34a7981c2cee8a14cdcd01e75df1e50c/IOS_Settings_-_Japanese.png)</Frame>

      これで、アプリがAuth0テナントの`apple-app-site-association`ファイルに追加されます。

      ### 関連ドメインの機能を追加する

      `open ios/Runner.xcworkspace`（macOSの場合には`open macos/Runner.xcworkspace`）を実行し、Xcodeでアプリを開きます。**Runner** ターゲット設定の**［Signing & Capabilities（署名と機能）］** [タブ](https://developer.apple.com/documentation/xcode/adding-capabilities-to-your-app#Add-a-capability)に移動し、**［+ Capability（＋機能）］** ボタンを押します。それから**［Associated Domains（関連ドメイン）］** を選択します。

      <Frame>![null](/docs/images/ja-jp/cdy7uua7fh8z/3GO76kXynaieKs5CSj3UTp/1cc577b56d00bc3bad877e31b848c1ec/ios-xcode-capabilities.png)</Frame>

      次に、以下の[エントリー](https://developer.apple.com/documentation/xcode/configuring-an-associated-domain#Define-a-service-and-its-associated-domain)を**［Associated Domains（関連ドメイン）］** の下に追加します。

      `webcredentials:{yourDomain}`

      カスタムドメインがある場合は、Auth0ドメインの代わりに、設定ページにあるカスタムドメインを使用してください。

      <Info>
      関連ドメインが動作するためには、**iOSシミュレーター用に構築されている場合でも** 、アプリが自分のチーム証明書で署名されている必要があります。Apple Teamには必ず、Auth0アプリケーションの設定ページで構成されたチームIDのものを使用してください。
      </Info>
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      アプリに認証をセットアップするには、ユニバーサルログインが最も手軽な方法です。最良のエクスペリエンス、高い安全性、幅広い機能を活用するためにも、ユニバーサルログインの使用をお勧めします。

      `Auth0`クラスを使用して、Auth0のユニバーサルログインをFlutterアプリに統合します。`webAuthentication().login()`を使用して、ユーザーをAuth0のユニバーサルログインページにリダイレクトします。これは`Future`であるため、ユーザートークンの取得を待ち合わせる必要があります。

      **Android** ：カスタムスキームを使用している場合には、このスキームをログインメソッドに渡して、SDKが適切にログインページへ誘導してから戻せるようにします：

      `await auth0.webAuthentication(scheme: 'YOUR CUSTOM SCHEME').login();`

      ユーザーがログインすると、アプリへリダイレクトされます。その後、このユーザーのIDとアクセストークンにアクセスできるようになります。

      <Note>
      ##### チェックポイント
      webAuthentication().login()を呼び出してアプリにユーザーをログインするボタンをアプリに追加します。認証のためにAuth0へリダイレクトされてから、アプリケーションに戻されることを確認します。
      loginを呼び出した結果、トークンにアクセスできることを確認します
      </Note>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      ユーザーをログアウトさせるには、Auth0 Flutter SDKの`webAuthentication().logout()`を呼び出してログインセッションをクリアし、ユーザーをAuth0のログアウトエンドポイントにリダイレクトします。Auth0からのログアウトについて詳しい情報をお読みください。

      **Android** ：カスタムスキームを使用している場合には、このスキームをログアウトメソッドに渡して、SDKがアプリを適切に戻せるようにします：

      `await auth0.webAuthentication(scheme: 'YOUR CUSTOM SCHEME').logout();`

      <Note>
      ##### チェックポイント
      アプリにwebAuthentication().logout()を呼び出して、ユーザーをアプリからログアウトさせるボタンを追加します。ボタンを選択し、Flutterアプリからログアウトエンドポイントにリダイレクトされ、再び戻されることを確認してください。アプリケーションにはログインされていないはずです。
      </Note>
      </Section>

      <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      `webAuthentication().login()`を呼び出すと、ユーザープロファイルが自動的にユーザープロファイルプロパティを取得します。ログイン手順から返されたオブジェクトには、すべてのユーザープロファイルプロパティのある`user`プロパティが含まれ、これらはIDトークンをデコードすることで入力されます。

      <Note>
      ##### チェックポイント
      ログインして、結果のuserプロパティを調査します。emailやnameなど、現在のユーザーのプロファイル情報を確認します。
      </Note>
      </Section>

    ## 次のステップ

    成功です！ここまで来れば、アプリケーションにログイン、ログアウト、ユーザープロファイル情報が備わっているはずです。

    これでクイックスタートチュートリアルは終了ですが、機能はまだまだたくさんあります。Auth0でできることについて詳しくは、以下をご覧ください。

    *   [Auth0 Dashboard](https://manage.auth0.com/#) - Auth0のテナントやアプリケーションを構成して管理する方法について説明します
    *   [auth0-flutter SDK](https://www.github.com/auth0/auth0-flutter/) - このチュートリアルで使用されているSDKをより詳しく説明します
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0の機能性を拡張できる各種の統合を見つけられます
    *   [Configure other identity providers](/docs/ja-jp/identityproviders)
    *   [Enable multifactor authentication](/docs/ja-jp/multifactor-authentication)
    *   [Learn about attack protection](/docs/ja-jp/attack-protection)
    *   [Learn about Actions](/docs/ja-jp/customize/actions)
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <AuthCodeGroup>
          <MainView/>
          <Build/>
          <ProfileView/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <AuthCodeGroup>
          <MainView2/>
          <Build/>
          <ProfileView/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[6].id}>
        <AuthCodeGroup>
          <ProfileView/>
          <Build/>
          <MainView/>
        </AuthCodeGroup>
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
