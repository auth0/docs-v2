---
title: "Apache"
permalink: "interactive"
'description': "このチュートリアルでは、Webアプリに認証と認可を追加するために、Apacheを構成する方法について説明します。"
'og:title': "Apache"
'og:description': "このチュートリアルでは、Webアプリに認証と認可を追加するために、Apacheを構成する方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/apache.jpg"
'twitter:title': "Apache"
'twitter:description': "このチュートリアルでは、Webアプリに認証と認可を追加するために、Apacheを構成する方法について説明します。"
mode: wide
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import {AuthCodeGroup} from "/snippets/AuthCodeGroup.jsx";

import Code1 from "/snippets/quickstart/webapp/apache/code1.mdx"
import Code2 from "/snippets/quickstart/webapp/apache/code2.mdx"

export const sections = [
  { id: "システム要件", title: "システム要件" },
  { id: "mod-auth-openidcモジュールをインストールして有効にする", title: "mod_auth_openidcモジュールをインストールして有効にする" },
  { id: "auth0アカウント情報でモジュールを構成する", title: "Auth0アカウント情報でモジュールを構成する" },
  { id: "auth0を構成する", title: "Auth0を構成する" },
  { id: "認可", title: "認可" }
]

<Recipe>
  <Content>
    このチュートリアルでは、Webアプリに認証と認可を追加するために、Apacheを構成する方法について説明します。ログインして、アカウント用に構成された例を参考にこのクイックタートに従うことをお勧めします。

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      このチュートリアルとサンプルプロジェクトは次を使用してテストが完了しています：

      - Apache 2.4
    </Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      まず、Apacheに`mod_auth_openidc`モジュールをインストールする必要があります。

      [GitHub](https://github.com/zmartzone/mod_auth_openidc/releases)からバイナリを取得して、OSにインストールすることができます。OSがバイナリのどれとも互換でない場合には、[ソースからビルド](https://github.com/zmartzone/mod_auth_openidc/blob/master/INSTALL)することができます。

      モジュールをインストールしたら、`a2enmod`コマンドを実行して、Apacheで有効化します。詳細については、[Ubuntu Manpageでの2enmod](https://manpages.ubuntu.com/manpages/focal/man8/a2enmod.8.html)で次を参照してください：

      ```
      a2enmod auth_openidc
      ```

      <Info>
      Windowsについては、[こちらのPowershellスクリプト](https://github.com/enderandpeter/win-a2enmod#installation)を使用すると、システム上で`a2enmod`を動作させることができます。
      </Info>
    </Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      新しい構成ファイル（`auth_openidc.conf`）を更新します。このファイルは`/etc/apache2/mods-available`フォルダーにあります。

      <Info>
      Windowsでは、`/apache/conf/httpd.conf`ファイルを使用する必要があります
      </Info>
    </Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      Auth0 Dashboardで以下を行います。

      1. **［Applications（アプリケーション）］** > **［Applications（アプリケーション）］** に移動し、リストからアプリケーションを選択します。
      2. **［Settings（設定）］** ビューに切り替えて、**［Application URIs（アプリケーションURL）］** セクションを見つけます。
      3. `OIDCRedirectURI`の値を**［Allowed Callback URLs（許可されているCallback URL）］** に追加します。
      4. ページ下部の**［Advanced Settings（詳細設定）］** を見つけます。
      5. **［OAuth］** ビューに切り替えます。
      6. **［JSON Web Token (JWT) Signature Algorithm（JSON Web Token（JWT）署名アルゴリズム）］** を`RS256`に設定します。
    </Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      Apacheを構成して、ユーザーのIDトークンにあるクレームの値を基に特定の場所を保護することができます。これを行うには、`Location`ブロックを`auth_openidc.conf`ファイルに追加します。

      たとえば、ユーザーのロールを読み出すアクションを作成して、保護された場所へのアクセスを付与するクレームを追加することができます：

      ```js lines
      exports.onExecutePostLogin = async (event, api) => {
        const roles = event.authorization.roles; // ['user', 'admin']
          if (roles.includes('admin')) {
          api.idToken.setCustomClaim('folder', 'admin');
        }
      };
      ```

    </Section>
    ## 次のステップ

    成功です！ここまで来れば、アプリケーションにログイン、ログアウト、ユーザープロファイル情報が備わっているはずです。

    これでクイックスタートチュートリアルは終了ですが、機能はまだまだたくさんあります。Auth0でできることについて詳しくは、以下をご覧ください。

    *   [Auth0 Dashboard](https://manage.auth0.com/#) - Auth0のテナントやアプリケーションを構成して管理する方法について説明します
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0の機能性を拡張できる各種の統合を見つけられます
  </Content>

  <SideMenu sections={sections}>
    <SideMenuSectionItem id={sections[0].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[1].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[2].id}>
      <AuthCodeGroup>
        <Code1/>
      </AuthCodeGroup>
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[3].id}>
      <SignUpForm />
    </SideMenuSectionItem>

    <SideMenuSectionItem id={sections[4].id}>
      <AuthCodeGroup>
        <Code2/>
      </AuthCodeGroup>
    </SideMenuSectionItem>

  </SideMenu>
</Recipe>
