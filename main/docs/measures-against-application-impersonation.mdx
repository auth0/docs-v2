'og:description': Describes how to use universal links rather than custom URL schemes to verify the legitimacy of authentication data.
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Measures Against Application Impersonation
'og:url': https://auth0.com/docs/
permalink: application-impersonation
title: Measures Against Application Impersonation
'twitter:description': Describes how to use universal links rather than custom URL schemes to verify the legitimacy of authentication data.
'twitter:title': Measures Against Application Impersonation
---
In the [Authorization Code Flow with PKCE](/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce), often employed by native applications, a `redirect_uri` returns control to an application after login. After the URI loads in the deviceâ€™s browser, the mobile app automatically opens to allow the user to continue their journey.

Historically, this scenario is accomplished with [custom URI schemes](https://developers.google.com/identity/protocols/oauth2/native-app#installed_app_redirect_methods) (e.g., `com.mycompany.myapp://oauth2redirect`). However, custom URI schemes pose a risk as more than one application on the device can register the same scheme. Mobile OSs do not include any built-in mechanisms that ensure the application receiving the redirect is the intended one. This scenario creates the potential for malicious apps to impersonate legitimate ones and receive the authorization response (including tokens) without user awareness, especially if single sign-on (SSO) is active due to the existence of a previous legitimate session, where additional user interaction is not required.

<Warning>
Due to the potential risks, Auth0 does **not** recommend using custom URI schemes as callback URLs for native applications.
</Warning>

## Recommended mitigations
### Claimed HTTPS URIs

Modern mobile OSs support claimed HTTPS URIs, which allow you to associate a website domain that you control with your mobile app. Claimed HTTPS URIs are known as:

* Universal Links on iOS
* App Links on Android

Using claimed HTTPS URIs ensures that only your application handles the associated callback URL, protecting against unauthorized access to sensitive authentication data.

<Note>
Auth0 strongly recommends using claimed HTTPS URIs as redirect URIs for all native applications.
* For iOS: Review [Support Universal Links](https://developer.apple.com/documentation/xcode/allowing-apps-and-websites-to-link-to-your-content/#Support-universal-links).
* For Android: Review [Android App Links](https://developer.android.com/training/app-links#android-app-links).
</Note>

## User confirmation prompt

If your application cannot support claimed HTTPS URIs due to required compatibility with older mobile OS versions, Auth0 cannot verify the legitimacy of the application receiving the authentication transaction results. In these cases, as defined in the [OAuth2 for Native Apps](https://datatracker.ietf.org/doc/html/rfc8252#section-8.6) specification, Auth0 provides a mechanism to show a confirmation prompt to the user. This allows users to confirm that the application receiving the authentication result is the one they intended to access. When a custom URI scheme is in use, the user is prompted to verify the application on each authentication transaction.

The confirmation screen displays when:

1. The `redirect_uri` in the request uses a custom URI scheme (i.e. not `https://...`).
2. The user has not been prompted with any other screen in the current login transaction (such as when a [consent screen](/docs/get-started/applications/confidential-and-public-applications/user-consent-and-third-party-applications) populates for third-party applications, or when MFA is required).

In these cases, the application presents the end user with a confirmation prompt.

Frame ![Measures Against App Impersonation - Confirmation Prompt](main/images/cdy7uua7fh8z/measures-again-impersonation-confirmation-prompt.png)

<Note>
The confirmation prompt is not shown in legacy non-OIDC-conformant flows. To learn how you can apply increased protection for your tenants and applications, review [Adopt OIDC-Conformant Authentication](/docs/authenticate/login/oidc-conformant-authentication).
</Note>

#### Prompt customization

The confirmation prompt uses your custom branding and configurations defined for existing consent screens used for third-party applications. To learn more, review the Prompts section of [Customize Universal Login Page Templates](/docs/customize/login-pages/universal-login/customize-templates).

<Warning>
Auth0 strongly recommends you do not disable this protection for legacy applications. Malicious applications on the device could request `id_tokens` and `access_tokens` without any interaction from the user or other indications that something has happened.
</Warning>

You can configure the confirmation prompts in the following ways. Note that application-level settings take precedence over the global tenant-level setting.

* **Enable (or disable) the prompt globally**: Configure the **Skip Custom URI Scheme Redirect End-User Confirmation** setting on the Auth0 Dashboard under **[Settings > Advanced]**(https://manage.auth0.com/tenant/advanced). Disabling the toggle activates the prompt, while enabling the toggle deactivates the prompt. To learn more, review [Tenant Settings](/docs/get-started/tenant-settings).

Frame ![Auth0 Dashboard > Tenant Settings > Skip Custom URI toggle](main/images/cdy7uua7fh8z/Auth0 Dashboard > Tenant Settings > Skip Custom URI toggle.png)

* **Enable (or disable) the prompt per application**: Use the Management API to make a `POST` call to [Create a Client](/api/management/v2/clients/post-clients) or a `PATCH` call to [Update a Client](/api/management/v2/clients/patch-clients-by-id). Set the `skip_custom_uri_scheme_redirect_confirmation_prompt` attribute to false to activate the prompt or true to deactivate the prompt.

```curl
curl --request PATCH \
  --url 'https://{yourDomain}/api/v2/clients/CLIENT_ID' \
  --header 'authorization: Bearer MANAGEMENT_API_TOKEN' \
  --header 'content-type: application/json' \
  --data '{
    "skip_custom_uri_scheme_redirect_confirmation_prompt": true
}'
```