---
title: Add Authorization to Your ASP.NET Core Web API Application
sidebarTitle: ASP.NET Core Web API

---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";
import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Appsettings from "/snippets/quickstart/backend/aspnet-core-webapi/appsettings.json.mdx";
import Program from "/snippets/quickstart/backend/aspnet-core-webapi/Program.cs.mdx";
import Hasscopehandler from "/snippets/quickstart/backend/aspnet-core-webapi/HasScopeHandler.cs.mdx";
import Hasscoperequirement from "/snippets/quickstart/backend/aspnet-core-webapi/HasScopeRequirement.cs.mdx";
import Apicontroller from "/snippets/quickstart/backend/aspnet-core-webapi/ApiController.cs.mdx";

export const sections = [
  { id: "define-permissions", title: "Define permissions" },
  { id: "install-dependencies", title: "Install dependencies" },
  { id: "configure-the-middleware", title: "Configure the middleware" },
  { id: "validate-scopes", title: "Validate scopes" },
  { id: "protect-api-endpoints", title: "Protect API endpoints" },
  { id: "call-your-api", title: "Call your API" }
]

<Recipe isSingleColumn>
  <Content>
    Auth0 allows you to add authentication and access user profile information in almost any application type quickly.
        This guide demonstrates how to integrate Auth0 with any new or existing ASP.NET Web API application using the
        `Microsoft.AspNetCore.Authentication.JwtBearer` package.

    If you haven't created an API in your Auth0 dashboard yet, you can use the interactive selector to create a new
        Auth0 API or select an existing API that represents the project you want to integrate with.

    Alternatively, you can read our getting started guide,
        which will help you set up your first API through the Auth0 Dashboard.

    Note that every API in Auth0 is configured using an API Identifier; your application code will use the API
        Identifier as the Audience to validate the access token.

    <Info>
    **New to Auth0?** Learn how Auth0 works and
                  read about implementing API authentication and
                    authorization using the OAuth 2.0 framework.
    </Info>

    <Section id={sections[0].id} title={sections[0].title} stepNumber="1" isSingleColumn>
      Permissions let you define how resources can be accessed on behalf of the user with a given access token. For
            example, you might choose to grant read access to the `messages` resource if users have the manager
            access level, and grant write access to that resource if they have the administrator access level.

      You can define allowed permissions in the **Permissions** view of the Auth0 Dashboard's [APIs](https://manage.auth0.com/#/apis) section. The following
            example uses the `read:messages` scope.

      <Frame>
        <img src="/images/cdy7uua7fh8z/1s3Yp5zqJiKiSWqbPSezNO/e61793a2822d095666002c3f65c71ac2/configure-permissions.png" />
      </Frame>
    
    <LoggedInForm />
</Section>

    <Section id={sections[1].id} title={sections[1].title} stepNumber="2" isSingleColumn>
      To allow your application to validate access tokens, add a reference to the
            `Microsoft.AspNetCore.Authentication.JwtBearer` NuGet package:

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      
    
    <LoggedInForm />
</Section>

    <Section id={sections[2].id} title={sections[2].title} stepNumber="3" isSingleColumn>
      Set up the authentication middleware by configuring it in your application's `Program.cs` file:

      1. Register the authentication services by making a call to the `AddAuthentication` method. Configure
                `JwtBearerDefaults.AuthenticationScheme` as the default scheme.
      2. Register the JWT Bearer authentication scheme by making a call to the `AddJwtBearer` method.
                Configure your Auth0 domain as the authority and your Auth0 API Identifier as the audience, and be sure that
                your Auth0 domain and API Identifier are set in your application's **appsettings.json** file.
        
          <Info>
          In some cases, the access token will not have a `sub` claim; in this case, the
                              `User.Identity.Name` will be `null`. If you want to map a different claim to
                              `User.Identity.Name`, add it to `options.TokenValidationParameters` within the
                              `AddJwtBearer()` call.
          </Info>

      3. Add the authentication and authorization middleware to the middleware pipeline by adding calls to the
                `UseAuthentication`and `UseAuthorization`methods under the
                `var app = builder.Build();`method.
    
    <CodeGroup>
          <Program />
          <Appsettings/>
          <Hasscopehandler/>
          <Hasscoperequirement/>
          <Apicontroller/>
        </CodeGroup>
</Section>

    <Section id={sections[3].id} title={sections[3].title} stepNumber="4" isSingleColumn>
      To ensure that an access token contains the correct scopes, use [Policy-Based Authorization](https://docs.microsoft.com/en-us/aspnet/core/security/authorization/policies) in the ASP.NET Core:

      1. Create a new authorization requirement called `HasScopeRequirement`, which will check whether the
                `scope`claim issued by your Auth0 tenant is present, and if so, will check that the claim contains
                the requested scope.
      2. Under your `Program.cs`file's
                `var builder = WebApplication.CreateBuilder(args);`method, add a call to the
                `app.AddAuthorization`method.
      3. Add policies for scopes by calling `AddPolicy`for each scope.
      4. Register a singleton for the `HasScopeHandler`class.
    
    <CodeGroup>
            <Hasscopehandler/>
            <Program />
            <Appsettings/>
            <Hasscoperequirement/>
            <Apicontroller/>
        </CodeGroup>
</Section>

    <Section id={sections[4].id} title={sections[4].title} stepNumber="5" isSingleColumn>
      The JWT middleware integrates with the standard ASP.NET Core [Authentication](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/) and [Authorization](https://docs.microsoft.com/en-us/aspnet/core/security/authorization/) mechanisms.

      To secure an endpoint, add the `[Authorize]` attribute to your controller action (or the entire
            controller if you want to protect all of its actions).

      When securing endpoints that require specific scopes, make sure that the correct scope is present in the
            `access_token`. To do so, add the `Authorize` attribute to the `Scoped` action
            and pass `read:messages` as the `policy` parameter.
    
    <CodeGroup>
            <Apicontroller/>
            <Hasscopehandler/>
            <Program />
            <Appsettings/>
            <Hasscoperequirement/>
        </CodeGroup>
</Section>

    <Section id={sections[5].id} title={sections[5].title} stepNumber="6" isSingleColumn>
      The way in which you call your API depends on the type of application you are developing and the framework you
            are using. To learn more, read the relevant application Quickstart:

      - [Single-Page Applications](/quickstart#single-page-app)
      - [Mobile / Native Application](/quickstart#native-mobile-app)

      ### Get an access token

      Regardless of the type of application you are developing or the framework you are using, to call your API, you
            need an access token.

      If you call your API from a Single-Page Application (SPA) or Native application, you will receive an access token
            after the authorization flow completes.

      If you call the API from a command-line tool or other service where a user entering credentials does not exist,
            use the [OAuth Client
              Credentials Flow](https://auth0.com/docs/api/authentication#client-credentials). To do so, register a [Machine-to-Machine Application](https://manage.auth0.com/#/applications) and pass the following values in your request:

      - **Client ID** as the `client_id` parameter.
      - **Client Secret** as the `client_secret` parameter.
      - **API Identifier** (the same value used to configure the middleware earlier in this quickstart) as the
                `audience` parameter.

      <Info>
      To learn more about getting the Client ID and Client Secret for your machine-to-machine application,
                      read Application Settings.
      </Info>

      **Example request**

      <CodeGroup>
      <AuthCodeBlock filename="cURL" icon="file-code" language="sh" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="C#" icon="file-code" language="cs" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Go" icon="file-code" language="go" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Java" icon="file-code" language="java" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Node.JS" icon="file-code" language="js" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Obj-C" icon="file-code" language="obj-c" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="PHP" icon="file-code" language="php" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Python" icon="file-code" language="python" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Ruby" icon="file-code" language="rb" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Swift" icon="file-code" language="swift" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      </CodeGroup>
      

      ### Call a secure endpoint

      Now that you have an access token, you can use it to call secure API endpoints. When calling a secure endpoint,
            you must include the access token as a Bearer token in the **Authorization** header of the request. For
            example, you can make a request to the `/api/private` endpoint:


      <CodeGroup>
      <AuthCodeBlock filename="cURL" icon="file-code" language="sh" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="C#" icon="file-code" language="cs" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Go" icon="file-code" language="go" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Java" icon="file-code" language="java" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Node.JS" icon="file-code" language="js" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Obj-C" icon="file-code" language="obj-c" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="PHP" icon="file-code" language="php" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Python" icon="file-code" language="python" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Ruby" icon="file-code" language="rb" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Swift" icon="file-code" language="swift" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      </CodeGroup>
      

      Call the `/api/private-scoped` endpoint in a similar way, but ensure that the API permissions are
            configured correctly and that the access token includes the `read:messages` scope.

      <Note>
      ##### Checkpoint

      You should now be able to call the `/api/private` and `/api/private-scoped`
                    endpoints.

      Run your application and verify that:

      - `GET /api/private`is available for authenticated requests.
      - `GET /api/private-scoped`is available for authenticated requests containing an access
                        token with the `read:messages`scope.
      </Note>
    
    <LoggedInForm />
</Section>

    ## Next Steps

    Excellent work! If you made it this far, you should now have login, logout, and user profile information running in your application.

    This concludes our quickstart tutorial, but there is so much more to explore. To learn more about what you can do with Auth0, check out:

    *   [Auth0 Dashboard](https://manage.auth0.com/dashboard/us/dev-gja8kxz4ndtex3rq) - Learn how to configure and manage your Auth0 tenant and applications
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) - Discover integrations you can enable to extend Auth0’s functionality
  </Content>

  
</Recipe>
