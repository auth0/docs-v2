---
title: "Migration de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
permalink: "migrate-from-auth0-js-to-the-auth0-single-page-app-sdk"
'description': "Comment migrer les applications à page unique de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
'og:title': "Migration de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
'og:description': "Comment migrer les applications à page unique de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Migration de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
'twitter:description': "Comment migrer les applications à page unique de Auth0.js vers la trousse SDK Auth0 pour les applications à page unique (SPA)"
---

Dans cet article, nous verrons comment migrer votre application à page unique de [auth0.js](/docs/fr-ca/libraries/auth0js) à [auth0-spa-js](/docs/fr-ca/libraries/auth0-single-page-app-sdk). Voici une liste de scénarios basés sur auth0.js et le code équivalent auth0-spa-js.

## Les fonctionnalités qui ne peuvent pas être migrées

Toutes les fonctionnalités de auth0.js ne peuvent pas être directement migrées vers auth0-spa-js. Les scénarios pour lesquels il n’est pas possible d’effectuer une migration directe sont les suivants :

* connexion [intégrée avec le nom d’utilisateur/le mot de passe](https://auth0.github.io/auth0.js/WebAuth.html#login) et [connexion intégrée sans mot de passe](https://auth0.github.io/auth0.js/WebAuth.html#passwordlessLogin)
* [inscription](https://auth0.github.io/auth0.js/WebAuth.html#signup) de l’utilisateur
* [obtenir un profil utilisateur depuis le point de terminaison /userinfo](https://auth0.github.io/auth0.js/Authentication.html#userInfo)
* [request an email to change the user’s password](https://auth0.github.io/auth0.js/WebAuth.html#changePassword)
* [mise en lien d’utilisateurs avec l’API de gestion](https://auth0.github.io/auth0.js/Management.html#linkUser)
* [obtenir l’utilisateur avec l’API de gestion](https://auth0.github.io/auth0.js/Management.html#getUser)
* [mettre à jour les attributs utilisateur avec l’API de gestion](https://auth0.github.io/auth0.js/Management.html#patchUserAttributes)
* [mettre à jour les attributs utilisateur avec l’API de gestion](https://auth0.github.io/auth0.js/Management.html#patchUserMetadata)
* Il existe également des options qui ne peuvent pas être configurées dans Auth0.js et qui n’ont pas d’équivalents dans auth0-spa-js. L’option `responseType`, par exemple. C’est pour cette raison qu’il n’y a pas de correspondance directe pour chaque option. Dans ce cas, l’option `responseType` est superflue. En effet, la trousse SDK est uniquement destinée à être utilisée dans les applications à page unique, et il n’est donc pas nécessaire de modifier le type de réponse.

## Les paramètre d’authentification ne peuvent plus être modifiés

Auth0.js convertit les paramètres personnalisés que vous configurez en interne de `camelCase` à `snake_case`. Par exemple, si vous avez configuré `deviceType: 'offline’`, auth0.js envoie en fait `device_type: 'offline'` au serveur.

Lors de l’utilisation de auth0-spa-js, les paramètres personnalisés **ne sont pas convertis** de `camelCase` à `snake_case`. Il transmettra tous les paramètres que vous envoyez au serveur d’autorisation tels quels.

## Créer le client

### auth0.js

* [WebAuth](https://auth0.github.io/auth0.js/WebAuth.html)



```javascript lines
import { WebAuth } from 'auth0.js';

window.addEventListener('load', () => {
  var auth0 = new WebAuth({
    domain: '{yourDomain}',
    clientID: '{yourClientId}',
    redirectUri: 'https://YOUR_APP/callback'
  });
});
```

### auth0-spa-js

* [createAuth0Client()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#constructor)
* [Auth0ClientOptions](https://auth0.github.io/auth0-spa-js/interfaces/Auth0ClientOptions.html)



```javascript lines
import createAuth0Client from '@auth0/auth0-spa-js';

window.addEventListener('load', () => {
  const auth0 = await createAuth0Client({
    domain: '{yourDomain}',
    client_id: '{yourClientId}',
    redirect_uri: 'https://YOUR_APP/callback'
  });
});
```

## Rediriger vers la page Connexion universelle

### auth0.js

* [authorize()](https://auth0.github.io/auth0.js/WebAuth.html#authorize)

```javascript lines
document.getElementById('login').addEventListener('click', () => {
  auth0.authorize();
});
```

### auth0-spa-js

* [Auth0Client.loginWithRedirect()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#loginWithRedirect)
* [RedirectLoginOptions](https://auth0.github.io/auth0-spa-js/interfaces/RedirectLoginOptions.html)

```javascript lines
document.getElementById('login').addEventListener('click', async () => {
  await auth0.loginWithRedirect();
});
```

## Analyser le hachage après la redirection

### auth0.js

* [parseHash()](https://auth0.github.io/auth0.js/WebAuth.html#parseHash)

```javascript lines
window.addEventListener('load', () => {
  auth0.parseHash({ hash: window.location.hash }, function(err, authResult) {
    if (err) {
      return console.log(err);
    }
    console.log(authResult);
  });
});
```

### auth0-spa-js

* [Auth0Client.handleRedirectCallback()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#handleRedirectCallback)

```javascript lines
window.addEventListener('load', async () => {
  await auth0.handleRedirectCallback();
});
```

## Obtenir les informations de l’utilisateur

### auth0.js

La fonction `userInfo()` appelle le [point de terminaison`/userinfo`](https://auth0.com/docs/api/authentication#user-profile) et renvoie le profil utilisateur.

* [userInfo()](https://auth0.github.io/auth0.js/Authentication.html#userInfo)

```javascript lines
window.addEventListener('load', () => {
  auth0.client.userInfo(accessToken, function(err, user) {
    console.log(user)
  });
});
```

### auth0-spa-js

Contrairement à auth0.js, la trousse SDK Auth0 pour les applications à page unique (SPA) n’appelle pas le [point de terminaison `/userinfo`](https://auth0.com/docs/api/authentication#user-profile) pour demander le profil utilisateur. Au lieu de cela, la fonction `Auth0Client.getUser()` renvoie des informations sur l’utilisateur depuis un `id_token` décodé.

* [Auth0Client.getUser()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#getUser)

```javascript lines
window.addEventListener('load', async () => {
  const user = await auth0.getUser();
  console.log(user);
});
```

## Ouvrir la page Connexion universelle dans une fenêtre contextuelle

### auth0.js

```javascript lines
document.getElementById('login').addEventListener('click', () => {
  auth0.popup.authorize();
});
```

### auth0-spa-js

* [Auth0Client.loginWithPopup()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#loginWithPopup)
* [PopupLoginOptions](https://auth0.github.io/auth0-spa-js/interfaces/PopupLoginOptions.html)

```javascript lines
document.getElementById('login').addEventListener('click', async () => {
  await auth0.loginWithPopup();
});
```

## Jetons d’actualisation

### auth0.js

* [checkSession()](https://auth0.github.io/auth0.js/WebAuth.html#checkSession)

```javascript lines
document.getElementById('login').addEventListener('click', () => {
  auth0.checkSession({}, function(err, authResult) {
    // Authentication tokens or error
  });
});
```

### auth0-spa-js

La trousse SDK Auth0 pour les applications à page unique (SPA) gère l’actualisation des jeton d’accès pour vous. Chaque fois que vous appelez `getTokenSilently`, vous obtiendrez soit un jeton d’accès valide ou un message d’erreur vous informant qu’il y a pas de session à Auth0.

* [Auth0Client.getTokenSilently()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#getTokenSilently)

```javascript lines
document.getElementById('login').addEventListener('click', async () => {
  await auth0.getTokenSilently();
});
```

## Obtenir un jeton pour une audience différente ou disposant de plus de permissions

### auth0.js

* [checkSession()](https://auth0.github.io/auth0.js/WebAuth.html#checkSession)

```javascript lines
document.getElementById('login').addEventListener('click', () => {
  auth0.checkSession({
    audience: 'https://mydomain/another-api/',
    scope: 'read:messages'
  }, function(err, authResult) {
    // Authentication tokens or error
  });
});
```

### auth0-spa-js

La trousse SDK Auth0 pour les applications à page unique (SPA) gère l’actualisation des jeton d’accès pour vous. Chaque fois que vous appelez `getTokenSilently`, vous obtiendrez soit un jeton d’accès valide ou un message d’erreur vous informant qu’il y a pas de session à Auth0.

* [Auth0Client.getTokenSilently()](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#getTokenSilently)
* [GetTokenSilentlyOptions](https://auth0.github.io/auth0-spa-js/interfaces/GetTokenSilentlyOptions.html)

```javascript lines
document.getElementById('login').addEventListener('click', async () => {
  await auth0.getTokenSilently({
    audience: 'https://mydomain/another-api/',
    scope: 'read:messages'
  });
});
```

Utiliser la fonction [getTokenWithPopup](https://auth0.github.io/auth0-spa-js/classes/Auth0Client.html#getTokenWithPopup) pour ouvrir une fenêtre contextuelle et permettre à l’utilisateur d’accepter la nouvelle API :

```javascript lines
document.getElementById('login').addEventListener('click', async () => {
  await auth0.getTokenWithPopup({
    audience: 'https://mydomain/another-api/',
    scope: 'read:messages'
  });
});
```

