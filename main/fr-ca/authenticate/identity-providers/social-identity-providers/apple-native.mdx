---
title: "Ajouter une connexion avec Apple aux application iOS natives"
permalink: "apple-native"
'description': "Découvrez comment ajouter une fonctionnalité de connexion native à votre application native avec Apple."
'og:title': "Ajouter une connexion avec Apple aux application iOS natives"
'og:description': "Découvrez comment ajouter une fonctionnalité de connexion native à votre application native avec Apple."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Ajouter une connexion avec Apple aux application iOS natives"
'twitter:description': "Découvrez comment ajouter une fonctionnalité de connexion native à votre application native avec Apple."
---

Vous pouvez ajouter des fonctionnalités à votre application iOS native pour permettre à vos utilisateurs de s’authentifier à l’aide de Sign In with Apple (Connexion avec Apple). Pour plus de détails sur la mise en œuvre, vous pouvez essayer [iOS Swift – Connexion avec Apple Quickstart de Auth0](/docs/fr-ca/quickstart/native/ios-swift-siwa).

## Fonctionnement

Pour une application native, le flux de connexion Sign In with Apple (Connexion avec Apple) fonctionne comme suit :

<Frame>![Diagram of the Sign In with Apple Authentication Flow](/images/fr-ca/cdy7uua7fh8z/I7xtPQoqoAFiHQiT2p7p5/8646a5231491dfbe64bd6a825ccc8ce7/apple-siwa-authn-flow.png)</Frame>

* **Étapes 1 et 2** : l’utilisateur s’authentifie via la trousse SDK d’Apple sur son appareil iOS et reçoit un code d’autorisation dans la réponse. L’utilisateur n’a pas besoin de quitter l’application et d’utiliser un navigateur pour se connecter.

  <Warning>

  Évitez d’utiliser un nombre aléatoire. La demande adressée à Apple échouera à l’étape 4 et Auth0 renverra une erreur 400 à l’utilisateur : « Erreur de connexion Apple ».

  </Warning>

* **Étape 3** : L’application appelle le point de terminaison `/oauth/token` d’Auth0 pour échanger le code d’autorisation d’Apple contre les jetons Auth0.
* **Étapes 4 et 5** : La plateforme Auth0 échange le code d’autorisation avec Apple contre des jetons. Auth0 valide les jetons et utilise les demandes dans les jetons pour construire l’identité de l’utilisateur.
* **Étape 6** : Auth0 enregistre le profil utilisateur, exécute les règles et l’autorisation, puis émet des jetons d’accès Auth0 (jetons d’actualisation et jetons d’ID) comme demandé. Ces jetons sont utilisés pour protéger vos API et utilisateurs gérés par Auth0.

## Prérequis

Avant de configurer Sign In with Apple (la connexion avec Apple) pour votre application native dans Auth0, vous devez :

* Disposer d’un compte [Développeur Apple](https://developer.apple.com/programs/), qui est un compte payant avec Apple. (Il n’y a pas d’essai gratuit disponible à moins que vous ne fassiez partie de leur [iOS Developer University Program (Programme universitaire pour développeurs iOS](https://developer.apple.com/support/compare-memberships/).))
* [Enregistrer votre application sur le portail des développeurs Apple](https://marketplace.auth0.com/integrations/apple-social-connection) si vous ne l’avez pas déjà fait. Notez les ID et la clé suivants pour les réglages de connexion de l’application dans le <Tooltip href="/docs/fr-ca/glossary?term=auth0-dashboard" tip="Auth0 Dashboard
Principal produit d’Auth0 pour configurer vos services." cta="Voir le glossaire">Auth0 Dashboard</Tooltip> :

  + ID de l’application
  + ID d’équipe Apple
  + Clé de connexion secrète du client
  + ID de clé
* Si vous utilisez le flux de connexion classique ou l’intégration `Lock.js` dans votre application, assurez-vous que vous utilisez une version `Lock.js` 11.16 ou ultérieure.

## Configurer et activer la connexion dans Auth0

Une fois que vous disposez des informations d’identification dont vous avez besoin à partir de votre compte de développeur Apple, vous devez configurer le client d’application et les paramètres de connexion dans Auth0.

1. Accédez à [Auth0 Dashboard > Applications > Applications](https://manage.auth0.com/#/applications), sélectionnez votre application, puis l’icône d’engrenage pour afficher la page des réglages.
2. Faites défiler jusqu’au bas de la page et sélectionnez **Show Advanced Settings (Afficher les paramètres avancés)** et sélectionnez l’affichage **Device Settings (Réglages de l’appareil)** Sous **Native Social Login (Connexion sociale native)**, activez la bascule **Native Social Login (Activer la connexion avec Apple)**.

   <Frame>![Application Client Settings: Advanced Device Settings](/images/fr-ca/cdy7uua7fh8z/2xkQ13r9yCb4GBZdeczZjJ/a3f16a07411d8008d62c66c76d3794a2/Native_App_-_Device_Settings_-_French.png)</Frame>

3. Sous **iOS**, renseignez le champ **ID de l’application** avec l’ID de l’application/l’identifiant du bundle.
4. Accédez à [Auth0 Dashboard >Authentification > Social (Sociale)](https://manage.auth0.com/#/connections/social) et sélectionnez **Create Connection (Créer une connexion)**.
5. Sélectionnez la connexion **Apple** et donnez votre consentement.
6. Sur l’onglet **Settings (Réglages)**, renseignez les champs suivants :

   * **ID d’équipe Apple**
   * **Client Secret Signing Key (Clé de connexion secrète du client)**
   * **ID de clé**

     <Frame>![Apple Social Connection Settings](/images/fr-ca/cdy7uua7fh8z/3mTTVYnrwbVYnUx5Mzy0V9/4701f5d75f87256673f01bd10ec7c9a3/Apple_Connection.png)</Frame>

7. Sélectionnez l’affichage **Applications** pour activer la connexion pour votre application.
8. Cliquez sur **Save (Enregistrer)**.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Les applications natives ne peuvent pas être testées à partir d’un navigateur. Cela signifie que le bouton **Try Connection (Essayer la connexion)** dans la connexion Apple sert uniquement à tester les flux de type Web.

</Callout>

## Déconnexion

Étant donné que l’implémentation de la connexion iOS native n’utilise pas de flux standard basés sur un navigateur, les propriétaires d’applications doivent également veiller à effectuer la déconnexion de manière appropriée. Lorsqu’une application doit effectuer une déconnexion, elle doit effectuer les actions suivantes :

* [Révoquer le jeton d’actualisation Auth0](/docs/fr-ca/api/authentication#revoke-refresh-token)
* Supprimer le jeton d’actualisation Auth0 stocké dans la iCloud Keychain
* Supprimer l’identifiant utilisateur Apple stocké dans la iCloud Keychain
  Gardez également à l’esprit que la déconnexion peut résulter des actions de l’utilisateur (par exemple, en cliquant sur un bouton « Déconnexion ») ou d’un utilisateur révoquant l’accès à l’application en question. Ce dernier sera indiqué par la méthode native [ASAuthorizationAppleIDProvider.getCredentialState](https://developer.apple.com/documentation/authenticationservices/asauthorizationappleidprovider/3175423-getcredentialstate).

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Une nuance de l’IdP d’Apple est qu’il ne renvoie que les permissions demandées (telles que le courriel, le prénom et le nom de famille) dans le jeton d’ID sur la **première** réponse. Des approches plus destructives de déconnexion (telles que la suppression de l’utilisateur) pourraient entraîner la perte d’informations de profil, ce qui obligerait les utilisateurs finaux à désautoriser et à réautoriser une application.

</Callout>

## En savoir plus

* [Politique de limites anti-attaques](/docs/fr-ca/troubleshoot/customer-support/operational-policies/rate-limit-policy)