---
title: "Migrer des utilisateurs depuis Azure"
permalink: "migrate-users-from-azure"
'description': "Comment transférer des utilisateurs d’Azure vers Auth0"
'og:title': "Migrer des utilisateurs depuis Azure"
'og:description': "Comment transférer des utilisateurs d’Azure vers Auth0"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Migrer des utilisateurs depuis Azure"
'twitter:description': "Comment transférer des utilisateurs d’Azure vers Auth0"
---

Auth0 prend en charge l’importation d’utilisateurs depuis Azure en utilisant le [flux ROPC d’Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth-ropc) dans les [scripts de connexion aux bases de données personnalisées](/docs/fr-ca/authenticate/database-connections/custom-db/templates/login) d’Auth0.

1. [Enregistrez une application cliente publique](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) dans les locataires ou les répertoires respectifs en tant que **client public**, puis stockez en toute sécurité les identifiants et les secrets client fournis pour les appels d’API.
2. Lorsqu’on vous demande qui peut utiliser cette application ou accéder à cette API, choisissez **Accounts in any organizational directory (Comptes dans n’importe quel répertoire de l’organisation)**.
3. Dans la section Graphique Microsoft, accordez les autorisations `Directory.Read.All` et `User.Read`.
4. Si votre application est destinée aux particuliers, [configurez un flux d’identification du propriétaire de la ressource par mot de passe dans Azure Active Directory B2C](https://learn.microsoft.com/en-us/azure/active-directory-b2c/add-ropc-policy?tabs=app-reg-ga&pivots=b2c-user-flow).

Vous pouvez maintenant utiliser le flux ROPC. Les extraits suivants sont des exemples d’appel.

##### Modèle de script de connexion d’Azure AD :

```javascript lines expandable
function login(email, password, callback) {
      const axios = require('axios').default;
      const qs = require('qs');
    	const jwtDecode = require('jwt-decode').default;

       const data = { 'client_id': {{YOUR_AZURE_APP_CLIENT_ID}},
             'scope': 'user.read openid profile offline_access',
             'username': email,
             'password': password,
             'grant_type': 'password',
             'client_secret': {{YOUR_AZURE_APP_CLIENT_SECRET}}
             };
const options = {
  method: 'POST',
  headers: { 'content-type': 'application/x-www-form-urlencoded' },
  data: qs.stringify(data),
  url: 'https://login.microsoftonline.com/{{AZURE_TENANT_ID}}/oauth2/v2.0/token',
};

axios(options).then(
	response => {
  // in a production setting it would be best to validate this JWT fully before reading claims
  const claims = jwtDecode(response.data.id_token);

  if (response.statusCode === 401) return callback();

  callback(null, {
  // this is a simple example of properties that can be mapped back to the auth0 user profile
  // you are free to choose exactly what maps back over based on what data you get from the azure token
  user_id: claims.sub,
  nickname: claims.name,
  email: claims.preferred_username
});

}
      );

    }
```

##### Modèles de script de connexion pour B2C :

```javascript lines expandable
function login(email, password, callback) {
      const axios = require('axios').default;
      const qs = require('qs');
    	const jwtDecode = require('jwt-decode').default;

       const data = { 'client_id': {{YOUR_B2C_APP_CLIENT_ID}},
             'scope': 'openid {{YOUR_B2C_APP_CLIENT_ID}} offline_access profile',
             'username': email,
             'password': password,
             'grant_type': 'password',
             };
const options = {
  method: 'POST',
  headers: { 'content-type': 'application/x-www-form-urlencoded' },
  data: qs.stringify(data),
  url: 'https://{{TENANT_NAME}}.b2clogin.com/{{TENANT_NAME}}.onmicrosoft.com/{{B2C_POLICY_NAME}}/oauth2/v2.0/token',
};

axios(options).then(
	response => {
  // in a production setting it would be best to validate this JWT fully before reading claims
  const claims = jwtDecode(response.data.access_token);
  if (response.statusCode === 401) return callback();

  callback(null, {
  // this is a simple example of properties that can be mapped back to the auth0 user profile
  // you are free to choose exactly what maps back over based on what data you get from the azure token
  user_id: claims.sub,
  nickname: claims.given_name,
  email: claims.emails[0]
});
}
      );
    }
```

