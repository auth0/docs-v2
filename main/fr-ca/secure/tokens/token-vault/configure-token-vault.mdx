---
title: "Configure Token Vault"
permalink: "configure-token-vault"
'description': "Learn how to configure Token Vault. "
'og:title': "Configure Token Vault"
'og:description': "Learn how to configure Token Vault. "
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Configure Token Vault"
'twitter:description': "Learn how to configure Token Vault. "
---

<Warning>

Token Vault is currently available in Early Access for public cloud tenants. By using this feature, you agree to the applicable Free Trial terms in Okta’s [Master Subscription Agreement](https://www.okta.com/legal). To learn more about Auth0's product release cycle, read [Product Release Stages](/docs/fr-ca/troubleshoot/product-lifecycle/product-release-stages). To participate in this program, contact [Auth0 Support](https://support.auth0.com/) or your Technical Account Manager.

</Warning>

Once a user authenticates with a [supported external provider](https://auth0.com/ai/docs/integrations/overview) and authorizes the connection, your application can <Tooltip href="/docs/fr-ca/glossary?term=access-token" tip="Jeton d’accès
Identifiant d’autorisation, sous la forme d’une chaîne opaque ou d’un JWT, utilisé pour accéder à une API." cta="Voir le glossaire">access Token</Tooltip> Vault to exchange an Auth0 token for an external provider’s access token.

To configure Token Vault, you need to:

1. Enable Token Vault for a supported social or enterprise connection.
2. Configure your application with the Token Vault grant type.
3. Configure the token exchange for your application:

   * [Refresh token exchange](/docs/fr-ca/secure/tokens/token-vault/refresh-token-exchange-with-token-vault)
   * [Access token exchange](/docs/fr-ca/secure/tokens/token-vault/access-token-exchange-with-token-vault)
4. Manage tokensets within the Token Vault for your connection.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

If you have previously set your MFA policy to **Always** in the Auth0 Dashboard, you need to set it to **Never** to retrieve an access token from Token Vault. Otherwise, you will receive an error. To learn more about the different MFA policies, read [Enable MFA in the Auth0 Dashboard](/docs/fr-ca/secure/multi-factor-authentication/enable-mfa#enable-mfa-in-the-auth0-dashboard).

If you need to trigger MFA challenges for interactive flows, enable **Customize MFA Factors using Actions** when [setting up MFA for your tenant](/docs/fr-ca/secure/multi-factor-authentication/customize-mfa/customize-mfa-selection-universal-login#prepare-your-tenant). You can then use an Action to trigger an MFA challenge based on the `event.transaction.protocol` property. To learn more, read [Customize MFA selection for Universal Login](/docs/fr-ca/secure/multi-factor-authentication/customize-mfa/customize-mfa-selection-universal-login).

</Callout>

## Configure connection

Use the <Tooltip href="/docs/fr-ca/glossary?term=auth0-dashboard" tip="Auth0 Dashboard
Principal produit d’Auth0 pour configurer vos services." cta="Voir le glossaire">Auth0 Dashboard</Tooltip> or <Tooltip href="/docs/fr-ca/glossary?term=management-api" tip="Management API
Un produit permettant aux clients d’effectuer des tâches administratives." cta="Voir le glossaire">Management API</Tooltip> to configure a supported social or enterprise connection to retrieve and store access tokens for external APIs in the Token Vault.

Once you enable Token Vault for your connection, access and <Tooltip href="/docs/fr-ca/glossary?term=refresh-token" tip="Jeton d’actualisation
Jeton utilisé pour obtenir un jeton d’accès renouvelé sans obliger les utilisateurs à se connecter à nouveau." cta="Voir le glossaire">refresh tokens</Tooltip> will no longer be stored in the user’s `identities` array. Instead, they will be stored in a secure <Tooltip href="/docs/fr-ca/glossary?term=tokenset" tip="Tokenset
Contains the access and refresh tokens needed to call an external provider's APIs." cta="Voir le glossaire">tokenset</Tooltip> within the Token Vault. To learn more, read [Manage tokensets](#manage-tokensets).

<Tabs><Tab title="Auth0 Dashboard">

To enable Token Vault for a supported social and enterprise/custom connection:

1. Navigate to **Authentication > Social Connections** or **Enterprise Connections**.
2. Select **Create Connection** or select an existing connection.
3. In **Permissions**, select the desired scopes for your connection. You can filter by scope name or keywords. Whenever the user is redirected to authorize this connection, Auth0 always requests the scopes you selected. At runtime, this list is automatically completed with any additional scopes included in the `connection_scope` parameter of the authorization request.
4. In **Advanced**, toggle **Enable Token Vault**.
5. Select **Save Changes**.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/69jDhgpWbFY1npKDNY9wOT/360db4a0140ff3a3a68f169f3b99c98c/Screenshot_2025-04-03_at_07.49.56.png)</Frame>

</Tab><Tab title="Management API">

To enable Token Vault for a supported social and enterprise connection, run the following bash script to set `federated_connections_access_tokens` to `true` in the `options` object:

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

When you use the `options` parameter when making a `PATCH` call to the [Update a connection](https://auth0.com/docs/api/management/v2/connections/patch-connections-by-id) endpoint, you override the existing `options` object with the `options` object in your request body. As a result, make sure you include your entire `options` object in your request body.

</Callout>

```bash lines
curl --location --request PATCH 'https://{tenantDomain}/api/v2/clients/{clientId}' \
  --header 'Content-Type: application/json' \
  --header 'Authorization: Bearer {your_management_api_access_token}' \
  --data '{
    "grant_types": [
      "authorization_code",
      "refresh_token",
      "urn:auth0:params:oauth:grant-type:token-exchange:federated-connection-access-token"
    ]
  }'
```

</Tab></Tabs>

## Configure application

Configure your application with the Token Vault grant type using the Auth0 Dashboard or Management API.

Only certain types of clients can use the Token Vault grant type:

1. The client must be a first-party client, i.e. the `is_first_party` property is `true`.
2. The client must be a confidential client with a valid authentication mechanism, i.e. the `token_endpoint_auth_method` property must not be set to `none`.
3. The client must be OIDC conformant, i.e. the `oidc_conformant` must be `true`.

<Tabs><Tab title="Auth0 Dashboard">

1. Navigate to **Applications > Applications**.
2. Select the application you want to configure.
3. Under **Advanced Settings > Grant Types**, select the **Token Vault** grant type.
4. Select **Save Changes**.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/4pDrKjLpUISfhhGAfc0EaU/a0c20a504c080ab32343e045bf99967d/Screenshot_2025-09-15_at_2.51.28â__PM.png)</Frame>

</Tab><Tab title="Management API">

To enable Token Vault for an application, make a `PATCH` call to the [Update a Client](https://auth0.com/docs/api/management/v2/clients/patch-clients-by-id) endpoint to add the `urn:auth0:params:oauth:grant-type:token-exchange:federated-connection-access-token` grant type to the client JSON object:

```bash lines
curl --location --request PATCH 'https://{tenantDomain}/api/v2/connections/{connectionId}' \
  --header 'Content-Type: application/json' \
  --header 'Authorization: Bearer {your_management_api_access_token}' \
  --header 'Accept: application/json' \
  --data '{
    "options": {
      "federated_connections_access_tokens": {
        "active": true
      },
      ...
    }
  }'
```

</Tab></Tabs>

## Manage tokensets

For each user's authorized connection, like Google or Microsoft, Token Vault creates a secure container called a tokenset. A tokenset contains the access and refresh tokens needed to call that external provider's APIs on the user's behalf.

To manage tokensets for a user, use the Management API:

* [Get user's tokensets](#get-user-s-tokensets)
* [Delete a tokenset](#delete-a-tokenset)

### Get user’s tokensets

To get a user's tokensets, you need a [Management API access token](/docs/fr-ca/secure/tokens/access-tokens/management-api-access-tokens) with the `read:federated_connections_tokensets` scope.

Make a `GET` request to the `/federated-connections-tokensets` endpoint:

```bash lines
curl --request GET \
  --url 'https://{tenantDomain}/api/v2/users/{user_id}/federated-connections-tokensets' \
  --header 'Authorization: Bearer {your_management_api_access_token}'
```

If successful, you should receive a list of tokensets for the user:

```json lines
Status Code: 200
[{
  "connection": "google-oauth2",
  "id": "some-unique-tokenset-id1",
  "issued_at": 1733455897,
  "expires_at": 1733455897,
  "last_used_at": 1733453897,
  "scope": "https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/calendar.events",
},{
  "id": "some-unique-tokenset-id2",
  "connection": "google-oauth2",
  "issued_at": 1733455897,
  "expires_at": 1733455897,
  "last_used_at": 1733453897,
  "scope": "https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/calendar.events",
},{
  "connection": "google-oauth2",
  "issued_at": 1733455897,
  "id": "some-unique-tokenset-id3",
  "expires_at": 1733455897,
 "last_used_at": 1733453897,
  "scope": "Calendar.Read Calendar.Write",
}]
```

**Note:** The value for `last_used_at` is updated max once per day.

### Delete a tokenset

To delete a tokenset, you need a [Management API access token](/docs/fr-ca/secure/tokens/access-tokens/management-api-access-tokens) with the `update:federated_connections_tokensets` scope.

Make a `DELETE` request to the `/tokensets` endpoint:

```bash lines
curl --request DELETE \
  --url 'https://{tenantDomain}/api/v2/users/{user_id}/federated-connections-tokensets/{tokenset_id}' \
  --header 'Authorization: Bearer {your_management_api_access_token}'
```

If successful, you should receive the following response:

```json lines
Response: 204 No-Content
```

When you delete a tokenset, Auth0 removes the external provider’s access and refresh tokens from the Token Vault. This does not revoke the external provider’s tokens, and the refresh token could still be used to obtain new access tokens. You have to manually revoke the tokens for the external provider if they have been shared or copied elsewhere.