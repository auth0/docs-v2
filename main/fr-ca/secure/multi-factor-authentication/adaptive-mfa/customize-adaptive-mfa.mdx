---
title: "Personnaliser l’authentification multifacteur (MFA) adaptative"
permalink: "customize-adaptive-mfa"
'description': "Découvrez comment personnaliser l'Authentification multifacteur (MFA)."
'og:title': "Personnaliser l’authentification multifacteur (MFA) adaptative"
'og:description': "Découvrez comment personnaliser l'Authentification multifacteur (MFA)."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Personnaliser l’authentification multifacteur (MFA) adaptative"
'twitter:description': "Découvrez comment personnaliser l'Authentification multifacteur (MFA)."
---

Vous pouvez personnaliser l’authentification multifacteur (<Tooltip href="/docs/fr-ca/glossary?term=multifactor-authentication" tip="Authentification multifacteur (MFA)
Processus d’authentification de l’utilisateur qui utilise un facteur en plus du nom d’utilisateur et du mot de passe, tel qu’un code par SMS." cta="Voir le glossaire">MFA</Tooltip>) adaptative pour une variété de scénarios avec [Auth0 Actions](/docs/fr-ca/customize/actions).

## Quand personnaliser l’authentification multifacteur (MFA) adaptative

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Vous ne devez envisager de personnaliser l’authentification multifacteur (MFA) adaptative que si vos utilisateurs sont inscrits à la MFA et doivent utiliser une adresse électronique comme identifiant.

</Callout>

Si vos utilisateurs ne sont pas inscrits à la MFA, vous devriez utiliser l’autorisation par défaut pour l’authentification multifacteur (MFA) adaptative. Si un utilisateur n’est pas inscrit à la MFA et que votre action évalue le risque comme étant élevé, vous avez très peu d’options pour arrêter un acteur menaçant.

Avant de commencer à personnaliser l’authentification multifacteur (MFA) adaptative, posez-vous quelques questions :

* À quel niveau de confiance souhaitez-vous déclencher la MFA?
* Comment voulez-vous mesurer le risque?
* Voulez-vous qu’Auth0 mesure la confiance ou souhaitez-vous une mesure personnalisée?
* Comment allez-vous gérer les utilisateurs qui ne sont pas inscrits à la MFA?

## Évaluer la confiance

L’authentification multifacteur (MFA) adaptative calcule un pointage total de la confiance basé sur l’analyse de trois évaluations. Chaque évaluation a son propre pointage de confiance. Pour en savoir plus, consultez [Adaptive MFA](/docs/fr-ca/secure/multi-factor-authentication/adaptive-mfa).

### Pointages de confiance

Les pointages de confiance et leurs actions associées sont décrits ci-dessous :

<table class="table"><thead>
<tr>
<th><strong>Pointage de confiance</strong></th>
<th><strong>Description</strong></th>
<th><strong>Action</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`low`</td>
<td>La transaction de connexion ne correspond pas aux modèles affichés précédemment par l’utilisateur.</td>
<td>Exiger MFA.</td>
</tr>
<tr>
<td>`medium`</td>
<td>La transaction de connexion correspond en quelque sorte aux modèles affichés précédemment par l’utilisateur.</td>
<td>Ne pas exiger MFA.</td>
</tr>
<tr>
<td>`high`</td>
<td>La transaction de connexion correspond étroitement aux modèles précédemment affichés par l’utilisateur.</td>
<td>Ne pas exiger MFA.</td>
</tr>
<tr>
<td>`neutral`</td>
<td>N/A. Réservé pour une utilisation future.</td>
<td>N/A. Réservé pour une utilisation future.</td>
</tr>
</tbody>
</table>

### Pointage de confiance personnalisé

Si vous souhaitez implémenter votre propre méthode pour évaluer le pointage de confiance total de différents scénarios, vous pouvez utiliser les données dises dans l’objet [RiskAssessment](#riskassessment-context-object).

Consultez les exemples ci-dessous pour découvrir comment l’authentification multifacteur (MFA) adaptative évalue la confiance dans différents cas d’utilisation.

#### Exemples de scénarios à haut risque et à faible confiance

Le tableau suivant décrit les scénarios à haut risque qui entraînent un `low` pointage de confiance :

<table class="table"><thead>
<tr>
<th><strong>État de l'utilisateur</strong></th>
<th><strong>Friction de connexion souhaitée</strong></th>
<th><strong>Politique d'inscription souhaitée</strong></th>
<th><strong>Mise en œuvre</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inscrit dans MFA</td>
<td>Ne pas exiger le MFA</td>
<td>S.O. (utilisateur déjà inscrit)</td>
<td>Utiliser une action pour contourner le MFA</td>
</tr>
<tr>
<td>Non inscrit dans MFA</td>
<td>Exiger une vérification par courriel</td>
<td>Passer l'inscription (ne pas collecter d'authentifiants additionnels)</td>
<td>Comportement par défaut (aucune action liée à MFA)</td>
</tr>
<tr>
<td>Inscrit dans MFA</td>
<td>Ne pas exiger d'authentifiants additionnels</td>
<td>Ne pas utiliser d'action liée à MFA)</td>
<td></td>
</tr>
<tr>
<td>Non inscrit à MFA</td>
<td>Exiger la vérification du courriel</td>
<td>Exiger l'inscription à MFA (collecter des authentifiants supplémentaires)</td>
<td>Utiliser une action pour forcer l'inscription à MFA (modèle disponible)</td>
</tr>
</tbody>
</table>

#### Exemples de scénarios à haut risque et à forte confiance

Le tableau suivant décrit les scénarios à faible risque qui entraînent un pointage `high` de confiance :

<table class="table"><thead>
<tr>
<th><strong>État de l'utilisateur</strong></th>
<th><strong>Friction de connexion souhaitée</strong></th>
<th><strong>Politique d'inscription souhaitée</strong></th>
<th><strong>Mise en œuvre</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inscrit à l'authentification MFA</td>
<td>Pas de friction</td>
<td>S.O. (utilisateur déjà inscrit)</td>
<td>Comportement par défaut (pas d'action liée à l'AMF)</td>
</tr>
<tr>
<td>Pas inscrit à la MFA</td>
<td>Pas de friction</td>
<td>Sauter l'inscription (ne pas collecter d'authentifiants supplémentaires)</td>
<td>Comportement par défaut (pas d'action liée à la MFA)</td>
</tr>
<tr>
<td>Pas inscrit à la MFA</td>
<td>Pas de friction</td>
<td>Exiger l'inscription à l'AMF (collecter un authentifiant supplémentaire)</td>
<td>Utiliser une action pour forcer l'inscription à la MFA (modèle disponible)</td>
</tr>
</tbody>
</table>

### Objet riskAssessment

L’objet `riskAssessment` contient le pointage de confiance total, les informations de version et les détails des évaluations individuelles.

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possibles</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`confidence`</td>
<td>Score de confiance global calculé par l’authentification multifacteur (MFA) adaptative.</td>
<td>chaîne</td>
<td>`low`, `medium`, `high`, `neutral`</td>
</tr>
<tr>
<td>`version`</td>
<td>Identifiant de version de l’API d’évaluation des risques.</td>
<td>chaîne</td>
<td>`1`</td>
</tr>
<tr>
<td>`assessments`</td>
<td>Objet contenant les détails d’une évaluation individuelle.</td>
<td>objet</td>
<td>Lire <a href="#assessments-object">objet évaluations</a></td>
</tr>
</tbody>
</table>

```js lines expandable
exports.onExecutePostLogin = async (event, api) => {
  if (event.authentication && event.authentication.riskAssessment) {
    event.authentication.riskAssessment = {
      confidence: 'low' | 'medium' | 'high' | 'neutral',
      version: '1',
      assessments: {
        UntrustedIP: {
          confidence: 'low' | 'medium' | 'high' | 'neutral',
          code: 'not_found_on_deny_list' | 'found_on_deny_list',
          details: { // only if 'found_on_deny_list'
            ip: '192.168.1.1',
            matches: '192.168.0/64',
            source: 'firehol',
            category: 'abuse'
          }
        },
        NewDevice: {
          confidence: 'low' | 'medium' | 'high' | 'neutral',
          code: 'match' | 'partial_match' | 'no_match',
          details: {
            device: 'known' | 'unknown',
            useragent: 'known' | 'unknown',
          }
        },
        ImpossibleTravel: {
          confidence: 'low' | 'medium' | 'high' | 'neutral',
          code: 'missing_geoip', | 'anonymous_proxy' | 'unknown_location' | 'initial_login' | 'location_history_not_found' | 'invalid_travel' | 'minimal_travel_from_last_login' | 'impossible_travel_from_last_login' | 'substantial_travel_from_last_login' | 'travel_from_last_login'
        } 
      },
       PhoneNumber: {
          code: "requires_verification | ok",
          confidence: "low | medium | high | neutral",
          details: {
	        	lineType: "FIXED_LINE | MOBILE | FIXED_LINE_OR_MOBILE | TOLL_FREE | PREMIUM_RATE | SHARED_COST | VOIP | PERSONAL_NUMBER | PAGER | UAN | UNKNOWN"
	            isValid: true | false,
		        countryCode: 1,
		        number: "+12223334444"
        }
      }
    };
  }
}
```

### Objet assessments

L’objet `assessments` contient des détails sur les trois évaluations de risques individuelles :

1. [Évaluation NewDevice](#newdevice-assessment)
2. [Évaluation ImpossibleTravel](#impossibletravel-assessment)
3. [Évaluation UntrustedIP](#untrustedip-assessment)
4. [Évaluation PhoneNumber](#phonenumber-assessment)

Chaque évaluation comprend un [pointage de confiance](#confidence-scores), un code qui décrit le résultat de l’évaluation et des informations contextuelles supplémentaires.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Dans le cas improbable d’une défaillance du système dorsal d’évaluation, le code de l’évaluation sera `assessment_not_available` et la confiance associée sera `low` car Auth0 adopte par défaut un comportement sécurisé. Vous pouvez remplacer cette notation à l’aide d’Actions. Pour en savoir plus, lisez [Gérer en toute sécurité les cas où Auth0 ne parvient pas à exécuter les évaluateurs](#safely-handle-when-auth0-fails-execute-assessors).

</Callout>

#### Évaluation NewDevice

L’évaluation `NewDevice` détermine si l’utilisateur se connecte à partir d’un appareil connu et contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possible</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`confidence`</td>
<td>Pointage de confiance calculé par l’authentification multifacteur (MFA) adaptative.</td>
<td>chaîne</td>
<td>`low`, `medium`, `high`, `neutral`</td>
</tr>
<tr>
<td>`code`</td>
<td>Résultat de l’évaluation.</td>
<td>chaîne</td>
<td>`match`, `partial_match`, `no_match`, `initial_login`, `unknown_device`, `no_device_history`, `assessment_not_available`</td>
</tr>
<tr>
<td>`details`</td>
<td>Renseignements contextuels supplémentaires.</td>
<td>objet</td>
<td>Voir le tableau ci-dessous.</td>
</tr>
</tbody>
</table>

##### Propriété du code d’évaluation NewDevice

La propriété du `code` d’évaluation `NewDevice` est égale à l’une des valeurs suivantes :

<table class="table"><thead>
<tr>
<th><strong>Valeur</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`match`</td>
<td>Les valeurs de propriété de l’objet `details` sont équivalentes.</td>
</tr>
<tr>
<td>`partial_match`</td>
<td>Les valeurs de propriété de l’objet `details` sont similaires.</td>
</tr>
<tr>
<td>`no_match`</td>
<td>Les valeurs de propriété de l’objet `details` sont différentes.</td>
</tr>
<tr>
<td>`initial_login`</td>
<td>L’utilisateur s’est connecté pour la première fois sur l’appareil.</td>
</tr>
<tr>
<td>`unknown_device`</td>
<td>Auth0 n’a pas pu obtenir les métadonnées de l’appareil.</td>
</tr>
<tr>
<td>`no_device_history`</td>
<td>Il n’y a pas d’historique de connexion associé à l’appareil.</td>
</tr>
<tr>
<td>`assessment_not_available`</td>
<td>Auth0 n’a pas pu effectuer une évaluation de l’appareil.</td>
</tr>
</tbody>
</table>

##### Objet de détails d’évaluation NewDevice

Si la valeur de la propriété du `code` équivaut à `match`, `partial_match` ou `no_match`, l’évaluation `NewDevice` contient l’objet `details` avec les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs admises</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`device`</td>
<td>Appareil de l’utilisateur.</td>
<td>string</td>
<td>`known`, `unknown`</td>
</tr>
<tr>
<td>`useragent`</td>
<td>Agent utilisateur.</td>
<td>string</td>
<td>`known`, `unknown`</td>
</tr>
</tbody>
</table>

#### Évaluation ImpossibleTravel

L’évaluation `ImpossibleTravel` détermine si l’utilisateur se connecte à partir d’un emplacement qui pourrait indiquer un possible déplacement et contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possibles</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`confidence`</td>
<td>Score de confiance calculé par l'authentification multifacteur (MFA) adaptative.</td>
<td>chaîne</td>
<td>`low`, `medium`, `high`, `neutral`</td>
</tr>
<tr>
<td>`code`</td>
<td>Résultat de l’évaluation.</td>
<td>chaîne</td>
<td>`minimal_travel_from_last_login`, `travel_from_last_login`, `substantial_travel_from_last_login`, `impossible_travel_from_last_login`, `invalid_travel`, `missing_geoip`, `anonymous_proxy`, `unknown_location`, `initial_login`, `location_history_not_found`, `assessment_not_available`</td>
</tr>
</tbody>
</table>

#### Évaluation UntrustedIP

L’évaluation `UntrustedIP` détermine si l’adresse IP de l’utilisateur est présente dans le référentiel d’adresses IP de faible réputation d’Auth0 (« liste de refus ») et contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possibles</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`confidence`</td>
<td>Score de confiance calculé par l’authentification multifacteur (MFA) adaptative.</td>
<td>chaîne</td>
<td>`low`, `medium`, `high`, `neutral`</td>
</tr>
<tr>
<td>`code`</td>
<td>Résultat de l’évaluation.</td>
<td>chaîne</td>
<td>`not_found_on_deny_list`, `found_on_deny_list`, `invalid_ip_address`, `assessment_not_available`</td>
</tr>
<tr>
<td>`details`</td>
<td>Informations contextuelles supplémentaires.</td>
<td>object</td>
<td>Voir le tableau ci-dessous.</td>
</tr>
</tbody>
</table>

##### Objet de détails d’évaluation UntrustedIP

Si la valeur de la propriété du `code` d’évaluation `UntrustedIP` est égale à `found_on_deny_list`, l’objet `details` est présent et contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Property</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Possible values</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`ip`</td>
<td>Adresse IP de l'appareil.</td>
<td>string</td>
<td>Toute adresse IPv4 ou IPv6 valide.</td>
</tr>
<tr>
<td>`matches`</td>
<td>Masque de sous-réseau auquel appartient l'adresse IP.</td>
<td>string</td>
<td>Tout masque de sous-réseau IPv4 ou IPv6 valide.</td>
</tr>
<tr>
<td>`source`</td>
<td>Nom de la source de renseignements sur les menaces pour la liste de refus.</td>
<td>string</td>
<td>Tout texte valide.</td>
</tr>
<tr>
<td>`category`</td>
<td>Catégorie indiquant pourquoi l'adresse IP n'est pas fiable.</td>
<td>string</td>
<td>`abuse`, `anonymizer`, `datacenter`, `reputation`, `unroutable`</td>
</tr>
</tbody>
</table>

##### Propriété de catégorie d’objet détails d’évaluation UntrustedIP

La propriété de `catégorie` d’objet `détails` d’évaluation `UntrustedIP` décrit la raison générale pour laquelle l’authentification multifacteur (MFA) adaptative considère une adresse IP donnée comme étant non fiable et est égale à l’une des valeurs suivantes :

<table class="table"><thead>
<tr>
<th><strong>Valeur</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`abuse`</td>
<td>L’adresse IP a présenté des comportements abusifs ou a été identifiée comme étant membre de robots.</td>
</tr>
<tr>
<td>`anonymizer`</td>
<td>L’adresse IP appartient à des services d’anonymisation tels que les fournisseurs de VPN, les proxys ouverts et les nœuds de sortie TOR.</td>
</tr>
<tr>
<td>`datacenter`</td>
<td>L’adresse IP appartient aux fournisseurs d’hébergement en nuage et aux centres de données de colocation.</td>
</tr>
<tr>
<td>`reputation`</td>
<td>L’adresse IP a un mauvais score de réputation basé sur l’activité.</td>
</tr>
<tr>
<td>`unroutable`</td>
<td>L’adresse IP ne se trouve dans aucune plage allouée ou déléguée par un registre Internet autorisé ou autorisée pour un usage public.</td>
</tr>
</tbody>
</table>

#### Évaluation PhoneNumber

L’évaluation `PhoneNumber` évalue le risque qu’un numéro de téléphone représente pour une transaction entrante et contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possibles</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`code`</td>
<td>Décrit le résultat de l’évaluation.</td>
<td>chaîne</td>
<td>`ok`, `requires_verification`, `phone_number_not_provided`, `assessment_not_available`</td>
</tr>
<tr>
<td>`confidence`</td>
<td>Score de confiance calculé par l’authentification multifacteur (MFA) adaptative.</td>
<td>chaîne</td>
<td>`low`, `medium`, `high`, `neutral`</td>
</tr>
<tr>
<td>`details`</td>
<td>Informations contextuelles supplémentaires.</td>
<td>object</td>
<td>Voir le tableau ci-dessous.</td>
</tr>
</tbody>
</table>

##### Objet de détails d’évaluation PhoneNumber

L’objet de `details` d’évaluation `PhoneNumber` contient les propriétés suivantes :

<table class="table"><thead>
<tr>
<th><strong>Propriété</strong></th>
<th><strong>Description</strong></th>
<th><strong>Type</strong></th>
<th><strong>Valeurs possible</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`lineType`</td>
<td>Type de ligne téléphonique</td>
<td>chaîne</td>
<td>`FIXED_LINE`, `MOBILE`, `FIXED_LINE_OR_MOBILE`, `TOLL_FREE`, `PREMIUM_RATE`, `SHARED_COST`, `VOIP`, `PERSONAL_NUMBER`, `PAGER`, `UAN`, `UNKNOWN`</td>
</tr>
<tr>
<td>`isValid`</td>
<td>Renvoie la validité du numéro</td>
<td>booléen</td>
<td>`true`, `false`</td>
</tr>
<tr>
<td>`countryCode`</td>
<td>Code du pays d’origine du téléphone</td>
<td>entier</td>
<td>`0-999`</td>
</tr>
<tr>
<td>`number`</td>
<td>Numéro de téléphone</td>
<td>chaîne</td>
<td>Numéro valide incluant `countryCode`</td>
</tr>
</tbody>
</table>

## Résultats des actions

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Les actions qui déclenchent la MFA sont prioritaires sur le comportement par défaut de l’authentification multifacteur (MFA) adaptative.

</Callout>

Si l’une de vos actions déclenche la MFA en fonction du pointage de confiance, la stratégie Authentification multifacteur (MFA) adaptative par défaut déclenche la MFA lorsque le pointage de confiance est `low`.

Le tableau suivant montre les résultats possibles en fonction de la combinaison d’actions et d’actions d’autorisations de l’authentification multifacteur (MFA) adaptative par défaut.

<table class="table"><thead>
<tr>
<th><strong>Résultat de l’action</strong></th>
<th><strong>Action Authentification multifacteur (MFA) adaptative</strong></th>
<th><strong>Résultat</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Non autorisé</td>
<td>Déclencher MFA</td>
<td>Non autorisé</td>
</tr>
<tr>
<td>Non autorisé</td>
<td>MFA non requise</td>
<td>Non autorisé</td>
</tr>
<tr>
<td>Déclencher MFA</td>
<td>Déclencher MFA</td>
<td>Déclencher MFA</td>
</tr>
<tr>
<td>Déclencher MFA</td>
<td>MFA non requise</td>
<td>Déclencher MFA</td>
</tr>
<tr>
<td>MFA non requise</td>
<td>Déclencher MFA</td>
<td>Déclencher MFA</td>
</tr>
<tr>
<td>MFA non requise</td>
<td>MFA non requise</td>
<td>MFA non requise</td>
</tr>
</tbody>
</table>

## Modèles d’actions

Auth0 propose deux modèles d’actions basés sur l’authentification multifacteur (MFA) adaptative que vous pouvez personnaliser : [Authentification multifacteur (MFA) adaptative](#adaptive-mfa) et [Inscription à l’AMF requise](#require-mfa-enrollment).

### Modèle d’authentification multifacteur (MFA) adaptative

Ce modèle fournit un exemple et un point de départ sur la manière de créer un flux commercial personnalisé en utilisant des évaluations de risques individuelles.

```javascript lines expandable
/**
* Handler that will be called during the execution of a PostLogin flow.
*
* @param {Event} event - Details about the user and the context in which they are logging in.
* @param {PostLoginAPI} api - Interface whose methods can be used to change the behavior of the login.
*/
exports.onExecutePostLogin = async (event, api) => {
  if (event.authentication && 
      event.authentication.riskAssessment && 
      event.authentication.riskAssessment.assessments.NewDevice) {

  // Example condition: prompt MFA only based on the NewDevice 
    // confidence level, this will prompt for MFA when a user is logging in 
    // from an unknown device.
    let shouldPromptMfa;

    switch (event.authentication.riskAssessment.assessments.NewDevice.confidence) {
      case 'low':
      case 'medium':
        shouldPromptMfa = true;
        break;
      case 'high':
        shouldPromptMfa = false;
        break;
      case 'neutral':
        // When this assessor has no useful information about the confidence, 
        // do not prompt MFA.
        shouldPromptMfa = false;
        break;
    }

      // It only makes sense to prompt for MFA when the user has at least one 
      // enrolled MFA factor.
    const canPromptMfa = event.user.multifactor && event.user.multifactor.length > 0;

    if (shouldPromptMfa && canPromptMfa) {
      api.multifactor.enable('any', { allowRememberBrowser: true });
    }
  }
};
```

### Exiger un modèle d’inscription à la MFA

Ce modèle montre comment vous pouvez appliquer l’inscription à la MFA lorsque vous utilisez une stratégie d’authentification multifacteur standard ou adaptative. Il utilise `event.user.multifactor` pour vérifier si l’utilisateur est inscrit à la MFA et, si ce n’est pas le cas, l’invite à le faire.

```javascript lines
/**
* Handler that will be called during the execution of a PostLogin flow.
*
* @param {Event} event - Details about the user and the context in which they are logging in.
* @param {PostLoginAPI} api - Interface whose methods can be used to change the behavior of the login.
*/
exports.onExecutePostLogin = async (event, api) => {
  if (!event.user.multifactor || event.user.multifactor.length == 0) {
    api.multifactor.enable('any', { allowRememberBrowser: true });
  }
};
```

## Actions de cas d’utilisation

Voici quelques suggestions sur la manière de créer des actions personnalisées en fonction de votre cas d’utilisation.

### Effectuer une action si le pointage de confiance total est X

Évaluez la propriété `RiskAssessment.confidence`, puis comparez-la aux constantes `high`, `medium` ou `low` :

```js lines
exports.onExecutePostLogin = async (event, api) => {
  const { riskAssessment } = event.authentication || {};
  const riskIsMedium = riskAssessment && riskAssessment.confidence === 'medium';

  if (riskIsMedium) {
    // ....
  }
}
```

### Réaliser une action si le pointage de confiance est supérieur ou inférieur à X

Les pointages de confiance sont des valeurs discrètes (et non comprises dans une gamme); vous ne pouvez donc pas utiliser d’opérateurs de comparaison (tels que `<` ou `>`) pour évaluer plusieurs valeurs dans une seule condition.

Utilisez plusieurs conditions pour combiner logiquement tous les pointages de confiance que vous souhaitez gérer. Par exemple, si vous souhaitez savoir quand le pointage de confiance est plus élevé que `low`, vérifiez s’il est égale à `medium` ou à `high` :

```js lines
exports.onExecutePostLogin = async (event, api) => {
  const { riskAssessment } = event.authentication || {};
  const riskIsMediumOrHigh = riskAssessment && 
                                  (riskAssessment.confidence === 'high' || 
                                   riskAssessment.confidence === 'medium');

  if (riskIsMediumOrHigh) {
    // ...
  }
}
```

### Obtenir des détails supplémentaires si le pointage de confiance total est X

L’objet `riskAssessment` est enregistré dans vos journaux de locataire. Vous pouvez afficher les entrées du journal pour voir le pointage d’évaluation des risques et les facteurs déterminants (raisons).

Vous pouvez afficher l’objet `riskAssessment` et signaler les résultats à un autre endroit. Par exemple, vous pouvez envoyer un courriel ou sauvegarder un enregistrement dans une base de données externe.

```js lines
exports.onExecutePostLogin = async (event, api) => {
  const { riskAssessment } = event.authentication || {};
  const riskIsLow = riskAssessment && riskAssessment.confidence === 'low';

  if (riskIsLow) {
    // log(externalDatabase, riskAssessment);
  }
}
```

### Réaliser une action si une évaluation donnée a un résultat donné

Utilisez l’objet [assessments](#assessments-object) pour accéder aux détails des évaluations individuelles, y compris la propriété du `code` :

```js lines
exports.onExecutePostLogin = async (event, api) => {
  const { riskAssessment } = event.authentication || {};
  const { ImpossibleTravel } = riskAssessment && riskAssessment.assessments;

  if (ImpossibleTravel.code === 'impossible_travel_from_last_login') {
    // ...
  }
}
```

### Regroupez les évaluations pour obtenir un pointage de confiance total personnalisé.

Utilisez l’objet [assessments](#assessments-object) pour accéder aux détails des évaluations individuelles, puis utilisez la propriété `confidence`, la propriété du `code`, ou les deux.

Pour en savoir plus sur le pointage de confiance personnalisé, consultez [Pointage de confiance personnalisé](#custom-confidence-scoring).

### Bloquer la transaction en cours et renvoyer une erreur et un message si une évaluation donnée a un résultat donné

Utilisez l’objet [assessments](#assessments-object) pour accéder aux détails des évaluations individuelles, y compris la propriété du `code`.

Empêchez la transaction de connexion de se terminer en renvoyant la fonction de rappel avec un objet `UnauthorizedError` comme [paramètre d’erreur](/docs/fr-ca/troubleshoot/error-handling-best-practices). L’objet `UnauthorizedError` définit toujours `error` sur `unauthorized`, mais vous pouvez personnaliser le`error_message` :

```js lines
exports.onExecutePostLogin = async (event, api) => {
  const { riskAssessment } = event.authentication || {};
  const { ImpossibleTravel } = riskAssessment && riskAssessment.assessments;

  if (ImpossibleTravel.code === 'impossible_travel_from_last_login') {
    return api.access.deny('Login blocked due to impossible travel detected.')
  }
}
```

Ceci redirige l’utilisateur vers l’URL de rappel de l’application avec les paramètres `error` et `error_message` inclus.

### Gérer en toute sécurité les cas où Auth0 ne parvient pas à exécuter les évaluations

Auth0 attribue automatiquement un pointage de confiance `low` en cas d’échec de l’évaluation des risques.

Pour mitiger ce scénario, utilisez l’objet [assessments](#assessments-object) pour inspecter la propriété du `code` pour chaque évaluation individuelle et vérifier si la valeur est définie sur `assessment_not_available`.

## En savoir plus

* [Activer l’authentification multifacteur (MFA) adaptative](/docs/fr-ca/secure/multi-factor-authentication/adaptive-mfa/enable-adaptive-mfa)
* [Événements de journal Authentification multifacteur (MFA) adaptative](/docs/fr-ca/secure/multi-factor-authentication/adaptive-mfa/adaptive-mfa-log-events)
* [Déclencheurs d’actions : post-connexion - Objet API](/docs/fr-ca/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-api-object)
* [Déclencheurs d’actions : post-connexion – Objet d’événement](/docs/fr-ca/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-event-object)