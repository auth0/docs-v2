---
title: "Ajouter une autorisation à votre application Go"
permalink: "interactive"
'description': "Ce tutoriel explique comment ajouter une autorisation à une API Go."
'og:title': "Ajouter une autorisation à votre application Go"
'og:description': "Ce tutoriel explique comment ajouter une autorisation à une API Go."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/golang.png"
'twitter:title': "Ajouter une autorisation à votre application Go"
'twitter:description': "Ce tutoriel explique comment ajouter une autorisation à une API Go."
sidebarTitle: Go API
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Jwt from "/snippets/quickstart/backend/golang/jwt.go.mdx";
import Main from "/snippets/quickstart/backend/golang/main.go.mdx";

export const sections = [
  { id: "définir-les-autorisations", title: "Définir les autorisations" },
  { id: "installer-les-dépendances", title: "Installer les dépendances" },
  { id: "configuration-de-votre-application", title: "Configuration de votre application" },
  { id: "créer-un-logiciel-médiateur-pour-valider-les-jetons-d-accès", title: "Créer un logiciel médiateur pour valider les jetons d’accès" },
  { id: "protéger-les-points-de-terminaison-des-api", title: "Protéger les points de terminaison des API" }
]

<Recipe>
  <Content>
    Ce guide explique comment intégrer Auth0 à n’importe quelle application API Go, nouvelle ou ancienne, en utilisant le package [go-jwt-middleware](https://github.com/auth0/go-jwt-middleware).

    Si vous n’avez pas encore créé d’API dans votre Auth0 Dashboard, vous pouvez utiliser le sélecteur interactif pour créer une nouvelle API Auth0 ou sélectionner une API existante pour votre projet.

    Pour configurer votre première API via Auth0 Dashboard, consultez notre guide de démarrage.

    Chaque API Auth0 utilise l’identificateur API, dont votre application a besoin pour valider le jeton d’accès.

    <Info>
    **Vous ne connaissez pas Auth0 ?** Découvrez Auth0 et l’implémentation de l’authentification et de l’autorisation d’API en utilisant le cadre d’applications OAuth 2.0.
    </Info>

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Les autorisations vous permettent de définir comment les ressources peuvent être accessibles au nom de l’utilisateur avec un jeton d’accès donné. Par exemple, vous pouvez choisir d’accorder un accès en lecture à la ressource `messages` si les utilisateurs ont le niveau d’accès gestionnaire et un accès en écriture à cette ressource s’ils ont le niveau d’accès administrateur.

      Vous pouvez définir les autorisations autorisées dans la vue **Permissions (Autorisations)** de la section [API](https://manage.auth0.com/#/apis) d’Auth0 Dashboard. L’exemple suivant utilise la permission `read:messages`.

      ![Auth0 Dashboard> Applications > APIs (API) > [Specific API (API précise)] > Onglet Permissions (Autorisations)](/images/fr-ca/cdy7uua7fh8z/1s3Yp5zqJiKiSWqbPSezNO/677a3405b2853f5fdf9e42f6e83ceba7/Quickstarts_API_-_French.png)
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      Ajoutez un fichier `go.mod` pour répertorier toutes les dépendances nécessaires.

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Téléchargez les dépendances en exécutant la commande shell suivante :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Créez un fichier `.env` à la racine de votre répertoire de projet pour stocker la configuration de l’application. Renseignez ensuite les variables d’environnement :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      La fonction de logiciel médiateur `EnsureValidToken` valide le jeton d’accès. Vous pouvez appliquer cette fonction à tous les points de terminaison que vous souhaitez protéger. Si le jeton est valide, le point de terminaison libère les ressources. Si le jeton n’est pas valide, l’API renvoie une erreur `401 Authorization (Autorisation 401)`.

      Configurez le logiciel médiateur **go-jwt-middleware** pour vérifier les jetons d’accès des demandes entrantes.

      Par défaut, votre API sera configurée pour utiliser RS256 comme algorithme de signature des jetons. Puisque RS256 fonctionne en utilisant une paire de clés privée/publique, les jetons peuvent être vérifiés par rapport à la clé publique pour votre compte Auth0. Cette clé publique est accessible à [https://{yourDomain}/.well-known/jwks.json](https://%7Byourdomain%7D/.well-known/jwks.json).

      Inclure un mécanisme pour vérifier que le jeton a une **scope (permission)** suffisante pour accéder aux ressources demandées.

      Créer une fonction `HasScope` pour vérifier et s’assurer que le jeton d’accès a la bonne permission avant de renvoyer une réponse réussie.
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      Dans cet exemple, vous allez créer un point de terminaison `/api/public` qui n’utilise pas le logiciel médiateur `EnsureToken` car il est accessible aux requêtes non authentifiées.

      Créez un point de terminaison `/api/private` qui nécessite le logiciel médiateur `EnsureToken` car il n’est disponible que pour les requêtes authentifiées contenant un jeton d’accès, sans permission supplémentaire.

      Créez un point de terminaison `/api/private` qui nécessite le logiciel médiateur `EnsureToken` et `HasScope` car il n’est disponible que pour les requêtes authentifiées contenant un jeton d’accès dont la permission `read:messages` est accordée.

      <Info>
      Seule la portée `read:messages` est vérifiée par la fonction `HasScope`. Vous pouvez l’étendre ou en faire un logiciel médiateur autonome qui accepte plusieurs permissions pour s’adapter à votre cas d’utilisation.
      </Info>

      ### Faire un appel à votre API

      Pour appeler votre API, vous avez besoin d’un jeton d’accès. Vous pouvez obtenir un jeton d’accès à des fins de test dans la vue **Test** dans vos [API settings (Paramètres API)](https://manage.auth0.com/#/apis).

      ![Auth0 Dashboard> Applications > API > [API specifique] > Onglet Test](/images/fr-ca/cdy7uua7fh8z/6jeVBuypOGX5qMRXeJn5ow/8aa621c6d95e3f21115493a19ab05f7a/Quickstart_Example_App_-_API.png)

      Fournissez le Jeton d’accès comme un en-tête `Authorization (Autorisation)` dans vos requêtes.

      <CodeGroup>
      <AuthCodeBlock filename="cURL" icon="file-code" language="bash" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="C#" icon="file-code" language="csharp" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Go" icon="file-code" language="go" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Java" icon="file-code" language="java" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Node.JS" icon="file-code" language="javascript" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Obj-C" icon="file-code" language="obj-c" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="PHP" icon="file-code" language="php" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Python" icon="file-code" language="python" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Ruby" icon="file-code" language="ruby" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <AuthCodeBlock filename="Swift" icon="file-code" language="swift" lines="true">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      </CodeGroup>


      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré votre application, lancez votre application et vérifiez que :
      `GET /api/public` est disponible pour les demandes non authentifiées.
      `GET /api/private` est disponible pour les demandes authentifiées.
      `GET /api/private-scoped` est disponible pour les demandes authentifiées contenant un jeton d’accès avec la permission `read:messages`.
      </Note>
      </Section>

    ## Étapes suivantes

    Beau travail! Si vous en êtes arrivé là, vous devriez avoir la connexion, la déconnexion et les informations de profil utilisateur actives dans votre application.

    Cela conclut notre tutoriel de démarrage rapide, mais il y a tellement plus à explorer. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    *   [Auth0 Dashboard](https://manage.auth0.com/#) : apprenez à configurer et gérer votre locataire et vos applications Auth0
    *   [Trousse SDK go-jwt-middleware](https://github.com/auth0/go-jwt-middleware) : explorez en détail la trousse SDK utilisée dans ce tutoriel
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) : découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
      <CodeGroup>
        <Jwt />
        <Main />
      </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <CodeGroup>
        <Main />
        <Jwt />
      </CodeGroup>
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
