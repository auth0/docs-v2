---
title: "Ajouter une autorisation à votre application API Express.js"
permalink: "interactive"
'description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application API Express.js, nouvelle ou existante, en utilisant le package express-oauth2-jwt-bearer."
'og:title': "Ajouter une autorisation à votre application API Express.js"
'og:description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application API Express.js, nouvelle ou existante, en utilisant le package express-oauth2-jwt-bearer."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/node.png"
'twitter:title': "Ajouter une autorisation à votre application API Express.js"
'twitter:description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application API Express.js, nouvelle ou existante, en utilisant le package express-oauth2-jwt-bearer."
sidebarTitle: Node (Express) API
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Server from "/snippets/quickstart/backend/nodejs/server.js.mdx";
import Server2 from "/snippets/quickstart/backend/nodejs/server.js2.mdx";

export const sections = [
  { id: "définir-les-autorisations", title: "Définir les autorisations" },
  { id: "installer-les-dépendances", title: "Installer les dépendances" },
  { id: "configurer-l-intergiciel", title: "Configurer l’intergiciel" },
  { id: "protéger-les-points-de-terminaison-des-api", title: "Protéger les points de terminaison des API" }
]

<Recipe>
  <Content>
    Ce guide explique comment intégrer Auth0 à n’importe quelle application API Express.js, nouvelle ou existante, en utilisant le package `express-oauth2-jwt-bearer`.

    Si vous n’avez pas encore créé d’API dans votre Auth0 Dashboard, utilisez le sélecteur interactif pour créer une nouvelle API Auth0 ou sélectionner une API existante pour votre projet.

    Pour configurer votre première API via Auth0 Dashboard, consultez [notre guide de démarrage](https://auth0.com/docs/get-started/auth0-overview/set-up-apis). Chaque API Auth0 utilise l’identificateur API, dont votre application a besoin pour valider le jeton d’accès.

    <Info>
    **Vous ne connaissez pas Auth0?** Découvrez [Auth0](https://auth0.com/docs/overview) et [l’implémentation de l’authentification et de l’autorisation d’API](https://auth0.com/docs/api-auth) en utilisant le cadre d’applications OAuth 2.0.
    </Info>

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Les autorisations vous permettent de définir comment les ressources peuvent être accessibles au nom de l’utilisateur avec un jeton d’accès donné. Par exemple, vous pouvez choisir d’accorder un accès en lecture à la ressource `messages` si les utilisateurs ont le niveau d’accès gestionnaire et un accès en écriture à cette ressource s’ils ont le niveau d’accès administrateur.

      Vous pouvez définir les autorisations autorisées dans la vue **Permissions (Autorisations)** de la section [API](https://manage.auth0.com/#/apis) d’Auth0 Dashboard.

      <Frame>![null](/images/fr-ca/cdy7uua7fh8z/5EnGfdqLVZ8fuIxbUn7gm1/41998b8778fe7ad02b23131643b5ba95/Quickstarts_API_-_Permissions.png)</Frame>

      <Info>
      Cet exemple utilise la permission `read:messages`.
      </Info>
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      Tout d’abord, installez la trousse SDK avec `npm`.

      ```bash
      npm install --save express-oauth2-jwt-bearer
      ```
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Configurez `express-oauth2-jwt-bearer` avec votre domaine et votre identificateur API.

      L’intergiciel `checkJwt` présenté à droite vérifie si le jeton d’accès de l’utilisateur inclus dans la demande est valide. Si le jeton n’est pas valide, l’utilisateur reçoit une erreur « 401 Authorization » (Autorisation 401) lorsqu’il tente d’accéder aux points de terminaison.

      L’intergiciel ne vérifie pas si le jeton dispose d’une permission suffisante pour accéder aux ressources demandées.
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      Pour protéger une route individuelle en exigeant un JWT valide, configurez la route avec le logiciel médiateur `checkJwt` développé à partir de `express-oauth2-jwt-bearer`.

      Vous pouvez configurer des routes individuelles pour qu’elles recherchent une permission particulière. Pour ce faire, configurez un autre logiciel médiateur avec la méthode `requiresScope`. Fournissez les permissions requises et appliquez le logiciel médiateur à toutes les routes auxquelles vous souhaitez ajouter une autorisation.

      Transmettez les logiciels médiateurs `checkJwt` et `requiredScopes` à la route que vous souhaitez protéger.

      Dans cette configuration, seuls les jetons d’accès avec la permission `read:messages` peuvent accéder au point de terminaison.

      ### Faire un appel à votre API

      Pour appeler votre API, vous avez besoin d’un jeton d’accès. Vous pouvez obtenir un jeton d’accès à des fins de test dans la vue **Test** dans vos [API settings (Paramètres API)](https://manage.auth0.com/#/apis).

      <Frame>![null](/images/fr-ca/cdy7uua7fh8z/5HUMcKGXoNOvdJNXFI73oi/46c9a2dff462708e855bc1073e601f80/Tokens_-_French.png)</Frame>

      Fournir le Jeton d’accès comme un en-tête `Authorization` dans vos demandes.

      <CodeGroup>
      ```bash cURL lines
      curl --request get \
      --url 'http:///%7ByourDomain%7D/api_path' \
      --header 'authorization: Bearer YOUR_ACCESS_TOKEN_HERE'
      ```

      ```csharp C# lines
      var client = new RestClient("http:///%7ByourDomain%7D/api_path");
      var request = new RestRequest(Method.GET);
      request.AddHeader("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE");
      IRestResponse response = client.Execute(request);
      ```

      ```go Go lines
      package main
      import (
      "fmt"
      "net/http"
      "io/ioutil"
      )
      func main() {
      url := "http:///%7ByourDomain%7D/api_path"
      req, _ := http.NewRequest("get", url, nil)
      req.Header.Add("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE")
      res, _ := http.DefaultClient.Do(req)
      defer res.Body.Close()
      body, _ := ioutil.ReadAll(res.Body)
      fmt.Println(res)
      fmt.Println(string(body))
      }
      ```

      ```java Java lines
      HttpResponse<String> response = Unirest.get("http:///%7ByourDomain%7D/api_path")
      .header("authorization", "Bearer YOUR_ACCESS_TOKEN_HERE")
      .asString();
      ```

      ```javascript Node.JS lines
      var axios = require("axios").default;
      var options = {
      method: 'get',
      url: 'http:///%7ByourDomain%7D/api_path',
      headers: {authorization: 'Bearer YOUR_ACCESS_TOKEN_HERE'}
      };
      axios.request(options).then(function (response) {
      console.log(response.data);
      }).catch(function (error) {
      console.error(error);
      });
      ```

      ```obj-c Obj-C lines
      #import <Foundation/Foundation.h>
      NSDictionary *headers = @{ @"authorization": @"Bearer YOUR_ACCESS_TOKEN_HERE" };
      NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http:///%7ByourDomain%7D/api_path"]
                                                      cachePolicy:NSURLRequestUseProtocolCachePolicy

                                                  timeoutInterval:10.0];

      [request setHTTPMethod:@"get"];
      [request setAllHTTPHeaderFields:headers];
      NSURLSession *session = [NSURLSession sharedSession];
      NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request
                                              completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {

                                                  if (error) {

                                                      NSLog(@&quot;%@&quot;, error);

                                                  } else {

                                                      NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

                                                      NSLog(@&quot;%@&quot;, httpResponse);

                                                  }

                                              }];

      [dataTask resume];
      ```

      ```php PHP lines
      #import <Foundation/Foundation.h>
      NSDictionary *headers = @{ @"authorization": @"Bearer YOUR_ACCESS_TOKEN_HERE" };
      NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http:///%7ByourDomain%7D/api_path"]
                                                      cachePolicy:NSURLRequestUseProtocolCachePolicy

                                                  timeoutInterval:10.0];

      [request setHTTPMethod:@"get"];
      [request setAllHTTPHeaderFields:headers];
      NSURLSession *session = [NSURLSession sharedSession];
      NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request
                                              completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {

                                                  if (error) {

                                                      NSLog(@&quot;%@&quot;, error);

                                                  } else {

                                                      NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

                                                      NSLog(@&quot;%@&quot;, httpResponse);

                                                  }

                                              }];

      [dataTask resume];
      ```

      ```python Python lines
      import http.client
      conn = http.client.HTTPConnection("")
      headers = { 'authorization': "Bearer YOUR_ACCESS_TOKEN_HERE" }
      conn.request("get", "/%7ByourDomain%7D/api_path", headers=headers)
      res = conn.getresponse()
      data = res.read()
      print(data.decode("utf-8"))
      ```

      ```ruby Ruby lines
      require 'uri'
      require 'net/http'
      url = URI("http:///%7ByourDomain%7D/api_path")
      http = Net::HTTP.new(url.host, url.port)
      request = Net::HTTP::Get.new(url)
      request["authorization"] = 'Bearer YOUR_ACCESS_TOKEN_HERE'
      response = http.request(request)
      puts response.read_body
      ```

      ```swift Swift lines
      import Foundation
      let headers = ["authorization": "Bearer YOUR_ACCESS_TOKEN_HERE"]
      let request = NSMutableURLRequest(url: NSURL(string: "http:///%7ByourDomain%7D/api_path")! as URL,
                                          cachePolicy: .useProtocolCachePolicy,

                                      timeoutInterval: 10.0)

      request.httpMethod = "get"
      request.allHTTPHeaderFields = headers
      let session = URLSession.shared
      let dataTask = session.dataTask(with: request as URLRequest, completionHandler: { (data, response, error) -> Void in
      if (error != nil) {
      print(error)

      } else {
      let httpResponse = response as? HTTPURLResponse

      print(httpResponse)

      }
      })
      dataTask.resume()
      ```
      </CodeGroup>


      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré votre application, exécutez-la pour vérifier que :
      `GET /api/public` est disponible pour les demandes non authentifiées.
      `GET /api/private` est disponible pour les demandes authentifiées.
      `GET /api/private-scoped` est disponible pour les demandes authentifiées contenant un jeton d’accès avec la permission `read:messages`.
      </Note>
      </Section>

    ## Étapes suivantes

    Beau travail! Si vous en êtes arrivé là, vous devriez avoir la connexion, la déconnexion et les informations de profil utilisateur actives dans votre application.

    Cela conclut notre tutoriel de démarrage rapide, mais il y a tellement plus à explorer. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    *   [Auth0 Dashboard](https://manage.auth0.com/#) : apprenez à configurer et gérer votre locataire et vos applications Auth0
    *   [Trousse SDK express-oauth2-jwt-bearer](https://github.com/auth0/node-oauth2-jwt-bearer/tree/main/packages/express-oauth2-jwt-bearer) : explorez en détail la trousse SDK utilisée dans ce tutoriel
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) : découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <Server />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <Server2 />
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
