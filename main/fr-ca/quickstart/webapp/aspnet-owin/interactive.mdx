---
title: "Ajouter une fonctionnalité de connexion à votre application ASP.NET OWIN"
permalink: "interactive"
'description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application ASP.NET OWIN, nouvelle ou ancienne, à l’aide du package NuGet Microsoft.Owin.Security.OpenIdConnect."
'og:title': "Ajouter une fonctionnalité de connexion à votre application ASP.NET OWIN"
'og:description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application ASP.NET OWIN, nouvelle ou ancienne, à l’aide du package NuGet Microsoft.Owin.Security.OpenIdConnect."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/asp.png"
'twitter:title': "Ajouter une fonctionnalité de connexion à votre application ASP.NET OWIN"
'twitter:description': "Ce guide explique comment intégrer Auth0 à n’importe quelle application ASP.NET OWIN, nouvelle ou ancienne, à l’aide du package NuGet Microsoft.Owin.Security.OpenIdConnect."
sidebarTitle: ASP.NET OWIN
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx"
import WebConfig from "/snippets/quickstart/webapp/aspnet-owin/web-config.mdx"
import AccountController1 from "/snippets/quickstart/webapp/aspnet-owin/AccountController1.mdx"
import AccountController2 from "/snippets/quickstart/webapp/aspnet-owin/AccountController2.mdx"
import AccountController3 from "/snippets/quickstart/webapp/aspnet-owin/AccountController3.mdx"

export const sections = [
  { id: "configuration-d-auth0", title: "Configuration d’Auth0" },
  { id: "configurer-le-projet", title: "Configurer le projet" },
  { id: "configurer-le-logiciel-médiateur", title: "Configurer le logiciel médiateur" },
  { id: "ajouter-une-fonctionnalité-de-connexion-à-votre-application", title: "Ajouter une fonctionnalité de connexion à votre application" },
  { id: "ajouter-une-fonctionnalité-de-déconnexion-à-votre-application", title: "Ajouter une fonctionnalité de déconnexion à votre application" },
  { id: "afficher-les-informations-du-profil-utilisateur", title: "Afficher les informations du profil utilisateur" }
]

<Recipe>
  <Content>
    Auth0 vous permet d’ajouter rapidement l’authentification et de pouvoir accéder aux informations relatives au profil utilisateur dans votre application. Ce guide explique comment intégrer Auth0 à n’importe quelle application ASP.NET OWIN, nouvelle ou ancienne, en utilisant le package Nuget `Microsoft.Owin.Security.OpenIdConnect`.

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Pour utiliser les services Auth0, vous devez avoir une application installée dans Auth0 Dashboard. L’application Auth0 est l’endroit où vous allez configurer le fonctionnement de l’authentification pour le projet que vous développez.

      ### Configurer une application

      Utilisez le sélecteur interactif pour créer une nouvelle application Auth0 ou sélectionner une application existante qui représente le projet avec lequel vous souhaitez effectuer l’intégration. Dans Auth0, il est attribué à chaque application un identifiant client unique alphanumérique que votre code d’application utilisera pour appeler les API Auth0 via la trousse SDK.

      Tous les paramètres que vous configurez à l’aide de ce démarrage rapide seront automatiquement mis à jour pour votre application dans le [Dashboard](https://manage.auth0.com/#/), qui est l’endroit où vous pourrez gérer vos Applications à l’avenir.

      Si vous préférez explorer une configuration complète, consultez plutôt un exemple d’application.

      ### Configuration des URL de rappel

      Une URL de rappel est une URL intégrée dans votre application vers laquelle vous souhaitez qu’Auth0 redirige les utilisateurs après leur authentification. Si elle n’est pas définie, les utilisateurs ne seront pas redirigés vers votre application après s’être connectés.

      <Info>
      Si vous suivez notre exemple de projet, définissez cette URL comme suit : `http://localhost:3000``/callback`.
      </Info>

      ### Configuration des URL de déconnexion

      Une URL de déconnexion est une URL intégrée dans votre application vers laquelle vous souhaitez qu’Auth0 redirige les utilisateurs après leur déconnexion. Si elle n’est pas définie, les utilisateurs ne pourront pas se déconnecter de votre application et recevront un message d’erreur.

      <Info>
      Si vous suivez notre exemple de projet, définissez cette URL comme suit : `http://localhost:3000`.
      </Info>
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      ### Installer à partir de Nuget

      Pour intégrer Auth0 avec ASP.NET OWIN, vous pouvez utiliser les packages Nuget `Microsoft.Owin.Security.OpenIdConnect` et `Microsoft.Owin.Security.Cookies`.

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      <Info>
      Des problèmes surviennent lorsque vous configurez l’intergiciel de témoin OWIN et les témoins System.Web en même temps. Pour en savoir plus, consultez [la documentation sur les problèmes d’intégration des témoins System.Web](https://github.com/aspnet/AspNetKatana/wiki/System.Web-response-cookie-integration-issues) afin d’atténuer ces problèmes.
      </Info>

      ### Configurer les identifiants

      Pour que la trousse SDK fonctionne correctement, définissez les propriétés suivantes dans `Web.config` :

      - `auth0:Domain` : Le domaine de votre locataire Auth0. Celui-ci figure dans Auth0 Dashboard, dans les **Settings (Paramètres)** de votre application dans le champ Domaine. Si vous utilisez un [domaine personnalisé](https://auth0.com/docs/custom-domains), définissez ceci plutôt sur la valeur de votre domaine personnalisé.
      - `auth0:ClientId` : L’identifiant de l’application Auth0 que vous avez créée dans Auth0 Dashboard. Celui-ci figure dans Auth0 Dashboard, dans les **Settings (Paramètres)** de votre application dans le champ Identifiant client.
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Pour activer l’authentification dans votre application ASP.NET OWIN, reportez-vous à la méthode de configuration de votre classe de démarrage et configurez le témoin, ainsi que le logiciel médiateur OIDC.

      Il est essentiel d’enregistrer à la fois le logiciel médiateur de témoin et le logiciel médiateur OpenID Connect, car les deux sont nécessaires (dans cet ordre) pour que l’authentification fonctionne. le logiciel médiateur OpenID Connect gère l’authentification avec Auth0. Une fois que les utilisateurs se sont authentifiés, leur identité est sauvegardée dans le logiciel médiateur de témoin.

      Dans l’extrait de code, AuthenticationType est défini sur **Auth0**. Utilisez AuthenticationType dans la section suivante pour lancer un défi au logiciel médiateur OpenID Connect et commencer le flux d’authentification. L’événement de notification RedirectToIdentityProvider génère la bonne Logout URL (URL de déconnexion).
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      Pour permettre aux utilisateurs de se connecter à votre application ASP.NET OWIN, ajoutez une action `Login`à votre contrôleur.

      Appelez `HttpContext.GetOwinContext().Authentication.Challenge` et passez `Auth0` comme schéma d’authentification. Cette action fait appel au gestionnaire d’authentification OIDC qui a été enregistré plus tôt. Veillez à préciser les `AuthenticationProperties`, y compris un `RedirectUri`i.

      Après avoir appelé avec succès `HttpContext.GetOwinContext().Authentication.Challenge`, l’utilisateur est redirigé vers Auth0 et est connecté à la fois au logiciel médiateur OIDC et au logiciel médiateur de témoin après avoir été redirigé vers votre application. Cela permettra aux utilisateurs d’être authentifiés lors des requêtes suivantes.

      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré la fonction de connexion, lancez votre application pour vérifier que:
      naviguer vers votre action `Login` vous redirigera vers Auth0,
      saisir vos identifiants vous redirigera vers votre application.
      </Note>
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      À partir de l’action de votre contrôleur, appelez `HttpContext.GetOwinContext().Authentication.SignOut` avec le schéma d’authentification `CookieAuthenticationDefaults.AuthenticationType` pour déconnecter l’utilisateur de votre application.

      De plus, si vous souhaitez déconnecter l’utilisateur d’Auth0 (cette action pourrait également le déconnecter d’autres applications qui dépendent de l’authentification unique), appelez `HttpContext.GetOwinContext().Authentication.SignOut` avec le schéma d’authentification `"Auth0"`.

      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré la fonction de déconnexion, exécutez votre application pour vérifier que:
      Naviguer vers votre action `Logout` garantit que l’utilisateur est déconnecté.
      Lors de la déconnexion, vous êtes redirigé vers Auth0 puis immédiatement renvoyé vers votre application pendant la déconnexion.
      </Note>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      Après que l’intergiciel a réussi à récupérer les jetons d’Auth0, il extraira les informations et les demandes de l’utilisateur à partir du jeton d’ID et les met à disposition en tant que `ClaimsIdentity`. Accédez aux informations extraites en utilisant la propriété `User` dans le contrôleur.

      Pour créer un profil utilisateur, récupérez le nom, l’adresse courriel et l’image de profil de l’utilisateur à partir de `User` et visualisez-les à partir de votre contrôleur.

      <Note>
      ##### Point de contrôle
      Maintenant que vous avez configuré votre action pour afficher le profil de l’utilisateur, lancez votre application pour vérifier que:
      naviguer vers votre action `Profile` après vous être connecté avec succès affiche le profil de l’utilisateur.
      </Note>
      </Section>

    ## Étapes suivantes

    Beau travail! Si vous en êtes arrivé là, vous devriez avoir la connexion, la déconnexion et les informations de profil utilisateur actives dans votre application.

    Cela conclut notre tutoriel de démarrage rapide, mais il y a tellement plus à explorer. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    *   [Auth0 Dashboard](https://manage.auth0.com/#) : apprenez à configurer et gérer votre locataire et vos applications Auth0
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) : découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <CodeGroup>
          <WebConfig/>
          <AccountController1/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <CodeGroup>
          <WebConfig/>
          <AccountController1/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <CodeGroup>
          <AccountController1/>
          <WebConfig/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <CodeGroup>
          <AccountController2/>
          <WebConfig/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <CodeGroup>
          <AccountController3/>
          <WebConfig/>
        </CodeGroup>
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
