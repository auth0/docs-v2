---
title: "Ajouter une connexion à votre application web Java EE"
permalink: "interactive"
'description': "Ce tutoriel montre comment ajouter une connexion utilisateur à une application web Java EE."
'og:title': "Ajouter une connexion à votre application web Java EE"
'og:description': "Ce tutoriel montre comment ajouter une connexion utilisateur à une application web Java EE."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/java.png"
'twitter:title': "Ajouter une connexion à votre application web Java EE"
'twitter:description': "Ce tutoriel montre comment ajouter une connexion utilisateur à une application web Java EE."
sidebarTitle: Java EE
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import Web from "/snippets/quickstart/webapp/java-ee/web.xml.mdx";
import Auth0authenticationconfig from "/snippets/quickstart/webapp/java-ee/Auth0AuthenticationConfig.java.mdx";
import Loginservlet from "/snippets/quickstart/webapp/java-ee/LoginServlet.java.mdx";
import Homeservlet from "/snippets/quickstart/webapp/java-ee/HomeServlet.java.mdx";
import Logoutservlet from "/snippets/quickstart/webapp/java-ee/LogoutServlet.java.mdx";

export const sections = [
  { id: "configuration-requise", title: "Configuration requise" },
  { id: "configuration-d-auth0", title: "Configuration d’Auth0" },
  { id: "configurer-java-ee-pour-utiliser-auth0", title: "Configurer Java EE pour utiliser Auth0" },
  { id: "configurer-la-sécurité-java-ee", title: "Configurer la sécurité Java EE" },
  { id: "déclencher-l-authentification", title: "Déclencher l’authentification" },
  { id: "afficher-les-informations-de-l-utilisateur", title: "Afficher les informations de l’utilisateur" },
  { id: "gérer-la-déconnexion", title: "Gérer la déconnexion" },
  { id: "exécuter-l-exemple", title: "Exécuter l’exemple" }
]

<Recipe>
  <Content>
    Ce tutoriel montre comment ajouter une connexion utilisateur à une application web Java EE. Nous vous recommandons de vous connecter pour suivre ce démarrage rapide avec les exemples configurés pour votre compte.

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Ce tutoriel et le projet d’exemple ont été testés avec les éléments suivants :

      - Java 11
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      ### Obtenez vos clés d’application

      Après votre inscription à Auth0, une nouvelle application a été créée pour vous, ou vous avez pu en créer une. Vous aurez besoin de quelques informations sur cette application pour communiquer avec Auth0. Vous pouvez obtenir ces détails dans la section [Paramètres de l’application](https://manage.auth0.com/#/applications) d’Auth0 Dashboard.

      <Frame>![](/images/fr-ca/cdy7uua7fh8z/1NtemqhRTHLFgWkGyAVSC6/ae66506a56ffab891e8a36e1344e6376/uwp.png)</Frame>

      Les informations suivantes sont nécessaires :

      - **Domain (Domaine)**
      - **Client ID (Identifiant client)**
      - **Client Secret (Secret client)**

      <Info>
      En téléchargeant l’exemple en haut de cette page, les détails vous seront automatiquement fournis.
      </Info>

      ### Configurer les URL de rappel

      Une URL de rappel est une URL dans votre application où Auth0 redirige l’utilisateur après qu’il se soit authentifié. La callbackc URL de votre application doit être ajoutée au champ **URL de rappel autorisées** dansples [Paramètres de l’application](https://manage.auth0.com/#/applications). Si ce champ n’est pas défini, les utilisateurs ne pourront pas se connecter à l’application et obtiendront un message d’erreur.

      <Info>
      Si vous suivez l’exemple de projet que vous avez téléchargé à partir du haut de cette page, l’URL de rappel que vous devez ajouter au champ **URL de rappel autorisées** est `http://localhost:3000/callback`.
      </Info>

      ### Configuration des URL de déconnexion

      Une URL de déconnexion est une URL de votre application à laquelle Auth0 peut retourner après la déconnexion de l’utilisateur du serveur d’autorisation. Elle est indiquée dans le paramètre de requête `returnTo`. L’URL de déconnexion de votre application doit être ajoutée au champ **URL de déconnexion autorisées** dans les [paramètres de l’application](https://manage.auth0.com/#/applications). Si ce champ n’est pas défini, les utilisateurs ne pourront pas se déconnecter de l’application et obtiendront un message d’erreur.

      <Info>
      Si vous suivez l’exemple de projet que vous avez téléchargé à partir du haut de cette page, l’URL de déconnexion que vous devez ajouter au champ **URL de déconnexion autorisées** est `http://localhost:3000/`.
      </Info>
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      ### Configurez les dépendances

      Pour intégrer votre application Java EE avec Auth0, ajoutez les dépendances suivantes :

      - **javax.javaee-api** : L’API Java EE 8 est nécessaire pour écrire des applications à l’aide de Java EE 8. L’implémentation réelle est fournie par le conteneur d’application : elle n’a donc pas besoin d’être incluse dans le fichier WAR.
      - **javax.security.entreprise** : L’API de sécurité Java EE 8 permet de gérer les problèmes de sécurité dans une application EE. Comme la dépendance `javax.javaee-api`, l’implémentation est fournie par le conteneur d’application : elle n’est donc pas incluse dans le fichier WAR.
      - **auth0-java-mvc-commons** : Le [Kit de développement logiciel (SDK) Java MVC Auth0](https://github.com/auth0/auth0-java-mvc-common) vous permet d’utiliser Auth0 avec Java pour les applications Web MVC côté serveur. Il génère l’URL d’autorisation que votre application doit appeler pour authentifier un utilisateur à l’aide d’Auth0.

      Si vous utilisez Maven, ajoutez les dépendances à votre `pom.xml` :

      <AuthCodeBlock icon="file-code" language="html">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Si vous utilisez Gradle, ajoutez-les à votre `build.gradle` :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      ### Configurez votre application Java EE

      <Info>
      L’exemple qui accompagne ce tutoriel est écrit en JSP et testé avec le serveur d’application [WildFly](https://wildfly.org/). Il se peut que vous deviez adapter certaines des étapes si vous travaillez avec un conteneur d’application ou des technologies différents.
      </Info>

      Votre application Java EE a besoin de certaines informations pour authentifier les utilisateurs avec votre application Auth0. Le fichier descripteur de déploiement `web.xml`  peut être utilisé pour stocker ces informations, bien que vous puissiez les stocker dans un autre emplacement sécurisé.

      Ces informations seront utilisées pour configurer la bibliothèque **auth0-java-mvc-commons** afin de permettre aux utilisateurs de se connecter à votre application. Pour en savoir plus sur la bibliothèque, y compris ses différentes options de configuration, consultez le fichier [README](https://github.com/auth0/auth0-java-mvc-common/blob/master/README.md) de la bibliothèque.

      | **Vérifier les attributs remplis** |
      | --- |
      | Si vous avez téléchargé cet exemple en utilisant le bouton **Download Sample**, les attributs `domain`, `clientId` et `clientSecret` seront remplis pour vous. Vous devez vérifier que les valeurs sont correctes, surtout si vous avez plusieurs applications Auth0 dans votre compte. |
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      L’API de Java EE 8 Security a introduit l’interface `HttpAuthenticationMechanism` pour permettre aux applications d’obtenir les identifiants d’un utilisateur. Des implémentations par défaut existent pour l’authentification de base et l’authentification basée sur le formulaire, et il est facile de configurer une stratégie d’authentification personnalisée.

      Pour s’authentifier avec Auth0, il faut fournir des implémentations personnalisées des interfaces suivantes :

      - HttpAuthenticationMechanism : responsable de la gestion du flux d’authentification pour les utilisateurs qui reviennent d’Auth0. ([JavaDoc](https://javaee.github.io/javaee-spec/javadocs/javax/security/enterprise/authentication/mechanism/http/HttpAuthenticationMechanism.html)).
      - IdentityStore : responsable de la validation des identifiants de l’utilisateur ([JavaDoc](https://javaee.github.io/javaee-spec/javadocs/javax/security/enterprise/identitystore/IdentityStore.html)).
      - CallerPrincipal : représente le principal de l’appelant de la requête HTTP en cours ([JavaDoc](https://javaee.github.io/javaee-spec/javadocs/javax/security/enterprise/CallerPrincipal.html)).
      - Credential : représente l’identifiant que l’appelant utilisera pour s’authentifier ([JavaDoc](https://javaee.github.io/javaee-spec/javadocs/javax/security/enterprise/credential/Credential.html)).

      Tout d’abord, mettez vos paramètres Auth0 à la disposition de l’application en créant un bean @ApplicationScoped pour récupérer les valeurs du contexte Web et les rendre disponibles via des getters (accesseurs).

      Ensuite, créez un `CallerPrincipal` personnalisé qui représente l’appelant de la requête en cours :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Vous pouvez maintenant mettre en œuvre un `Credential` personnalisé qui sera utilisé pour représenter les identifiants de l’utilisateur. Il contiendra des informations sur le principal :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Vous avez maintenant défini les classes qui représentent le principal et l’identifiant d’un appelant. Ensuite, créez une implémentation personnalisée de `IdentityStore`. Cette classe sera chargée de valider les identifiants de l’utilisateur :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Si le `credential` est un `Auth0Credential`, l’utilisateur appelant est authentifié et valide, et un `CredentialValidationResult` créé avec le credential est renvoyé pour indiquer le succès. S’il ne s’agit pas d’un `Auth0Credential`, un `CredentialValidationResult.NOT_VALIDATED_RESULT` est renvoyé.

      Avant d’implémenter l’interface `HttpAuthenticationMechanism` qui utilisera tous ces collaborateurs, créez un bean qui fournira une instance configurée du `AuthenticationController` de la trousse SDK Auth0 Java MVC. Le `AuthenticationController` est utilisé pour construire l’URL d’autorisation où les utilisateurs se connecteront, et gérer l’échange de jetons pour authentifier les utilisateurs.

      - Si votre application Auth0 est configurée pour utiliser l’algorithme de signature **RS256**  (par défaut lors de la création d’une nouvelle application Auth0), vous devez configurer un `JwkProvider` pour récupérer la clé publique utilisée pour vérifier la signature du jeton. Voir le référentiel [jwks-rsa-java](https://github.com/auth0/jwks-rsa-java) pour connaître les options de configuration supplémentaires.
      - Si votre application Auth0 est configurée pour utiliser l’algorithme de signature **HS256**, il n’est pas nécessaire de configurer le `JwkProvider`.

      <Info>
      Pour en savoir plus sur les algorithmes de signature disponibles, consultez la [documentation](https://auth0.com/docs/tokens/concepts/signing-algorithms).
      </Info>

      L’exemple ci-dessous montre comment configurer le `AuthenticationController` pour l’utiliser avec l’algorithme de signature **RS256** :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Enfin, mettez en œuvre un `HttpAuthenticationMechanism` personnalisé

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      La classe a priorité sur la méthode `validateRequest`, qui est appelée à chaque demande adressée à notre application et qui est chargée de notifier au conteneur l’état de l’authentification.

      Cet exemple utilise le [flux de code d’autorisation](https://auth0.com/docs/flows/concepts/auth-code) pour échanger un code d’autorisation contre un jeton au cours du processus d’authentification. Si cette requête est adressée au point de terminaison `/callback` et contient le paramètre de requête `code`, elle effectue quelques opérations importantes :

      - Elle appelle la méthode `handle` du `AuthenticationController` pour échanger le code d’autorisation contre un jeton d’ID et un jeton d’accès.
      - Elle utilise le jeton d’ID pour créer un nouveau `Auth0Credential`.
      - Elle appelle la méthode `validate` de l’implémentation personnalisée `IdentityStore` pour obtenir le résultat de la validation.
      - Elle informe le conteneur de l’application de l’état de la connexion.

      Si la ressource demandée n’est pas `/callback`, elle renvoie `httpMessageContext.doNothing()` pour permettre la poursuite du traitement de la demande. Vous verrez bientôt comment utiliser les informations d’authentification lors du déclenchement de l’authentification et de l’affichage des vues Web.

      Enfin, notez que l’annotation `@AutoApplySession` a été ajoutée pour permettre au conteneur de créer une session pour l’utilisateur authentifié.
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      Pour permettre à un utilisateur de se connecter, créez un Servlet qui traitera les requêtes au chemin `/login`.

      Le `LoginController` est responsable de rediriger la requête vers l’URL d’autorisation appropriée, où l’utilisateur peut s’authentifier avec Auth0. Il utilise le `AuthenticationController` du SDK Auth0 Java MVC pour construire le bon URL d’autorisation, en utilisant les valeurs de configuration injectées via `Auth0AuthenticationConfig`. Par défaut, cet exemple demande les permissions `"openid profile email"` pour permettre à l’application de récupérer les informations de profil de base auprès de l’utilisateur authentifié. Vous pouvez en savoir plus sur ces permissions dans la documentation [OpenID Connect Scopes](https://auth0.com/docs/scopes/current/oidc-scopes).

      Une fois que l’utilisateur a entré ses identifiants et autorisé les permissions demandées, Auth0 enverra une requête au `callbackUrl`, incluant un paramètre de requête `code` qui peut être échangé contre un jeton d’ID et un jeton d’accès. Rappelons que le `Auth0HttpAuthenticationMechanism` créé ci-dessus gère cet échange afin qu’il puisse notifier le conteneur d’applications du statut d’authentification. Cela permet au Servlet qui gère les requêtes vers le chemin `/callback` de simplement transférer la requête à la ressource initialement demandée avant de se connecter, ou simplement de rediriger vers la page d’accueil :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      Vous pouvez utiliser `Auth0JwtPrincipal` pour obtenir des informations sur le profil de l’utilisateur authentifié. L’exemple de code `HomeServlet.java` montre comment utiliser les demandes sur le [Jeton d’ID](https://auth0.com/docs/tokens/id-token) pour définir les données de profil comme attribut de requête.

      Vous pouvez ensuite utiliser ces informations de profil dans votre vue pour afficher des informations sur l’utilisateur :

      <AuthCodeBlock icon="file-code" language="html">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>
      </Section>

      <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      Pour déconnecter un utilisateur, vous devez effacer la session d’application et déconnecter l’utilisateur d’Auth0. Cette opération est gérée dans le `LogoutServlet`.

      Commencez par effacer la session en appelant `request.getSession().invalidate()`. Créez ensuite l’URL de déconnexion, en veillant à inclure le paramètre de requête `returnTo`, vers lequel l’utilisateur sera redirigé après la déconnexion. Enfin, redirigez la réponse vers l’URL de déconnexion de l’application.
      </Section>

      <Section id={sections[7].id} title={sections[7].title} stepNumber="8">
      Pour construire et exécuter l’exemple, exécutez l’objectif Maven wildfly:run pour démarrer un serveur d’application WildFly intégré avec cette application déployée. Voir la documentation [Plugiciel WildFly Maven](https://docs.jboss.org/wildfly/plugins/maven/latest/) pour plus d’informations.

      Si vous utilisez Linux ou MacOS :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Windows :

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      Pointez votre navigateur sur `http:``//localhost:3000.` Suivez le lien **Log In (Connexion)** pour vous connecter ou vous inscrire à votre locataire Auth0.

      <Frame>![null](/images/fr-ca/cdy7uua7fh8z/5Lp4Zahxd2v6wSJmy9JaM4/2fc68529fe5299c1fc514e3f28a8c998/Login_Screen_-_French.png)</Frame>

      Une fois la connexion réussie, vous verrez l’image du profil de l’utilisateur et un menu déroulant à l’endroit où se trouvait le lien Log In (Connexion). Vous pouvez alors consulter la page de profil de l’utilisateur en cliquant sur le lien **Profile (Profil)**. Vous pouvez vous déconnecter en cliquant sur le lien **Logout (Déconnexion)** dans le menu déroulant.
      </Section>

    ## Étapes suivantes

    Beau travail! Si vous en êtes arrivé là, vous devriez avoir la connexion, la déconnexion et les informations de profil utilisateur actives dans votre application.

    Cela conclut notre tutoriel de démarrage rapide, mais il y a tellement plus à explorer. Pour en savoir plus sur ce que vous pouvez faire avec Auth0, consultez :

    *   [Auth0 Dashboard](https://manage.auth0.com/#) : apprenez à configurer et gérer votre locataire et vos applications Auth0
    *   [Trousse SDK auth0-java-mvc-common](https://github.com/auth0/auth0-java-mvc-common) : explorez en détail la trousse SDK utilisée dans ce tutoriel
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) : découvrez des intégrations que vous pouvez activer pour étendre les fonctionnalités d’Auth0
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <CodeGroup>
          <Web/>
          <Auth0authenticationconfig/>
          <Loginservlet/>
          <Homeservlet/>
          <Logoutservlet/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <CodeGroup>
          <Auth0authenticationconfig/>
          <Web/>
          <Loginservlet/>
          <Homeservlet/>
          <Logoutservlet/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <CodeGroup>
          <Loginservlet/>
          <Web/>
          <Auth0authenticationconfig/>
          <Homeservlet/>
          <Logoutservlet/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <CodeGroup>
          <Homeservlet/>
          <Web/>
          <Auth0authenticationconfig/>
          <Loginservlet/>
          <Logoutservlet/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[6].id}>
        <CodeGroup>
          <Logoutservlet/>
          <Web/>
          <Auth0authenticationconfig/>
          <Loginservlet/>
          <Homeservlet/>
        </CodeGroup>
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[7].id}>
        <SignUpForm lang="fr"/>
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
