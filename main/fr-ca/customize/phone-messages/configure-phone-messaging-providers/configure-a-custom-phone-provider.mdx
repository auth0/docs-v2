---
title: "Configurer un fournisseur de services téléphoniques personnalisés"
permalink: "configure-a-custom-phone-provider"
'description': "Apprendre à configurer un fournisseur de services téléphoniques personnalisés à l’aide des Actions"
'og:title': "Configurer un fournisseur de services téléphoniques personnalisés"
'og:description': "Apprendre à configurer un fournisseur de services téléphoniques personnalisés à l’aide des Actions"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Configurer un fournisseur de services téléphoniques personnalisés"
'twitter:description': "Apprendre à configurer un fournisseur de services téléphoniques personnalisés à l’aide des Actions"
---

Vous pouvez configurer un fournisseur de services téléphoniques personnalisés pour les SMS lorsque vous utilisez un [numéro de téléphone comme identifiant d’utilisateur](/docs/fr-ca/authenticate/database-connections/activate-and-configure-attributes-for-flexible-identifiers). Un fournisseur de services téléphoniques personnalisés utilise des [Actions](/docs/fr-ca/customize/actions/actions-overview) pour acheminer les SMS vers un fournisseur de téléphone de votre choix lors de la vérification des numéros de téléphone et de la réinitialisation des mots de passe.

Vous pourriez vouloir configurer un fournisseur de téléphonie personnalisé pour les cas d’utilisation suivants :

* L’utilisation de différents fournisseurs de services téléphoniques en fonction du contexte de l’application, qui peut inclure différentes régions géographiques où le prix des messages des fournisseurs de services téléphoniques peut varier de manière significative.
* Utilisez différents fournisseurs de services téléphoniques en fonction du contexte de l’organisation, où certains clients C3E peuvent avoir besoin de fournisseurs particuliers.

Vous pouvez configurer un fournisseur de services téléphoniques personnalisé à l’aide d’Auth0 Dashboard ou de Management API.

## Configurer un fournisseur de services téléphoniques personnalisé à l’aide du Auth0 Dashboard ou de Management API.

Pour configurer un fournisseur de téléphone personnalisé, vous devez utiliser le déclencheur d’action du `custom-phone-provider` qui n’est pas disponible dans l’éditeur d’Auth0 Actions. Pour en savoir plus, lisez [Exemple d’Action de custom-phone-provider](#example-custom-phone-provider-action).

<Tabs><Tab title="Auth0 Dashboard">

#### Configurer un nouveau fournisseur de téléphonie personnalisé à l’aide d’Auth0 Dashboard

Pour configurer un nouveau fournisseur de téléphonie personnalisé dans Auth0 Dashboard :

1. Accéder à [Branding (Marque) > Phone Provider (Opérateur de téléphonie)](https://manage.auth0.com/dashboard/#/phone/templates/phone/provider). Cela vous amène à la page Phone Message Provider (Fournisseur de messagerie téléphonique). Par défaut, le fournisseur de téléphonie Twilio est sélectionné.
2. Sélectionnez l’option de fournisseur de téléphone **Custom (Personnalisé)** dans la section Phone Provider (Fournisseur de téléphonie).
3. Sélectionnez une **Delivery Method (Méthode de livraison) :**

   1. Text (Texte) : Le code de vérification sera envoyé à vos utilisateurs par SMS.
   2. Voice (Voix) : Le code de vérification sera transmis à vos utilisateurs par message vocal.
4. Sous **Provider Configuration (Configuration du fournisseur)**, annoter votre code d’Actions pour configurer un fournisseur de téléphonie personnalisé :

   1. Veuillez consulter la documentation de votre fournisseur pour savoir comment envoyer des messages à son API.
   2. Ajoutez les secrets nécessaires à l’authentification à l’aide de l’API.
   3. (Facultatif) Vous pouvez modifier l’Action à l’aide de l’interface complète de l’éditeur d’actions en cliquant sur le bouton **Edit in Expanded Editor (Modifier dans l’éditeur étendu)**. Après avoir modifié votre Action dans l’éditeur d’Actions, cliquez sur **Save (Enregistrer)** et **Deploy (Déployer)** l’Action à partir de cette interface. Cliquez sur le lien **Back to Phone Provider (Retour au fournisseur de téléphonie)** en haut de la page de l’éditeur d’Actions pour revenir à la page du fournisseur de messages téléphoniques. Vous devrez de nouveau sélectionner l’option **Custom (Personnalisé)** du fournisseur de téléphonie dans la section Phone Provider (Fournisseur de téléphonie).
5. Cliquez sur le bouton **Save (Enregistrer)**  en bas de la page.

Lorsque vous cliquez sur **Save (Enregistrer)**, l’Action est automatiquement enregistrée et déployée. Pour tester la configuration personnalisée du fournisseur de téléphonie avant de l’utiliser dans un environnement de production, cliquez sur **Send Test Message (Envoyer un message de test)**.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Vous ne pouvez pas cliquer sur **Send Test Message (Envoyer un message de test)** pour tester votre fournisseur de services téléphoniques personnalisé tant que vous n’avez pas enregistré la configuration de ce fournisseur.

</Callout>

Vous pouvez configurer un fournisseur de courrier électronique personnalisé à l’aide de Auth0 Dashboard.

#### Mettre à jour un fournisseur de téléphonie personnalisé à l’aide d’Auth0 Dashboard

Pour mettre à jour un fournisseur de téléphonie personnalisé existant dans Auth0 Dashboard  :

1. Accédez à [Branding (Marque) > Phone Provider (Fournisseur de téléphonie)](https://manage.auth0.com/dashboard/#/phone/templates/phone/provider). Cela vous amènera à la page Phone Message Provider (Fournisseur de messagerie téléphonique).
2. Modifiez le code d’Action sur la page du fournisseur de messages téléphoniques selon vos besoins.

   1. (Facultatif) Vous pouvez modifier l’Action à l’aide de l’interface complète de l’éditeur d’Actions en cliquant sur le bouton **Edit in Expanded Editor (Modifier dans l’éditeur développé)**. Après avoir modifié votre action dans l’éditeur d’actions, cliquez sur **Save (Enregistrer)** et **Deploy (Déployer)** l’Action à partir de cette interface. Cliquez ensuite sur le lien **Back to Phone Provider (Retour au fournisseur de téléphonie)** en haut de la page de l’éditeur d’Actions.
3. Cliquez sur le bouton **Save (Enregistrer)**  en bas de la page.

Lorsque vous cliquez sur **Save (Enregistrer)**, l’Action est automatiquement enregistrée et déployée. Pour tester la configuration personnalisée du fournisseur de téléphonie avant de l’utiliser dans un environnement de production, cliquez sur **Send Test Message (Envoyer un message de test)**.

</Tab><Tab title="Management API">

#### Configurer un nouveau fournisseur de téléphone personnalisé avec Management API

Vous pouvez aussi configurer une fournisseur de téléphone personnalisé avec Management API. Il s’agit d’un processus en plusieurs étapes :

1. Créez une [action](https://auth0.com/docs/api/management/v2/actions/post-action) et paramétrez `supported_triggers.id` pour `custom-phone-provider`.

   1. consultez la documentation de votre fournisseur pour savoir comment envoyer des messages à leur API.
   2. Ajoutez les secrets nécessaires pour s’authentifier auprès de l’API.
2. [Déployez](https://auth0.com/docs/api/management/v2/actions/post-deploy-action) l’action
3. Réglez [fournisseur de téléphonie](https://auth0.com/docs/api/management/v2/branding/create-phone-provider) sur `personnalisé`.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

L’Action que vous créez avec le déclencheur `custom-phone-provider` n’apparaîtra pas dans la bibliothèque d’Actions.

</Callout>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Si aucune Action n’est déployée et que vous essayez de configurer un fournisseur `custom`, Auth0 enverra une erreur `"errorCode":"custom_email_provider_deployed_action_not_found"`.

</Callout>

Vous pouvez configurer un fournisseur de courrier électronique personnalisé à l’aide de Auth0 Dashboard.

#### Mettez à jour le fournisseur de téléphone personnalisé avec Management API

Vous pouvez aussi mettre à jour le fournisseur de services téléphoniques personnalisé à l’aide de Management API

1. (Facultatif) Si vous ne connaissez pas l’identifiant précis de l’action, vous pouvez [obtenir la liste des actions](https://auth0.com/docs/api/management/v2/actions/get-actions) via Management API. La réponse comprendra un objet Actions. L’action utilisée pour le fournisseur de téléphonie personnalisé peut être identifiée par `supported_triggers.id`, qui doit être réglé sur `custom-phone-provider`.
2. [Mettez à jour l’action](https://auth0.com/docs/api/management/v2/actions/patch-action) autant de fois que nécessaire.
3. [Déployez](https://auth0.com/docs/api/management/v2/actions/post-deploy-action) l’action.

</Tab></Tabs>

[Twilio Verify](https://www.twilio.com/docs/verify) est un exemple d’un fournisseur de téléphone personnalisé que vous pouvez configurer. Pour en savoir plus, lisez [Configure custom phone provider with Twilio Verify (Configurer le fournisseur de téléphone personnalisé avec Twilio Verify)](/docs/fr-ca/customize/phone-messages/configure-phone-messaging-providers/configure-a-custom-phone-provider/configure-a-custom-phone-provider-with-twilio-verify).

## Exemple d’Action de custom-phone-provider

Le déclencheur `custom-phone-provider` est distinct du déclencheur `send-phone-message`, qui ne doit pas être utilisé pour configurer un fournisseur de téléphone personnalisé. Pour en savoir plus, lisez :

* [Action Triggers: custom-phone-provider API Object (Déclencheurs d’Actions : objet API custom-phone-provider)](/docs/fr-ca/customize/phone-messages/configure-phone-messaging-providers/configure-a-custom-phone-provider/action-triggers-custom-phone-provider-api-object)
* [Action Triggers: custom-phone-provider Event Object (Déclencheurs d’action : Objet d’événement custom-phone-provider)](/docs/fr-ca/customize/phone-messages/configure-phone-messaging-providers/configure-a-custom-phone-provider/actions-triggers-custom-phone-provider-event-object)

L’exemple de code suivant est une Action `custom-phone-provider` qui a la fonctionnalité d’une Action `send-phone-message` :

```javascript lines
const { fetch } = require('undici');
/**
* Handler to be executed while sending a phone notification
* @param {Event} event - Details about the user and the context in which they are logging in.
* @param {CustomPhoneProviderAPI} api - Methods and utilities to help change the behavior of sending a phone notification.
*/
exports.onExecuteCustomPhoneProvider = async (event, api) => {

  if (event.notification.message_type.startsWith('otp')) {
    const body = {
      from: event.notification.from,
      action: event.notification.message_type === 'otp_verify' ? 'second-factor-authenticator' : 'enrollment',
      language: event.notification.locale,
      recipient: event.notification.recipient,
      message_type: event.notification.delivery_method,
      text: event.notification.as_text,
      code: event.notification.code,
    };

    const response = await fetch(event.secrets['MY_ENDPOINT'], {
      method: 'POST',
      headers: {
        authorization: `Bearer ${event.secrets['MY_SECRET']}`,
      },
      body: JSON.stringify(body),
    });

    console.log(response.status); // 200
    console.log(await response.text()); // request's response body!
  }

  return;
};
```

