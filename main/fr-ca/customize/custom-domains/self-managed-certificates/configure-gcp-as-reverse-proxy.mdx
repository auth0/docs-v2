---
title: "Configurer Google Cloud Platform avec un équilibrage de charge en tant que proxy inverse"
permalink: "configure-gcp-as-reverse-proxy"
'description': "Comment configurer Google Cloud Platform (GCP) avec un équilibrage de charge pour l’utiliser comme proxy de domaine personnalisé pour Auth0."
'og:title': "Configurer Google Cloud Platform avec un équilibrage de charge en tant que proxy inverse"
'og:description': "Comment configurer Google Cloud Platform (GCP) avec un équilibrage de charge pour l’utiliser comme proxy de domaine personnalisé pour Auth0."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Configurer Google Cloud Platform avec un équilibrage de charge en tant que proxy inverse"
'twitter:description': "Comment configurer Google Cloud Platform (GCP) avec un équilibrage de charge pour l’utiliser comme proxy de domaine personnalisé pour Auth0."
---

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Les domaines personnalisés d’Auth0 sont disponibles avec n’importe quel [plan d’abonnement](https://manage.auth0.com/#/tenant/billing/subscription). Si vous souhaitez gérer les certificats SSL/TLS vous-même, vous aurez besoin d’un abonnement **Enterprise**. Pour en savoir plus, voir les [plans de tarification Auth0](https://auth0.com/pricing).

</Callout>

Vous pouvez configurer Google Cloud Platform (GCP) avec un équilibrage de charge en tant que proxy inverse. Le diagramme suivant décrit les composants de la configuration.

* **Google Cloud Platform Load Balancer** répartit le trafic entre plusieurs instances d’applications.
* **Internet Network Endpoint Group** est un système dorsal qui se trouve en dehors de Google Cloud. Voir [Groupe de points de terminaison du réseau Internet](https://cloud.google.com/load-balancing/docs/negs/internet-neg-concepts) pour plus de détails.

<Frame>![Google Cloud Platform with Load Balancing as Reverse Proxy flow diagram](/images/fr-ca/cdy7uua7fh8z/62abKXSoxy0b7uxBfmoWjs/4d6c05060d16d36265e5184ccb3d95b9/gcp-load-balancing-reverse-proxy-diagram.png)</Frame>

1. [Configurer des domaines personnalisés avec des certificats autogérés](/docs/fr-ca/customize/custom-domains/self-managed-certificates) si ce n’est déjà fait. Prenez note des valeurs **Nom du domaine d’origine** et `cname-api-key` pour utilisation ultérieure.
2. Vérifiez la propriété du domaine en ajoutant un enregistrement TXT sur votre serveur DNS dans [Auth0 Dashboard > Tenant Settings (Paramètres du locataire) > Custom Domains (Domaines personnalisés)](https://manage.auth0.com/#/tenant/custom_domains), puis cliquez sur **Verify (Vérifier)**.
3. Une fois que GCP a vérifié votre domaine, connectez-vous à la [console GCP](https://console.cloud.google.com).
4. Allez à **Network Services (Services réseaux) > Load Balancing (Équilibrage de charge)**. Cliquez sur **Create Load Balancer (Créer un équilibreur de charge)**. Pour en savoir plus, consultez [Cloud Load Balancing](https://cloud.google.com/load-balancing/docs) dans la documentation de Google Cloud.

   1. Sélectionnez **HTTP(S) Load Balancing (Équilibrage de charge HTTP(S))**.
   2. Sélectionnez **From Internet to my VMs (D’Internet vers mes VM** car nous devons diriger le trafic de l’Internet vers Auth0. Cliquez sur **Continue (Continuer)**.
   3. Fournissez un nom pour l’équilibrage de charge, comme `auth0-reverse-proxy` et cliquez sur **Create (Créer)**.
5. Configurer le système dorsal.

   1. Créez un groupe de points de terminaison de réseau Internet (NEG) qui est un système dorsal résidant en dehors de Google Cloud. Pour en savoir plus, consultez [Présentation des groupes de points de terminaison de réseau](https://cloud.google.com/load-balancing/docs/negs/internet-neg-concepts) dans la documentation de Google Cloud.
   2. Sélectionnez le nouveau groupe de points de terminaison de réseau (NEG) créé en tant que système dorsal dans la configuration du service dorsal et définissez la valeur `cname-api-key` et `host` (nom de domaine d’origine) de votre locataire Auth0.
   3. Cliquez sur **Terminé**.
6. Configurez les règles `host` et `path`.

   1. Choisissez **Action** pour **Route traffic to a single backend (Acheminer le trafic vers un seul système dorsal)**.
   2. Dans **Host rewrite**, saisissez le nom du domaine d’origine de votre locataire Auth0 que vous avez enregistré précédemment.
   3. Cliquez sur **Create** (Créer).
7. Configurez le système du côté client.

   1. Créez un certificat. La méthode la plus simple est de choisir **Google-managed certificate (Certificat géré par Google)** car Google se charge automatiquement de la fourniture du certificat SSL pour vous.
   2. Si vous ne choisissez pas un certificat géré par Google, il est donc de votre responsabilité de renouveler et de télécharger le certificat SSL auprès de votre autorité de certification avant son expiration.
8. Examinez et finalisez la configuration.
   Il faudra une minute à GCP pour configurer le répartiteur de charge. Problèmes typiques qui pourraient causer une erreur :

   * **Invalid API key (Clé d’API non valide)** : la `cname-api-key` n’a pas été définie sur Auth0 à partir de GCP.
   * **403 Interdit** : l’en-tête `host` n’a pas été envoyée à Auth0 à partir de GCP
9. Mettez à jour vos enregistrements DNS pour [connecter votre domaine à votre équilibreur de charge](https://cloud.google.com/load-balancing/docs/https/setup-global-ext-https-external-backend#update_dns).

## En savoir plus

* [Configurer des fonctionnalités pour utiliser des Domaines personnalisés](/docs/fr-ca/customize/custom-domains/configure-features-to-use-custom-domains)
* [Dépanner les domaines personnalisés](/docs/fr-ca/troubleshoot/integration-extensibility-issues/troubleshoot-custom-domains)
* [Versions et suites cryptographiques TLS (SSL)](/docs/fr-ca/customize/custom-domains/self-managed-certificates/tls-ssl)