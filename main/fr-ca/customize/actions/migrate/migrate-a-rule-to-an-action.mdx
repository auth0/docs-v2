---
title: "Outils de migration"
permalink: "migrate-a-rule-to-an-action"
'description': "Description de l’utilisation des outils de migration des règles dans l’Auth0 Dashboard"
'og:title': "Outils de migration"
'og:description': "Description de l’utilisation des outils de migration des règles dans l’Auth0 Dashboard"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Outils de migration"
'twitter:description': "Description de l’utilisation des outils de migration des règles dans l’Auth0 Dashboard"
---

Simplifiez le processus de migration des règles vers les actions à l’aide des outils de migration des règles dans l’[Auth0 Dashboard](https://manage.auth0.com/). En plus de faciliter la transition d’une règle en une action, les nouveaux outils offrent également des conseils intégrés et des correctifs pour les modèles de règles communs.

## Avant la migration

Avant de commencer la migration, consultez la page [Migration des Règles vers les Actions](/docs/fr-ca/customize/actions/migrate/migrate-from-rules-to-actions). Ce guide de migration est une excellente ressource qui explique les différences entre les règles et les actions; il s’agit d’un outil utile dans le parcours de migration.

### Ordre de migration des règles

Avant de commencer la migration, consultez la page [Migration des Règles vers les Actions](/docs/fr-ca/customize/actions/migrate/migrate-from-rules-to-actions). Ce guide de migration est une excellente ressource qui explique les différences entre les règles et les actions; il s’agit d’un outil utile dans le parcours de migration.

Si vous ne faites pas la migration dans cet ordre, cela peut entraîner des erreurs en raison d’effets secondaires imprévus causés par des dépendances dans l’ordonnancement des règles et des actions.

### Retour en arrière sécuritaire

Si vous ne faites pas la migration dans cet ordre, cela peut entraîner des erreurs en raison d’effets secondaires imprévus causés par des dépendances dans l’ordonnancement des règles et des actions.

## Migration d’une règle

Pour commencer la migration de votre règle, sélectionnez **Pipeline Auth > Règles**. Une fois vos règles sélectionnées, elles s’affichent avec une option permettant de migrer chacune d’entre elles individuellement.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/79DmJp8C2vYZpdos51Z0nM/5a665d04c66dd9f0b8f0e25198cb9e4e/SS1_Dashboard_migration_screenshot.png)</Frame>

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

La migration ne commence que lorsque vous avez choisi Migrer vers une Action. En tant que développeur, vous pouvez choisir quand activer la nouvelle Action.

</Callout>

### Migration vers une action

Après avoir sélectionné **Migration vers une action**, l’outil vous invite à créer une nouvelle action.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/1A8FnVyvqAwW8hbrkOQDoG/f83ba9d5157db14ac2a3a666b2280574/SS2_Migrate_to_Action_screenshot.png)</Frame>

Après avoir sélectionné **Créer**, la nouvelle action est créée et l’éditeur d’actions s’affiche.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/2A10fE69aVngEcL2ZQCqWX/720dca2a8e6005c9378efad3bc140af0/Screenshot_2024-06-06_at_11.55.38_AM.png)</Frame>

Si la règle est migrée vers une action et qu’elle est toujours active, la règle se ferme avant que la logique ne s’exécute.

Cette exécution se fait en appelant `api.rules.wasExecuted()`. Si la fonction `wasExecuted` trouve une chaîne contenant l’ID de la règle, elle renvoie `true` si la règle a déjà été exécutée (et dans le cas contraire, elle renvoie `false`).

Dès que vous désactivez la règle référencée, la fonction renvoie false et la logique métier s’exécute maintenant dans l’action. Dès que vous désactivez la règle référencée, la fonction renvoie `false` et la logique métier s’exécute maintenant dans l’action.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

La valeur Rule ID se remplit automatiquement pour toute règle migrée à l’aide de la fonctionnalité **Migrer vers une action**.

</Callout>

Pour de plus amples renseignements sur la fonction `api.rules.wasExecuted()`, référez-vous à [Déclencheurs d’actions : post-connexion – Objet API](/docs/fr-ca/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/post-login-api-object).

## Réécriture du code de la règle

Sélectionnez le bouton **Règles** dans l’éditeur d’actions pour charger l’outil de migration des règles. Là, vous pouvez rapidement référencer le code de la règle migrée. Commencez par consulter le code de la règle sélectionnée dans la barre latérale.

Copiez le contenu de la fonction Rule et collez-le sous le commentaire `// YOUR CODE HERE` dans l’action. Il est par contre probable que ce code ne soit pas adapté au modèle de programmation d’actions.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/2jWCZFnfERuN7NzBPrpCDn/80ba271699893a007dac7baaf2dd44cb/Screenshot_2024-06-06_at_11.57.03_AM.png)</Frame>

L’éditeur d’actions vous fournira un retour d’information si le code doit être modifié. L’éditeur vous fournira également des suggestions sur la façon de corriger automatiquement la plupart des situations. Pour examiner la suggestion ou le correctif, passez la souris sur le code souligné :

<Frame>![](/images/fr-ca/cdy7uua7fh8z/5jRGI4iDX9ZgwcPRADTbZ1/caa90923a76800526871b137806e2af3/Screenshot_2024-06-06_at_11.58.07_AM.png)</Frame>

Vous pouvez appliquer des mises à jour spécifiques à une action en sélectionnant une option dans la fenêtre modale **Correction rapide**.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/qTS4RD6cjWFVfI0T9Uph3/45776c464f7247ddd8e91860f4646f2e/Screenshot_2024-06-06_at_11.58.48_AM.png)</Frame>

Lorsque vous sélectionnez le correctif recommandé, votre code est automatiquement mis à jour pour être compatible.

<Frame>![](/images/fr-ca/cdy7uua7fh8z/1cAq5A1MNVLPAsinHjtROh/c71276afd1f6df9e01d71cc869778907/Screenshot_2024-06-06_at_11.59.37_AM.png)</Frame>

Dans certaines situations, les correctifs ne peuvent pas être appliqués automatiquement, mais des directives vous seront tout de même fournies :

<Frame>![](/images/fr-ca/cdy7uua7fh8z/4Lx3RxJh8v4tj1J2SpPVvU/0ff35b0f40bb24d195ab2f4b06817d86/Screenshot_2024-06-06_at_12.00.22_PM.png)</Frame>

Par exemple, dans le cas de la fonction de `callback` de la règle, il est recommandé d’utiliser [`api.access.deny`](https://auth0.com/docs/customize/actions/flows-and-triggers/pre-user-registration-flow/api-object) pour les erreurs, ou simplement `return` pour les cas réussis.

### Test de la nouvelle action

Les actions peuvent être testées directement dans l’éditeur, car il s’agit d’une partie essentielle du parcours de migration. Pour de plus amples renseignements, voir [Test des actions](/docs/fr-ca/customize/actions/test-actions).

<Warning>

Nous vous conseillons vivement de valider toute la logique de migration dans un locataire de développement avant de l’activer en production.

</Warning>

### Activation automatique de l’action

Lorsque le code d’action est mis à jour et que vous êtes prêt à l’appliquer :

1. Sélectionnez **Déployer**.
2. Dans l’alerte qui confirme votre déploiement, sélectionnez **Ajouter au flux**.
3. Ajoutez l’action que vous venez de créer au flux, puis sélectionnez **Appliquer**.
4. Sélectionnez **Continuer** et **désactivez toutes les règles sélectionnées** pour activer simultanément la nouvelle action et désactiver la règle d’origine. Si vous n’êtes pas prêt, sélectionnez **Annuler** et vous pourrez désactiver la règle ultérieurement pour activer la logique migrée vers l’action.

Pour de plus amples renseignements sur l’ajout de votre action au flux, référez-vous à la section [Écrire votre première action](/docs/fr-ca/customize/actions/write-your-first-action).

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Si vous réactivez une règle, la logique d’action correspondante est ignorée.

</Callout>

## Migration des règles restantes

Ce processus peut être répété pour migrer chaque règle dans votre flux de connexion. N’oubliez pas que les règles doivent être migrées dans l’ordre inverse de leur exécution lors du flux de connexion.