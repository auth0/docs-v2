---
title: "Migrer vers Tenant Log Search v3"
permalink: "migrate-to-tenant-log-search-v3"
'description': "Décrit comment migrer de la v2 à la v3 de Auth0 Logs Search."
'og:title': "Migrer vers Tenant Log Search v3"
'og:description': "Décrit comment migrer de la v2 à la v3 de Auth0 Logs Search."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Migrer vers Tenant Log Search v3"
'twitter:description': "Décrit comment migrer de la v2 à la v3 de Auth0 Logs Search."
---

Pour fournir à nos clients la solution la plus fiable et la plus évolutive, Auth0 a rendu obsolète le moteur de recherche Logs Search Engine V2 au profit de la version 3.

Auth0 migre de manière proactive les clients non affectés par ce changement, tandis que ceux qui sont potentiellement affectés sont avisés d’opter pour la v3 pendant la période de grâce prévue.

## Caractéristiques affectées

Vous êtes concerné si vous remplissez tous les critères suivants :

* Locataires créés au plus tard le 21 mai 2019
* Locataires hébergés dans le nuage public d’Auth0 dans les régions de l’AU ou de l’UE
* Utilisez le point de connexion GET /api/v2/logs ou le point de terminaison GET `/api/v2/users/{user_id}/logs` avec le paramètre `include_totals=true` ou le paramètre `q.`
* Paginez à travers plus de 1000 résultats.
* Utilisez Extension d’administration déléguées. Les anciennes versions de l’extension continueront de fonctionner après la migration de votre locataire vers Logs Search Engine v3, mais vous remarquerez peut-être que les totaux de pagination sont incorrects lors de l’affichage des journaux. La mise à jour vers la v3.7 de l’extension résout ce problème.

Les locataires suivants ne sont pas touchés :

* Locataires du nuage dans la région des États-Unis. La région des États-Unis a été entièrement migrée et utilise déjà Search Engine v3.
* Les locataires du nuage privé (la migration pour les clients du nuage privé commencera ultérieurement.)
* Les locataires du nuage dans les régions de l’UE et de l’AU qui :

  + n’utilisent pas du tout les points de terminaison `GET /api/v2/logs` ou `GET/api/v2/users/{user_id}/logs` de Management API.
  + utilisent les journaux de la section Journaux du Dashboard uniquement.
  + utilisent le point de terminaison `GET /api/v2/logs` avec la méthode par point de contrôle (à l’aide du paramètre `from`).
  + utilisent des journaux à l’aide de l’une des extensions Journaux Auth0 vers le Dashboard du service externe (qui utilisent la méthode par point de contrôle).

## Vérifier la demande de migration

Auth0 ne génère qu’un seul journal du même type et de la même description toutes les 60 minutes. Quel que soit le nombre d’appels effectués à l’aide de fonctions obsolètes aux points de terminaison touchés, vous verrez toujours un seul journal par heure pour chaque fonctionnalité obsolète.

Si vous apportez des modifications à vos demandes, vous devrez attendre 60 minutes avant de pouvoir conclure que l’absence de nouveaux journaux `depnote` signifie que le comportement obsolète a été supprimé de votre code.

Vous pouvez rechercher dans vos journaux de locataires les requêtes suivantes qui généreraient des erreurs après la migration vers la v3 :

`type:depnote AND description:*logs*`

Ces entrées de journal comprennent un champ de `description` qui spécifie le comportement obsolète que vous utilisez.

Vous pouvez également consulter les champs `details.request.path` et `client_name` pour voir quelle application appelle `GET /api/v2/logs` ou `GET /api/v2/users/{user_id}/logs`.

## Changements

Les changements de rupture sont mineurs, mais vous devez examiner vos requêtes pour vous assurer que les résultats que vous obtenez sont conformes aux attentes.

Les changements de rupture sont liés aux éléments suivants :

### Pagination

* Lorsque votre client est migré à la v3 des journaux, la valeur du champ `total` renvoyé dans le résultat de synthèse lors de l’appel de `GET /api/v2/logs` ou de `GET /api/v2/users/{user_id}/logs` change. Lorsque vous recherchez des journaux à l’aide du Search Engine v2, le champ des totaux de vos résultats vous indique le nombre de journaux qui correspondent à la requête que vous avez fournie. Cependant, dans v3, le champ des totaux vous indique combien de journaux vous sont renvoyés dans la page (similaire à ce que renvoie le champ longueur). Pour éviter toute perturbation potentielle, si votre application s’appuie sur le champ des totaux à des fins de pagination, vous devez mettre à jour votre logique pour gérer ce changement de manière appropriée.
* Il y a une limite existante de 100 journaux par demande. Lorsque votre locataire est migré vers journaux v3, vous ne pouvez paginer que sur un maximum de 1 000 résultats de recherche, ce qui entraîne une erreur pour les appels qui reçoivent plus de 1 000 résultats. Pour éviter toute perturbation potentielle, vous devez examiner vos requêtes pour éviter cette limite ou gérer les erreurs en conséquence.

### Validation du paramètre q

* La syntaxe de requête lors de l’utilisation du paramètre `q` dans l’appel `GET /api/v2/logs` comporte des modifications mineures qui doivent être prises en compte. Lorsque votre locataire est migré vers journaux v3, cette validation sera appliquée, ce qui entraînera le retour d’une erreur dans cette requête. Pour éviter toute perturbation potentielle, vous devez examiner vos requêtes pour vous assurer qu’elles sont conformes à la syntaxe de requête prise en charge.
* Le paramètre `q` inclut un champ non valide. Lorsque votre locataire est migré vers journaux v3, cette validation sera appliquée, ce qui entraînera le retour d’une erreur dans cet appel. Pour éviter toute perturbation potentielle, vous devez examiner vos requêtes pour vous assurer que seuls les champs pouvant faire l’objet d’une recherche sont inclus.

## Activer Recherche dans le journal des locataires v3

Après avoir examiné vos requêtes, vous pouvez activer le moteur de recherche de journaux (v3) pour votre locataire via le Dashboard.

1. Accédez à [Paramètres du locataire > Avancés](https://manage.auth0.com/#/tenant/advanced).
2. Faites défiler vers le bas jusqu’à **Migrations**.
3. Désactivez l’option **Recherche de journaux V2 héritée**. Cela désactive l’ancien moteur de recherche V2 (obsolète) et impose l’utilisation du moteur V3. Si l’option **Recherche de journaux V2 héritée** n’est pas visible, votre migration vers la version V3 a déjà été effectuée. Aucune action supplémentaire n’est requise.

Si vous avez besoin d’aide pour la migration, communiquez avec nous à l’aide du [Centre de soutien](https://support.auth0.com/).

## En savoir plus

* [Journaux](/docs/fr-ca/deploy-monitor/logs)