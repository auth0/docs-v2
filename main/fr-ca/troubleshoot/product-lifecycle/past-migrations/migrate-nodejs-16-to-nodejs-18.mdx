---
title: "Migrer des versions 12 et 16 de Node vers Node 18"
permalink: "migrate-nodejs-16-to-nodejs-18"
'description': "Décrit les éléments Auth0 Actions affectées par la  v12+6 de migration de Node.js vers la v18 de Node.js."
'og:title': "Migrer des versions 12 et 16 de Node vers Node 18"
'og:description': "Décrit les éléments Auth0 Actions affectées par la  v12+6 de migration de Node.js vers la v18 de Node.js."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Migrer des versions 12 et 16 de Node vers Node 18"
'twitter:description': "Décrit les éléments Auth0 Actions affectées par la  v12+6 de migration de Node.js vers la v18 de Node.js."
---

La prise en charge à long terme (LTS) pour les versions 12 et 16 de node.js a pris fin en 2023, ce qui signifie que l’équipe de développement de Node.js ne porte plus les correctifs de sécurité critiques sur ces versions de manière rétroactive. Toute exécution effectuée avec la version de Node 12 ou 16 comme environnement d’exécution pourrait exposer votre code d’extensibilité à des vulnérabilités de sécurité.

L’environnement d’exécution de l’extensibilité de la version 18 de Node est généralement disponible sur l’ensemble de notre suite d’offres d’extensibilité. Cela inclut les actions, les règles, les hooks, les scripts de base de données et les connexions personnalisées avec les réseaux sociaux. Nous encourageons vivement tout le monde à mettre à jour vers la version de Node 18 dès que possible pour adhérer aux meilleures pratiques de sécurité du code.

## Considérations générales

### Migrer les règles et hooks vers les actions

Si vous utilisez une exécution d’extensibilité interrompue, nous vous recommandons de profiter de l’examen de votre implémentation des règles et des hooks pour les migrer vers des actions (la version 18 de Node). Déterminez les règles et les appels que vous pouvez migrer vers les actions en visitant [Limites liées aux actions](/docs/fr-ca/customize/actions/limitations). Pour savoir comment migrer vos règles et vos appels vers des actions, veuillez consulter la page [Migrer vers les actions](/docs/fr-ca/customize/actions/migrate).

### Intégrations Marketplace

#### Intégrations des connexions avec les réseaux sociaux

Utilisez la [Management API](/docs/fr-ca/api/management/v2) pour identifier une liste complète des connexions avec les réseaux sociaux qu’un changement de version de l’environnement d’exécution de Node peut affecter. Plus particulièrement, toutes les connexions avec les réseaux sociaux potentiellement affectées, qu’elles soient explicitement créées en tant que connexion avec les réseaux sociaux personnalisée ou initialement ajoutées par la place du marché, ont une valeur d’attribut de `strategy` établie à `oauth1` ou à `oauth2`.

Vous pouvez ensuite paginer à travers toutes les connexions personnalisées avec les réseaux sociaux existantes dans un locataire donné à l’aide du point de terminaison `GET` Connections de <Tooltip href="/docs/fr-ca/glossary?term=management-api" tip="Management API
Un produit permettant aux clients d’effectuer des tâches administratives." cta="Voir le glossaire">Management API</Tooltip>. Par exemple, les options de requête suivantes renvoient les noms et identifiants d’un maximum de 100 connexions personnalisées avec les réseaux sociaux :

```http wrap lines
/api/v2/connections?strategy=oauth1&strategy=oauth2&include_totals=true&fields=name&per_page=100
```

L’<Tooltip href="/docs/fr-ca/glossary?term=auth0-dashboard" tip="Auth0 Dashboard
Principal produit d’Auth0 pour configurer vos services." cta="Voir le glossaire">Auth0 Dashboard</Tooltip> ne permet pas de mettre à jour les scripts pour les connexions personnalisées avec les réseaux sociaux ajoutées par Marketplace Si une modification de script est nécessaire pour être compatible avec la version 18 de Node, vous devez utiliser Management API.

## Tâches de migration

### Créer de nouvelles actions personnalisées

Pour créer une nouvelle action personnalisée avec la version de Node 18 par l’Auth0 Dashboard :

1. Naviguez vers [Auth0 Dashboard> Actions > Bibliothèque](https://manage.auth0.com/#/dashboard/actions/library).
2. Sélectionnez **Créer une action > Construire à partir de zéro**.
3. Dans le champ **Exécution\***, sélectionnez **Version 18 de Node (recommandé)**.
4. Écrivez vos actions personnalisées dans la version 18 de Node, puis testez et déployez-les lorsqu’elles sont prêtes.

### Mettre à niveau des actions personnalisées existantes

Vous pouvez mettre à niveau individuellement les actions personnalisées existantes construites sur la version 12 ou 16 de Node vers la version de Node, puis [revenir à la version précédente](/docs/fr-ca/customize/actions/manage-versions#revert-actions) en utilisant l’ancien environnement d’exécution. Mettez à jour les actions vers la version de Node en créant et en déployant une nouvelle version de l’implémentation actuelle pour utiliser la version 18 de Node comme environnement d’exécution.

### Choisissez la version 18 de Node pour les autres produits d’extensibilité

Le temps d’exécution utilisé pour les offres d’extensibilité restantes (autres que les actions) est défini globalement au niveau des paramètres avancés du locataire. La modification de ce paramètre affecte simultanément les fonctionnalités suivantes :

* règles
* hooks
* scripts personnalisés de base de données
* scripts de connexion personnalisée avec les réseaux sociaux

Pour modifier le paramètre d’exécution de l’extensibilité du locataire dans l’Auth0 Dashboard :

1. Accédez à **Dashboard > > Paramètres > > Avancés**.
2. Faites défiler jusqu’à la section **Extensibilité**.
3. Pour l’**environnement d’exécution**, sélectionnez **version 18 de Node**.

Étant donné qu’il s’agit d’un paramètre global qui a un impact simultané sur plusieurs fonctionnalités d’extensibilité, nous vous recommandons d’effectuer d’abord cette étape dans votre locataire de développement, de tester toutes les fonctionnalités d’extensibilité applicables et de ne passer à votre locataire de production que lorsque vous ne voyez aucun problème en cours de développement.

En particulier avec les scripts de bases de données personnalisés, vous pouvez [suivre les étapes expliquées sur cette page](/docs/fr-ca/authenticate/database-connections/custom-db/custom-database-connections-scripts/environment) pour vérifier individuellement un script par rapport à une version d’exécution spécifique avant de procéder à la modification de la version d’exécution globale.

## Changements de rupture connus

### Modules npm magiques

L’environnement d’exécution d’extensibilité de la version 12 de Node prend en charge l’utilisation de modules `npm` spécifiques sans les exiger explicitement dans le code d’extensibilité. À partir de la version 16 de l’environnement d’exécution de Node, nous avons supprimé la prise en charge de ce type d’utilisation pour les modules suivants :

* _
* async
* Auth0
* azure_storage
* bcrypt
* crypto
* couchbase
* cql
* IP
* <Tooltip href="/docs/fr-ca/glossary?term=json-web-token" tip="Jeton Web JSON (JWT) Format standard de jeton d’ID (et souvent de jeton d’accès) utilisé pour représenter en toute sécurité des demandes entre deux parties." cta="Voir le glossaire">jwt</Tooltip>
* Knex
* mongo
* mysql
* mysql_pool
* ObjectID
* pbkdf2
* pg
* postgres
* Pubnub
* q
* querystring
* sqlserver
* uuid
* xml2js
* xmldom
* xpath
* xtend

Si l’extensibilité est toujours en cours d’exécution sur la version 12 de Node, tenez compte de ce qui précède lors de la mise à jour du code directement vers la version 18 de Node. Avant d’utiliser un module, vous devez vous assurer qu’il est explicitement requis.

Dans le contexte des règles, des connexions de base de données personnalisées et des connexions personnalisées avec les réseaux sociaux, vous devez explicitement exiger une version du module qui est [répertoriée comme disponible pour la version 18 de Node](https://auth0-extensions.github.io/canirequire/).

Dans les hooks et les actions, vous devez ajouter la version cible prévue en tant que dépendance explicite avant d’exiger le module.

### Can I Require : suppression de versions de modules

Nous avons supprimé la prise en charge des versions spécifiées des modules ci-dessous pour le runtime Node 18 dans [Can I Require](https://auth0-extensions.github.io/canirequire/). Cette modification affecte le code d'extensibilité associé aux règles, aux scripts de connexion à une base de données personnalisée et aux scripts de connexion sociale personnalisée.

<Warning>

Le script de récupération du profil utilisateur pour les connexions sociales personnalisées suivantes ([Indeed](https://marketplace.auth0.com/integrations/indeed-social-connection), [monday.com](https://marketplace.auth0.com/integrations/monday-com-monday-com-social-connection), [Snapchat](https://marketplace.auth0.com/integrations/snapchat-social-connection), et [Tumblr](https://marketplace.auth0.com/integrations/tumblr-social-connection)), disponible via Marketplace, utilisait la version `0.22.0` du module `axios` qui n’est pas disponible dans Node 18. Si vous utilisez l’une de ces connexions, examinez et mettez à jour leurs scripts si nécessaire via [Management API](/docs/fr-ca/api/management/v2).

</Warning>

<table class="table"><thead>
<tr>
<th>Module</th>
<th>Versions</th>
</tr>
</thead>
<tbody>
<tr>
<td>@analytics/google-analytics</td>
<td>0.4.0</td>
</tr>
<tr>
<td>@auth0/hapi</td>
<td>13.5.1, 13.6.0</td>
</tr>
<tr>
<td>@auth0/rule-utilities</td>
<td>0.1.0</td>
</tr>
<tr>
<td>@gitbeaker/node</td>
<td>17.0.1</td>
</tr>
<tr>
<td>@incognia/api</td>
<td>1.0.0</td>
</tr>
<tr>
<td>@octokit/rest</td>
<td>15.8.2</td>
</tr>
<tr>
<td>@sentry/node</td>
<td>5.6.2, 5.15.5, 6.2.0</td>
</tr>
<tr>
<td>acorn</td>
<td>1.2.2</td>
</tr>
<tr>
<td>airbrake</td>
<td>1.0.2</td>
</tr>
<tr>
<td>airgram</td>
<td>3.1.1</td>
</tr>
<tr>
<td>ajv</td>
<td>6.10.1</td>
</tr>
<tr>
<td>amazon-dax-client</td>
<td>1.2.2</td>
</tr>
<tr>
<td>amazon-mws-node</td>
<td>1.0.3</td>
</tr>
<tr>
<td>analytics</td>
<td>0.5.1</td>
</tr>
<tr>
<td>analytics-node</td>
<td>2.0.1, 3.5.0</td>
</tr>
<tr>
<td>applicationinsights</td>
<td>0.15.8, 0.18.0, 1.5.0, 1.8.8</td>
</tr>
<tr>
<td>async</td>
<td>1.0.0, 0.9.0, 2.1.2, 2.6.1</td>
</tr>
<tr>
<td>auth0</td>
<td>2.4.0, 2.1.0, 2.0.0, 0.8.2, 2.6.0, 2.7.0, 2.8.0, 2.9.1, 2.13.0, 2.17.0, 2.17.1, 2.19.0, 2.23.0, 2.27.0, 2.27.1, 2.30.0, 2.31.0, 2.32.0, 2.34.2, 2.35.0, 2.36.1, 2.36.2, 2.39.0, 3.0.1</td>
</tr>
<tr>
<td>auth0-authz-rules-api</td>
<td>4.0.0</td>
</tr>
<tr>
<td>auth0-ext-template-renderers</td>
<td>0.4.2</td>
</tr>
<tr>
<td>auth0-extension-express-tools</td>
<td>1.0.2, 1.1.5, 1.1.6, 2.0.0</td>
</tr>
<tr>
<td>auth0-extension-hapi-tools</td>
<td>1.0.0, 1.1.0, 1.2.0, 1.2.1, 1.2.2, 1.3.0</td>
</tr>
<tr>
<td>auth0-extension-tools</td>
<td>1.0.0, 1.2.1, 1.3.1, 1.3.2, 1.4.0</td>
</tr>
<tr>
<td>auth0-magic</td>
<td>3.1.0</td>
</tr>
<tr>
<td>auth0-oauth2-express</td>
<td>0.0.1, 0.0.3, 1.1.5</td>
</tr>
<tr>
<td>auth0-source-control-extension-tools</td>
<td>3.0.10, 3.0.9, 3.1.4, 3.4.0, 3.5.1, 4.0.3, 4.0.5, 4.0.6, 4.0.7, 4.1.1, 4.1.2, 4.1.3, 4.1.5, 4.1.7, 4.1.9</td>
</tr>
<tr>
<td>aws-sdk</td>
<td>2.2.30, 2.1.31, 2.1.13, 2.4.13, 2.5.3, 2.197.0, 2.291.0, 2.458.0, 2.593.0</td>
</tr>
<tr>
<td>axios</td>
<td>0.15.2, 0.18.0, 0.19.2, 0.21.1, 0.21.3, 0.22.0, 0.27.2</td>
</tr>
<tr>
<td>azure</td>
<td>0.10.6</td>
</tr>
<tr>
<td>azure-storage</td>
<td>0.4.4, 0.4.1, 0.9.0</td>
</tr>
<tr>
<td>babel</td>
<td>5.4.7, 5.1.9</td>
</tr>
<tr>
<td>bcrypt</td>
<td>4.0.0</td>
</tr>
<tr>
<td>bluebird</td>
<td>2.9.26, 3.4.6</td>
</tr>
<tr>
<td>body-parser</td>
<td>1.12.4</td>
</tr>
<tr>
<td>boom</td>
<td>2.7.2</td>
</tr>
<tr>
<td>botbuilder</td>
<td>0.9.0</td>
</tr>
<tr>
<td>bson</td>
<td>0.3.2, 4.4.0</td>
</tr>
<tr>
<td>cookie-parser</td>
<td>1.3.5</td>
</tr>
<tr>
<td>datadog-metrics</td>
<td>0.8.2, 0.9.0, 0.9.2, 0.9.3</td>
</tr>
<tr>
<td>disposable-email-domains</td>
<td>1.0.14, 1.0.15, 1.0.56</td>
</tr>
<tr>
<td>dockerode</td>
<td>2.1.4, 2.0.3</td>
</tr>
<tr>
<td>dotenv</td>
<td>0.4.0, 2.0.0</td>
</tr>
<tr>
<td>easy-pbkdf2</td>
<td>0.0.2</td>
</tr>
<tr>
<td>ejs</td>
<td>2.3.1</td>
</tr>
<tr>
<td>engine.io-client</td>
<td>1.5.1</td>
</tr>
<tr>
<td>express</td>
<td>4.12.4, 4.14.0, 4.16.3</td>
</tr>
<tr>
<td>express-jwt</td>
<td>3.1.0, 5.1.0</td>
</tr>
<tr>
<td>faunadb</td>
<td>2.11.1, 4.1.1</td>
</tr>
<tr>
<td>filter-object</td>
<td>2.1.0</td>
</tr>
<tr>
<td>firebase</td>
<td>7.12.0</td>
</tr>
<tr>
<td>firebase-admin</td>
<td>4.0.4, 5.0.0, 6.0.0, 8.0.0, 8.12.1</td>
</tr>
<tr>
<td>form-data</td>
<td>0.2.0</td>
</tr>
<tr>
<td>getstream</td>
<td>3.4.1</td>
</tr>
<tr>
<td>gitlab</td>
<td>1.7.0</td>
</tr>
<tr>
<td>google-auth-library</td>
<td>1.0.0</td>
</tr>
<tr>
<td>google-libphonenumber</td>
<td>2.0.7, 3.2.8, 3.2.10</td>
</tr>
<tr>
<td>googleapis</td>
<td>2.1.6, 34.0.0</td>
</tr>
<tr>
<td>got</td>
<td>3.2.0, 9.2.1, 10.7.0, 11.3.0, 11.5.2</td>
</tr>
<tr>
<td>hapi</td>
<td>13.5.0</td>
</tr>
<tr>
<td>hapi-auth-jwt2</td>
<td>7.0.1</td>
</tr>
<tr>
<td>hapi-swagger</td>
<td>7.4.0</td>
</tr>
<tr>
<td>hoek</td>
<td>2.14.0</td>
</tr>
<tr>
<td>http-proxy</td>
<td>1.11.1</td>
</tr>
<tr>
<td>ibm_db</td>
<td>2.6.4</td>
</tr>
<tr>
<td>ip</td>
<td>0.3.2, 0.0.1</td>
</tr>
<tr>
<td>ipaddr.js</td>
<td>1.0.1</td>
</tr>
<tr>
<td>joi</td>
<td>6.10.1</td>
</tr>
<tr>
<td>jose</td>
<td>3.19.0</td>
</tr>
<tr>
<td>jsforce</td>
<td>1.6.0</td>
</tr>
<tr>
<td>jsonwebtoken</td>
<td>5.7.0, 5.0.1, 5.0.0, 7.1.9, 8.5.0</td>
</tr>
<tr>
<td>jwks-rsa</td>
<td>1.0.0, 1.1.1, 1.6.0</td>
</tr>
<tr>
<td>ldapjs</td>
<td>1.0.0</td>
</tr>
<tr>
<td>lodash</td>
<td>3.10.1, 3.9.3, 2.4.1, 4.8.2, 4.17.10, 4.17.19</td>
</tr>
<tr>
<td>lru-cache</td>
<td>2.6.4</td>
</tr>
<tr>
<td>mixpanel</td>
<td>0.4.0</td>
</tr>
<tr>
<td>mkdirp</td>
<td>0.5.1</td>
</tr>
<tr>
<td>moment</td>
<td>2.10.3, 2.11.2</td>
</tr>
<tr>
<td>mongodb</td>
<td>2.0.48, 2.0.33, 2.0.27, 2.2.11, 3.1.4, 4.1.0, 3.6.10, 3.5.11</td>
</tr>
<tr>
<td>mongoose</td>
<td>4.1.6</td>
</tr>
<tr>
<td>morgan</td>
<td>1.5.3</td>
</tr>
<tr>
<td>mysql</td>
<td>2.7.0, 2.6.2, 2.0.0-alpha8, 2.15.0</td>
</tr>
<tr>
<td>mysql2</td>
<td>1.5.3</td>
</tr>
<tr>
<td>nano</td>
<td>6.2.0</td>
</tr>
<tr>
<td>neo4j-driver</td>
<td>1.7.1</td>
</tr>
<tr>
<td>node-fetch</td>
<td>2.6.0</td>
</tr>
<tr>
<td>node-jose</td>
<td>0.9.2</td>
</tr>
<tr>
<td>node-rdkafka</td>
<td>2.10.1</td>
</tr>
<tr>
<td>nodemailer</td>
<td>2.5.0</td>
</tr>
<tr>
<td>nsp</td>
<td>2.4.0</td>
</tr>
<tr>
<td>oauth</td>
<td>0.9.12</td>
</tr>
<tr>
<td>passport-wsfed-saml2</td>
<td>2.11.4</td>
</tr>
<tr>
<td>pg</td>
<td>4.5.7, 4.3.0, 4.1.1, 6.1.2, 7.17.1</td>
</tr>
<tr>
<td>postmark</td>
<td>1.3.1</td>
</tr>
<tr>
<td>q</td>
<td>1.0.1</td>
</tr>
<tr>
<td>qs</td>
<td>3.1.0</td>
</tr>
<tr>
<td>ramda</td>
<td>0.18.0, 0.23.0</td>
</tr>
<tr>
<td>range_check</td>
<td>0.0.1</td>
</tr>
<tr>
<td>raw-body</td>
<td>2.1.0</td>
</tr>
<tr>
<td>react</td>
<td>15.3.2</td>
</tr>
<tr>
<td>redis</td>
<td>0.12.1</td>
</tr>
<tr>
<td>request</td>
<td>2.56.0, 2.55.0, 2.27.0, 2.67.0, 2.73.0, 2.75.0, 2.81.0, 2.83.0, 2.88.0</td>
</tr>
<tr>
<td>rethinkdb</td>
<td>2.1.1, 2.0.0-1, 2.0.0</td>
</tr>
<tr>
<td>rollbar</td>
<td>0.6.2, 2.12.2</td>
</tr>
<tr>
<td>semver</td>
<td>4.3.4</td>
</tr>
<tr>
<td>sendgrid</td>
<td>1.8.0, 3.0.7</td>
</tr>
<tr>
<td>sequelize</td>
<td>3.1.1</td>
</tr>
<tr>
<td>soap</td>
<td>0.23.0</td>
</tr>
<tr>
<td>socket.io</td>
<td>1.3.5</td>
</tr>
<tr>
<td>socket.io-client</td>
<td>1.3.5</td>
</tr>
<tr>
<td>splunk-bunyan-logger</td>
<td>0.9.1</td>
</tr>
<tr>
<td>ssh2</td>
<td>0.4.13</td>
</tr>
<tr>
<td>stamplay</td>
<td>1.0.6, 1.0.5, 1.0.3</td>
</tr>
<tr>
<td>stripe</td>
<td>3.3.4, 4.14.0, 4.24.0, 7.1.0, 7.4.0, 8.52.0</td>
</tr>
<tr>
<td>sumo-logger</td>
<td>1.5.5</td>
</tr>
<tr>
<td>superagent</td>
<td>1.2.0, 3.8.3, 4.1.0</td>
</tr>
<tr>
<td>tedious</td>
<td>6.6.2, 1.11.0, 0.1.4, 8.3.1, 9.2.1</td>
</tr>
<tr>
<td>tough-cookie</td>
<td>1.2.0</td>
</tr>
<tr>
<td>twilio</td>
<td>2.2.1, 3.6.0, 3.57.0</td>
</tr>
<tr>
<td>twit</td>
<td>1.1.20</td>
</tr>
<tr>
<td>uuid</td>
<td>2.0.3, 2.0.1, 3.1.0, 3.3.2, 7.0.3, 8.0.0</td>
</tr>
<tr>
<td>vso-node-api</td>
<td>3.1.1</td>
</tr>
<tr>
<td>watson-developer-cloud</td>
<td>2.0.1</td>
</tr>
<tr>
<td>winston</td>
<td>1.0.0, 0.8.1, 3.1.0</td>
</tr>
<tr>
<td>xml2js</td>
<td>0.4.8, 0.2.8</td>
</tr>
<tr>
<td>xmlbuilder</td>
<td>2.6.4</td>
</tr>
<tr>
<td>xmldom</td>
<td>0.1.19, 0.1.13</td>
</tr>
<tr>
<td>xpath</td>
<td>0.0.5</td>
</tr>
<tr>
<td>xtend</td>
<td>1.0.3</td>
</tr>
</tbody>
</table>

### Une renégociation sécurisée est requise par défaut pour les connexions TLS

La version 18 de Node.js nécessite une renégociation sécurisée (RFC 5746) pour les connexions TLS par défaut, une conséquence de l’exigence introduite dans la dépendance OpenSSL sous-jacente.

Si votre code d’extensibilité effectue des appels réseau externes, les serveurs cibles doivent prendre en charge la renégociation sécurisée, sinon, les demandes échoueront et vous recevrez une erreur similaire à :

```text wrap lines
Error: write EPROTO C0BAF076:error:0A000152:SSL routines:final_renegotiate:unsafe legacy renegotiation disabled:../deps/openssl/openssl/ssl/statem/extensions.c:922:
```

Compte tenu de ce changement lié à la sécurité, nous vous recommandons de vous assurer que tous les serveurs cibles sont mis à jour pour prendre en charge la renégociation sécurisée. Si les serveurs en question sont des serveurs tiers qui ne sont pas sous votre contrôle, vous pouvez évaluer la possibilité d’opter pour le comportement précédent.

Par exemple, pour la bibliothèque `axios`, l’extrait de code suivant illustre comment activer le comportement hérité :

```javascript lines
const axios = require('axios');
const https = require('https');
const crypto = require('crypto');

axios.get(
  'https://[LEGACY_SERVER]', 
  {
    httpsAgent: new https.Agent(
      {
        secureOptions: crypto.constants.SSL_OP_LEGACY_SERVER_CONNECT
      }
    )
  })
```

