---
title: "Management APIを使ってログイベントを取得する"
permalink: "retrieve-log-events-using-mgmt-api"
'description': "Auth0 Management API get_logsエンドポイントを使用して、チェックポイントまたは検索条件によってログイベントを取得する方法を説明します。"
'og:title': "Management APIを使ってログイベントを取得する"
'og:description': "Auth0 Management API get_logsエンドポイントを使用して、チェックポイントまたは検索条件によってログイベントを取得する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Management APIを使ってログイベントを取得する"
'twitter:description': "Auth0 Management API get_logsエンドポイントを使用して、チェックポイントまたは検索条件によってログイベントを取得する方法を説明します。"
---

<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>を使用すると、[/get_logs](https://auth0.com/docs/api/management/v2/#!/Logs/get_logs)エンドポイントを使用して要求ごとに最大100件のログイベントを取得できます。このエンドポイントは、次の2種類の消費をサポートしています。

* **チェックポイントの場合** ：ログイベントを外部データ分析サービスにエクスポートする場合に推奨されます。
* **検索条件の場合** ：Dashboardにより使用されます。

Auth0によって保存されるログには、Auth0サブスクリプションに基づいた保持期間が適用されます。詳細については、「[ログデータ保持](/ja-jp/deploy-monitor/logs/log-data-retention)」をお読みください。

これらのエンドポイントを使って次のログを探すことができます。

* `/api/v2/logs/{id}`：指定されたログIDに関連付けられた単一のログエントリを取得します。
* `/api/v2/users/{user_id}/logs`：特定のユーザーIDのログイベントを取得します。

## チェックポイントでログを取得する

このメソッドを使用すると、指定された`log_id`よりも新しいログイベントを取得
できます。これは通常、Splunk、Datadog、Application Insights、Mixpanelなどの外部
システムにログを送信するために使用されます。

チェックポイントで検索するには、次のパラメーターを使用します。

<table class="table"><thead>
<tr>
<th><strong>パラメーター</strong></th>
<th><strong>説明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>`from`</td>
<td>ログの取得を開始するログイベントのID。`take`パラメーターを使用して、ログの量を制限できます。</td>
</tr>
<tr>
<td>`take`</td>
<td>`from`パラメーターを使用する際に取得するエントリの総数。</td>
</tr>
</tbody>
</table>

`from`と`take`以外のパラメータは無視されます。ログは`log_id`順に並べられます。

#### セマンティクス

チェックポイントによるログの取得には次のセマンティクスがあります。

* ロールの役割の権限で利用可能なすべてのログが返されます
* ログは、Auth0システムの遅延による過去のレコードのスキップを防ぐために、イベント生成時間ではなく`log_id`で順序付けられます。
* 検索条件でログを取得する場合の`1,000`件のレコード制限とは対照的に、ページネーションは無制限であり、制限はありません。

#### ページネーション

チェックポイントでログを取得する場合は、最初の要求のみを手動で行って
ください。後続の各要求は、`Link`ヘッダー内の`next`関係URLを使用して
行う必要があります。これにより、APIとの統合作業が簡素化され、Auth0は
顧客エクスペリエンスに影響を与えることなく最適化を行うことができます。

#### 例

`us`のテナント名が`acme`であると仮定します。チェックポイントでレコードを取得し始めるには：

1. システム内の任意のログから`log_id`を取得します。
   例：`90020211201185132572079310688835925971249535794074878050`
2. 指定された`LOG_ID`よりも新しい次の`100`個のログを要求するには、`https://TENANT_NAME.LOCALITY.auth0.com/api/v2/logs?from=LOG_ID&take=100` に要求を送信します。
3. HTTP応答には次が含まれます。

   1. 指定された`LOG_ID`より新しい`0`〜`100`個のログのJSON配列
   2. `next`関係を持つHTTP`Link`ヘッダー
4. 結果セットが空の場合は空の配列が返され、`next`関係は最新の要求で使用したのと同じURLと一致します。

## 検索条件でログを取得する

このメソッドを使用すると、指定された検索条件に一致するログイベントを取得できます。条件が使用されない場合は、すべてのイベントが一覧表示されます。条件で検索するには、次のパラメーターを使用します。

<table class="table"><thead>
<tr>
<th>パラメーター</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>`q`</td>
<td>クエリ文字列構文を使用した検索条件です。</td>
</tr>
<tr>
<td>`page`</td>
<td>0から始まるページ番号です。</td>
</tr>
<tr>
<td>`per_page`</td>
<td>1ページあたりのエントリ数です。</td>
</tr>
<tr>
<td>`sort`</td>
<td>並べ替えに使用するフィールドです。`field:order`を使用して、`order`に昇順の場合は`1`、降順の場合は`-1`を指定します。例：`date:-1`</td>
</tr>
<tr>
<td>`fields`</td>
<td>結果に含めるまたは除外する（`include_fields`で指定）フィールドのカンマ区切りのリストです。すべてのフィールドを取得するには、空のままにします。</td>
</tr>
<tr>
<td>`include_fields`</td>
<td>指定したフィールドを含めるには`true`、除外するには`false`を指定します。デフォルトは`true`です。</td>
</tr>
</tbody>
</table>

検索クエリで使用できるフィールドと並べ替えパラメーターのリストを確認するには、「[ログ検索クエリ構文](/ja-jp/deploy-monitor/logs/log-search-query-syntax)」をお読みください。

## 制限事項

ログを取得する要求ごとに100件のログイベントという制限に加え、最大1,000件の検索結果までしかページ分割できません。

`414 Request-URI Too Large`エラーが発生した場合、クエリ文字列がサポートされている長さよりも大きいことを意味します。その場合には、検索を絞り込みます。

<Card title="プライベートクラウドの検索フィールドの制限">

次のフィールドはプライベートクラウドでのみ検索できます。

* `user`
* `connection`
* `application`
* `type`
* `ip`

完全一致検索にはダブルクォーテーションを使用します（例：「 `application:"test"`」では「 `test`」という名前のアプリケーションに特定してログイベントがすべて検索されますが、「`application:test` 」では名前の一部が「test」のアプリケーションに関するログイベントが検索されます）。

</Card>

## もっと詳しく

* [ログイベントタイプのコード](/ja-jp/deploy-monitor/logs/log-event-type-codes)
* [ログ検索のクエリ構文](/ja-jp/deploy-monitor/logs/log-search-query-syntax)
* [ログデータの保持](/ja-jp/deploy-monitor/logs/log-data-retention)