---
title: "Microsoft Entra ID SAML接続のインバウンドSCIM"
permalink: "inbound-scim-for-azure-ad-saml-connections"
'description': "SAML SCIM経由のEntra ID接続セットアップの手順"
'og:title': "Microsoft Entra ID SAML接続のインバウンドSCIM"
'og:description': "SAML SCIM経由のEntra ID接続セットアップの手順"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Microsoft Entra ID SAML接続のインバウンドSCIM"
'twitter:description': "SAML SCIM経由のEntra ID接続セットアップの手順"
---

<Card title="始める前に">

この機能を使用するには、Auth0プランまたはカスタム契約にエンタープライズ接続が含まれている必要があります。詳細については、「[Auth0の価格設定](https://auth0.com/pricing)」ページを参照してください。

インバウンドSCIM接続をテストするには、[Postman](https://www.postman.com/downloads/)がローカルにインストールされている必要があります。

</Card>

このセクションでは、Microsoft Entra ID（旧Microsoft Azure Active Directory）で非ギャラリーエンタープライズアプリケーションを構成する方法を説明します。これは、ユーザーをAuth0 SCIMエンドポイントにプロビジョニングするために使用できます。

### Auth0でSCIM設定を構成する

1. [Auth0 Dashboard](https://manage.auth0.com/#/)を開いて、 **［Authentication（認証）］>［Enterprise（エンタープライズ）］>［SAML］> [あなたの接続] >［Settings（設定）］** に移動します。
2. [ログイン時に追加属性を同期](/ja-jp/authenticate/protocols/scim/configure-inbound-scim)したい場合を除き、 **［Authentication（認証）］>［Enterprise（エンタープライズ）］>［SAML］> [あなたの接続] >［Provisioning（プロビジョニング）］** に進んで、 **［Sync user profile attributes at each login（ログインの度にユーザープロファイル属性を同期する）］** を無効にします。
3. 同じセクションで、 **［Sync user profiles using SCIM（SCIMを使ってユーザープロファイルを同期する）］** を有効にします。
4. **［Mapping（マッピング）］** タブで、 **［SCIM attribute containing the User ID（ユーザーIDを含むSCIM属性）］** 設定が **［userName］** になっていることを確認します。
5. **［Additional Mappings（追加マッピング）］** 領域に移動して、以下を：

```json lines
{
		"scim": "emails[primary eq true].value",
		"auth0": "email"
	   },
```

以下に置き換えます。

```json lines
{
		"scim": "emails[type eq \"work\"].value",
		"auth0": "email"
	   },
```

6.その他の **［Additional Mappings（追加マッピング）］** を確認して、SCIMの拡張属性が希望するAuth0属性にマッピングされていることを確かめます。詳しくは、「[属性マッピング](/ja-jp/authenticate/protocols/scim/configure-inbound-scim#attribute-mapping)」をご覧ください。

7. **［Save Changes（変更を保存）］** を選択します。

### SCIMエンドポイントURLとトークンを取得する

Microsoft Entra IDテナントでSCIMを構成するには、Auth0からのSCIMエンドポイントURLとトークンが必要です。これらの値は、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=auth0-dashboard" tip="Auth0 Dashboard: サービスを構成するためのAuth0の主製品。" cta="用語集の表示">Auth0 Dashboard</Tooltip>経由で手動で取得することも、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>経由でプログラム的に取得することもできます。ベストプラクティスは、「[導入のガイドライン](/ja-jp/authenticate/protocols/scim/configure-inbound-scim#deployment-guidelines)」セクションをご覧ください。Dashboardを使って以下を行います。

1. Auth0 Dashboardで、SCIMの **［Setup（セットアップ）］** タブを参照し、 **SCIMエンドポイントURL** をコピーして、安全な場所に貼り付けます。
2. **［Generate New Token（新しいトークンを生成）］** を選択してSCIMトークンを生成してから、必要な場合にはトークンの有効期限を設定します。
3. Microsoft Entra IDに付与したいスコープを選択します。デフォルトでは、Microsoft Entra IDによって使用されるスコープには`get:users`、`post:users`、`patch:users`、および`delete:users`が必要です。

### SAMLアプリ用にEntra IDでSCIMを構成する

1. SAMLアプリケーションがまだ登録されていない場合は、[こちらの手順に沿って](https://community.auth0.com/t/setting-up-azure-ad-as-saml-enterprise-connection/87829)、Microsoft Entra IDテナントでカスタムの **非ギャラリーエンタープライズアプリケーション** を登録します。
2. **［Manage（管理）］>［Properties（プロパティ）］** タブに移動して、 **［Assignment Required（割り当て必須）］** が **［Yes（はい）］** に設定されていることを確認します。
3. **［Manage（管理）］>［Users and Groups（ユーザーとグループ）］** タブに移動して、プロビジョニングしたいMicrosoft Entra IDユーザーを割り当てます。グループを割り当てると、そのグループのユーザーがプロビジョニングされます。
4. **［Manage（管理）］>［Provisioning（プロビジョニング）］** タブを選択し、 **［Get started（はじめる）］** を選んでから、 **［Provisioning Mode（プロビジョニングモード）］** として **［Automatic（自動）］** を選択します。
5. **［Admin Credentials（管理者の資格情報）］** を選び、 **［Tenant URL（テナントURL）］** として先に保存した **［SCIM Endpoint URL（SCIMエンドポイントURL）］** の値を入力します。[こちらで説明されている既知の問題](https://learn.microsoft.com/en-us/azure/active-directory/app-provisioning/application-provisioning-config-problem-scim-compatibility)を修正するために、URLの末尾に`?aadOptscim062020`
6. トークン値を **［Secret Token（シークレットトークン）］** フィールドに貼り付けて、 **［Save（保存）］**
7. **［Mappings（マッピング）］** に移動して、 **［Provision Microsoft Entra ID Users（Microsoft Entra IDユーザーのプロビジョニング）］** を選んでから、 **［Attribute Mappings（属性マッピング）］** に進み、`emails[type eq "work"].value`と`mail`を含む行を選択します。
8. **［Edit Attribute（属性の編集）］** 画面で、 **［Match objects using this attribute（この属性を使用してオブジェクトを一致させる）］** を **［Yes（はい）］** にし、 **［Matching precedence（一致の優先度）］** を **［2］** に設定して、 **［OK］** を選択します。

<Frame>![SAML Azure Attribute Mapping](/images/ja-jp/cdy7uua7fh8z/6JnGm4IeBglKiHNoVPX5vs/ddc17baeca48f02a6309b57ab87f845e/attributemap2.jpg)</Frame>

**［Save（保存）］** を選択して属性マッピングを保存してから、右上の **［X］** を選択して **［Provisioning（プロビジョニング）］** 画面に戻ります。

#### テストを行う

1. エンタープライズアプリケーションの概要画面で、 **［Manage（管理）］>［Provisioning（プロビジョニング）］** の次に **［Provision on Demand（オンデマンドのプロビジョニング）］** を選択してSCIM接続をテストします。
2. **［Select a user or group（ユーザーまたはグループを選択）］** に移動して、アプリケーションに割り当てたユーザーの名前を入力してから、そのユーザーを選択し、 **［Provision（プロビジョニング）］** を選びます。これで、Auth0テナントにユーザーが作成されます。
3. 割り当て済みの全ユーザーを[こちらの手順に沿って](https://learn.microsoft.com/en-us/entra/identity/app-provisioning/configure-automatic-user-provisioning-portal#provisioning-status)プロビジョニングし、 **［Provisioning Status（プロビジョニングステータス）］** を **［On（オン）］** にします。