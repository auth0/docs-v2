---
title: "SMSでのパスワードレス認証"
permalink: "sms-otp"
'description': "SMS認証方式でパスワードレス接続を使用する方法を説明します。"
'og:title': "SMSでのパスワードレス認証"
'og:description': "SMS認証方式でパスワードレス接続を使用する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "SMSでのパスワードレス認証"
'twitter:description': "SMS認証方式でパスワードレス接続を使用する方法を説明します。"
---

パスワードレス接続を構成して、SMS経由でユーザーにワンタイムパスワード（OTP）を送信し、認証を完了できます。

詳細については、「[パスワードレス認証にメールまたはSMSを構成する](/ja-jp/authenticate/login/auth0-universal-login/passwordless-login/email-or-sms)」をお読みください。

Auth0は、[Twilio](https://www.twilio.com)とカスタムSMSゲートウェイを使用したOTPの送信をサポートしています。カスタムSMSゲートウェイを使用する場合は、「[パスワードレス接続用にカスタムSMSゲートウェイを設定する](/ja-jp/authenticate/passwordless/authentication-methods/use-sms-gateway-passwordless)」をお読みください。

## 仕組み

新しいユーザーがコードを受け取り、アプリケーションで初めて入力すると、Auth0によって認証される前に、`sms`接続でユーザープロファイルが作成されます。

OTPが送信された電話番号が既存のユーザーと一致する場合、Auth0はユーザーを認証します。

### 埋め込みログイン

<Frame>![SMS workflow for passwordless authentication](/images/ja-jp/cdy7uua7fh8z/7A1AOmvvAQXheVt9swOtqM/126d50fff7ae6c960e0c15942a7b937e/Embedded-login.png)</Frame>

### ユニバーサルログイン

<Frame>![Passwordless sms workflow diagram with universal login](/images/ja-jp/cdy7uua7fh8z/5EmFoTLgH2ByPcFYdsQvXA/473a0da6aee711f0dcf07cd10d74cd1f/Unvirsal-login.png)</Frame>

### カスタムSMSゲートウェイ

埋め込みログインまたはユニバーサルログイン用にカスタムSMSゲートウェイを構成することもできます。

<Frame>![Custom SMS gateway workflow for passwordless authentication](/images/ja-jp/cdy7uua7fh8z/62Mv7Bg2pvrHvr6GBEOjyK/0be7b3f266a115bd75696f8fe4a63ca9/Screenshot_2024-12-20_at_15.10.08.png)</Frame>

## 接続を構成する

1. Auth0 Dashboardで、[[Authentication（認証）]>[Passwordless（パスワードレス）]](https://manage.auth0.com/#/connections/passwordless)に移動し、 **[SMS]** トグルを有効にします。
2. **[SMS]** を選択して構成ウィンドウを開きます。

### Twilio設定を構成する

[TwilioアカウントSID](https://www.twilio.com/docs/glossary/what-is-a-sid)と[Twilio認証トークン](https://www.twilio.com/help/faq/twilio-basics/what-is-the-auth-token-and-how-can-i-change-it)が必要になります。これらは、Auth0がユーザーにSMSを送信するために使用するTwilio API資格情報です。

1. **TwilioアカウントSID** と **Twilio認証トークンを入力します。**

   <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

   Twilio SIDとAuthトークンを確認する方法については、Twilioドキュメントの「[How to create an Application SID（アプリケーションSIDの作成方法）](https://www.twilio.com/help/faq/twilio-basics/what-is-an-application-sid)」と「[Auth Tokens and how to change them（Authトークンとその変更方法）](https://www.twilio.com/help/faq/twilio-basics/what-is-the-auth-token-and-how-can-i-change-it)」を参照してください。

   </Callout>

2. **SMSソース** を選択し、 **TwilioメッセージングサービスSID** または **送信元** 電話番号を入力します。ユーザーには、SMSの送信者として入力したものが表示されます。

   <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

   Twilioのメッセージングサービスについては、Twilioドキュメントの「[Messaging Services（メッセージングサービス）](https://www.twilio.com/docs/messaging/services)」を参照してください。

   </Callout>

### カスタムSMSゲートウェイを構成する

独自のSMSゲートウェイを使用する場合は、パスワードレス接続を作成し、Auth0 <Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>を使用して変更する必要があります。詳細については、「[パスワードレス接続用にカスタムSMSゲートウェイを設定する](/ja-jp/authenticate/passwordless/authentication-methods/use-sms-gateway-passwordless)」をお読みください。

### パスワードレスSMS設定を構成する

1. **メッセージ** に、SMSの本文を入力します。

   <Callout icon="file-lines" color="#0EA5E9" iconType="regular">

   `@@password@@` placeholderは、ユーザーに送信されたワンタイムパスワードで自動的に置換されます。

   </Callout>

2. **OTPの有効期限** と **OTPの長さ** の設定を調整します。

   * 最後に発行されたワンタイムパスワード（またはリンク）のみが受け入れられます。最新のパスワードが発行されると、他のパスワードは無効になります。最新のパスワードも、一度使用すると無効になります。
   * ワンタイムパスワードの入力は、3回しか試行できません。その後は、新しいコードを要求する必要があります。
   * 発行されたワンタイムパスワードは、期限が切れるまで（デフォルトでは）3分間有効です。
   * ワンタイムパスワードの有効期限を延長する場合は、ワンタイムパスワードコードの長さも延長する必要があります。そうしないと、攻撃者が短いコードを推測しようとする時間が長くなります。
3. **サインアップを無効にする** かどうかを決定します。この設定を有効にすると、既存のユーザーのみにパスワードレスアクセスを許可できますが、アプリケーションがユーザー列挙攻撃の脅威にさらされる可能性があります。詳細については、「[パスワードレス接続のベストプラクティス](/ja-jp/authenticate/passwordless/best-practices)」をお読みください。
4. **［Save（保存）］** を選択します。

#### 多言語サポート

**メッセージ** 領域は複数の言語をサポートしています。

言語を指定するには、[Auth0 Authentication API Get CodeまたはLinkエンドポイント](https://auth0.com/docs/api/authentication#get-code-or-link)を呼び出して、`x-request-language`ヘッダーの値を設定します。このヘッダーが設定されていない場合、言語はブラウザによって自動的に設定される`accept-language`ヘッダーから抽出されます。

#### メッセージ構文

**メッセージ** 領域はLiquid構文を受け入れます。この構文をパラメーター値と組み合わせて使用​​して、プログラムでメッセージの要素を構築できます。

たとえば、`request_language`パラメーターを参照してメッセージの言語を変更できます。

```liquid lines
{% if request_language contains 'dutch' %}
   Hier is uw verificatie code: {{ password }}
{% endif %}
{% if request_language contains 'fr-FR' %}
   Ceci est votre code: {{ password }}
{% endif %}
```

メッセージテンプレートを定義するときに使用できるパラメーターは次のとおりです。

<table class="table"><thead>
<tr>
<th><b>パラメーター</b></th>
<th><b>説明</b></th>
</tr>
</thead>
<tbody>
<tr>
<td>`password`または`code`</td>
<td>使用するパスワード。</td>
</tr>
<tr>
<td>`phone_number`</td>
<td>ユーザーの電話番号。</td>
</tr>
<tr>
<td>`application.name`</td>
<td>ユーザーがサインアップしているアプリケーションの名前。</td>
</tr>
<tr>
<td>`request_language`</td>
<td>メッセージの内容で要求されている言語。</td>
</tr>
</tbody>
</table>

Liquidの使用について詳しくは、[「Liquid for Designers on GitHub」](https://github.com/Shopify/liquid/wiki/Liquid-for-Designers)をご覧ください。

### アプリケーションを有効にする

**アプリケーション** ビューに切り替えて、パスワードなしの SMS を使用するアプリケーションを有効にします。

## もっと詳しく

* [Auth0's Unified Phone Experience](/ja-jp/customize/phone-messages/unified-phone)
* [Use the Unified Phone Experience for Passwordless](/ja-jp/customize/phone-messages/unified-phone/unified-phone-experience-passwordless)
* [Configure Auth0 Unified Phone Experience](/ja-jp/customize/phone-messages/unified-phone/configure-unified-phone)