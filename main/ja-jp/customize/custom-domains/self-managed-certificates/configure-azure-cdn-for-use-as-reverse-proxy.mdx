---
title: "Azure CDNをリバースプロキシとして構成する"
permalink: "configure-azure-cdn-for-use-as-reverse-proxy"
'description': "Auth0のカスタムドメインプロキシとしてAzure CDNをセットアップする方法について説明します。"
'og:title': "Azure CDNをリバースプロキシとして構成する"
'og:description': "Auth0のカスタムドメインプロキシとしてAzure CDNをセットアップする方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Azure CDNをリバースプロキシとして構成する"
'twitter:description': "Auth0のカスタムドメインプロキシとしてAzure CDNをセットアップする方法について説明します。"
---

<Card title="利用可能性はAuth0プランによって異なる">

この機能が利用できるかどうかは、ご利用のAuth0プラン（または契約）によります。詳細については、「[価格設定](https://auth0.com/pricing)」をお読みください。

</Card>

Azure CDNをリバースプロキシとしてセットアップするには、Azure CDN Premiumプランが必要です。

1. [自己管理証明書を使ってカスタムドメインを構成する](/ja-jp/customize/custom-domains/self-managed-certificates)作業がまだ済んでいない場合は、ここで行います。 **［Origin Domain Name（オリジンのドメイン名）］** と **cname-api-key** の値が後で必要になるのでメモしておきます。
2. [Azureポータル](https://portal.azure.com/)にログインします。
3. [Azure CDNプロファイルを新規作成](https://docs.microsoft.com/en-us/azure/cdn/cdn-create-new-endpoint#create-a-new-cdn-profile)します。
4. 作成したばかりのCDNプロファイルを使用して、[Azure CDNエンドポイントを新規作成](https://docs.microsoft.com/en-us/azure/cdn/cdn-create-new-endpoint#create-a-new-cdn-endpoint)します。CDNエンドポイントの設定には、Auth0 Dashboardから取得した **［Origin Domain Name（オリジンのドメイン名）］** を入力します。
5. [カスタムドメインをAzure CDNエンドポイントに追加](https://docs.microsoft.com/en-us/azure/cdn/cdn-map-content-to-custom-domain)します。
6. [Azure CDNのカスタムドメインにHTTPSを構成](https://docs.microsoft.com/en-us/azure/cdn/cdn-custom-ssl?tabs=option-1-default-enable-https-with-a-cdn-managed-certificate)します。このプロセスでは、ドメインの所有権を確認する必要があります。完了してから、証明書がすべてのCDNのPoPのロケーションに導入されるまでに、最大6時間かかる場合があります。
7. Azure CDNのルールエンジンを使用して、Auth0とのカスタムドメイン通信の設定を行います（詳細については、Microsoftドキュメントの「[Azure CDN from Verizon Premiumルールエンジンを使用してHTTP動作をオーバーライドする](https://docs.microsoft.com/en-us/azure/cdn/cdn-verizon-premium-rules-engine)」を参照してください）。以下の設定で[新しいAzure CDNルールを作成](https://docs.microsoft.com/en-us/azure/cdn/cdn-verizon-premium-rules-engine#tutorial)します。

   <table class="table"><thead>
   <tr>
   <th>設定</th>
   <th>値</th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td>Name/Description（名前/説明）</td>
   <td>Auth0カスタムドメイン</td>
   </tr>
   <tr>
   <td>Type of requests（要求のタイプ）</td>
   <td> **［Edge CName］** を選択して、リストからカスタムドメイン名を選択する。</td>
   </tr>
   </tbody>
   </table>
8. 以下の **機能** をAzure CDNルールに追加します。
  **azureedge.net** のCNAMEの使用を拒否する別のAzure CDNルールを作成することをお勧めします。

   <table class="table"><thead>
   <tr>
   <th>設定</th>
   <th>値</th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td>Bypass Cache（キャッシュのバイパス）</td>
   <td><b>Enabled（有効）</b></td>
   </tr>
   <tr>
   <td>クライアント要求ヘッダーの変更</td>
   <td> **［Override（オーバーライド）］** を選択し、名前に「<b>cname-api-key</b>」を入力して、Auth0から提供されたCNAME APIキーを値として入力します。</td>
   </tr>
   </tbody>
   </table>
9. Azure CDNルールが承認されると、ステータスが［Pending XML（保留中のXML）］から［Active XML（アクティブなXML）］に変更されます。この時点で、Azure CDNはルールと証明書を公開します。Azureでのすべての変更の処理が完了すると、カスタムドメインを使用できるようになります。

## もっと詳しく

* [機能にカスタムドメインの使用を構成する](/ja-jp/customize/custom-domains/configure-features-to-use-custom-domains)
* [カスタムドメインのトラブルシューティング](/ja-jp/troubleshoot/integration-extensibility-issues/troubleshoot-custom-domains)
* [TLS（SSL）のバージョンと暗号](/ja-jp/customize/custom-domains/self-managed-certificates/tls-ssl)