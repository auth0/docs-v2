---
title: "カスタムドメインのトラブルシューティング"
permalink: "troubleshoot-custom-domains"
'description': "カスタムドメインに関する問題のトラブルシューティングについて説明します。"
'og:title': "カスタムドメインのトラブルシューティング"
'og:description': "カスタムドメインに関する問題のトラブルシューティングについて説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "カスタムドメインのトラブルシューティング"
'twitter:description': "カスタムドメインに関する問題のトラブルシューティングについて説明します。"
---

カスタムドメインに関する一般的な問題については次のビデオをご覧ください。また、特定のシナリオのトラブルシューティング手順については、以下のセクションを参照してください。

<iframe width="100%" height="316" src="https://www.youtube.com/embed/f6fkOkS1RFA" title="Custom Domain Issues" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## カスタムドメインが検証待ちのままである

DNSが伝播するまでに最大48時間かかる場合があります。

* ダッシュボードにこのエラーが引き続き表示される場合は、ドメイン管理サービスでCNAMEレコードが正しく設定されていることを確認してください。CNAMEレコードの設定は、次の方法で確認できます：

  + [Mxtoolbox](https://mxtoolbox.com/DNSLookup.aspx)または[Google](https://dns.google.com)
  + ターミナルでの`dig`コマンド
* ドメイン名がAレコードにまだ関連付けられていないことを確認します。
* CNAMEレコードのドメイン名または値を入力またはコピーするときにエラーが発生していないことを確認します。

上記のことを確認してもカスタムドメインの検証がまだ保留中の場合は、ドメインを再検証する前に4時間待ってください。サービスの中断を避けるため、再検証時にカスタムドメインを再作成しないでください。

## CloudflareでのCNAMEフラット化

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Auth0では、絶対に必要な場合を除き、CNAMEフラット化をオフにすることを推奨しています。Cloudflareのドキュメント、「[Understand and configure CNAME flattening（CNAMEフラット化を理解・構成する）](https://support.cloudflare.com/hc/en-us/articles/200169056-Understand-and-configure-CNAME-Flattening)」に従ってください。Auth0のマネージド証明書に対するCNAMEフラット化は、サポートされない構成であるため、CNAMEフラット化が有効になっているとカスタムドメインが予告なく壊れてしまう可能性があります。

</Callout>

CNAMEフラット化は、DNSレコードの処理方法により、Auth0の検証および証明書の更新プロセスに影響します。カスタムドメインを設定した後、CloudfareでCNAMEフラット化を有効にしても、証明書の更新は **not prevent（妨げられません）］** 。

Cloudflareで管理しているすべてのサブドメインに対してCNAMEフラット化を有効にし、特定のサブドメインをAuth0のカスタムドメインとして構成する必要がある場合は、Auth0用のサブドメインを別のDNSプロバイダーに委任することを検討してください。詳細については、Cloudflareドキュメントの[「Cloudflareの外部にサブドメインを委任」](https://support.cloudflare.com/hc/en-us/articles/360021357131-Delegating-Subdomains-Outside-of-Cloudflare)を参照してください。外部に委任すると、Auth0用のサブドメインを除くすべてのサブドメインでCNAMEフラット化を使用できるようになります。

## 「このエンドポイントに到達しないでください」

カスタムドメインを構成するときにこのエラーが表示された場合は、セットアップに応じて異なる追加の構成を実行する必要があります。詳しくは、[カスタムドメインを使用するための機能を構成する](/ja-jp/customize/custom-domains/configure-features-to-use-custom-domains)をお読みください。

## 「サービスが見つかりません」

アプリケーションが、`audience=https://login.northwind.com/userinfo`を指定して`/authorize`要求を発行すると、サーバーは`Service not found:https://login.northwind.com/userinfo`エラーを返します。これは、カスタムドメインを設定しても、`/userinfo`エンドポイントのAPI識別子が`https://{yourOriginalAuth0Domain}/userinfo`のままになるためです。

同様に、[Auth0 Management API](/ja-jp/api/management/v2)の呼び出しでカスタムドメインを使用すると、同じ理由でエラーが発生します。

これを修正するには、アプリで代わりに`audience=https://{yourOriginalAuth0Domain}/userinfo`を使用する必要があります。アプリケーションの **Advanced Settings（詳細設定）］** の **OAuth2］** タブでアプリケーションが **OIDC-Conformant（OIDC準拠）］** としてフラグ付けされている場合は、この`audience=[...]/userinfo`パラメータを完全に削除することもできます。

## Internet Explorerに関連するエラー

Internet Explorerを使用している場合は、次のいずれかのエラーメッセージが表示されることがあります：

* 「クライアントから検証が返されませんでした」
* 「Originヘッダーが必要です」
* 「クロスオリジン認証に失敗しました」

Auth0ドメインとアプリドメインの両方が同じ信頼済みゾーンまたはローカルイントラネットゾーンにある場合、Internet Explorerは要求をクロスドメイン要求として扱わず、クロスオリジンヘッダーを送信しません。

これらのエラーのいずれかが表示され、埋め込みログインを使用している場合は、サイトの1つを信頼済みゾーンまたはローカルイントラネットゾーンから移動することができます。このためには、次の手順に従います。

1. **Internet Options>Security** へ移動します。
2. **［Local Intranet Zone（ローカル イントラネット ゾーン）］** タブを選択し、Sites>Advancedに移動します。ドメインを追加します。
3. **［Security（セキュリティ）］** タブに戻り、適切なゾーンが選択されていることを確認します。
4. **［Custom Level（レベルのカスタマイズ）］** をクリックし、**Miscellaneous（その他）］** セクションで **Access data sources across domains（ドメイン間のアクセス データ ソース）］** を探します。**Enable（有効化）］** の横にあるラジオボタンをクリックします。

あるいは、[Auth0 ユニバーサルログイン](/ja-jp/authenticate/login/auth0-universal-login)を実装することで、クロスオリジン認証への依存を排除​​することもできます。

## もっと詳しく

* [機能にカスタムドメインの使用を構成する](/ja-jp/customize/custom-domains/configure-features-to-use-custom-domains)
* [Auth0管理証明書を使ってカスタムドメインを構成する](/ja-jp/customize/custom-domains/auth0-managed-certificates)
* [自己管理証明書を使ってカスタムドメインを構成する](/ja-jp/customize/custom-domains/self-managed-certificates)
* [TLS（SSL）のバージョンと暗号](/ja-jp/customize/custom-domains/self-managed-certificates/tls-ssl)