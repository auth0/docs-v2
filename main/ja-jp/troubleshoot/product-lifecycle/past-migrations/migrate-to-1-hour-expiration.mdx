---
title: "1時間のログインフローの有効期限への移行"
permalink: "migrate-to-1-hour-expiration"
'description': "インタラクティブログインフローの1時間の有効期限を有効にする方法について説明します。"
'og:title': "1時間のログインフローの有効期限への移行"
'og:description': "インタラクティブログインフローの1時間の有効期限を有効にする方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "1時間のログインフローの有効期限への移行"
'twitter:description': "インタラクティブログインフローの1時間の有効期限を有効にする方法について説明します。"
---

2024年2月21日より、Auth0のリダイレクションベースのログインフローの最長有効期間が1時間になりました。完了までに1時間を超えるログインフローは、ユニバーサルログインとクラシックログインの両方で、期限切れになります。

## 影響するログインフロー

Auth0では現在、次のインタラクティブログインフローが完了するまでに最大3日間かかることを許可しています。

* [認可コードフロー](/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow)
* [PKCEを使った認可コードフロー](/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow-with-pkce)
* [クロスオリジン認証](/ja-jp/authenticate/login/cross-origin-authentication)
* [デバイス認可フロー](/ja-jp/get-started/authentication-and-authorization-flow/device-authorization-flow)
* [ハイブリッドフロー](/ja-jp/get-started/authentication-and-authorization-flow/hybrid-flow)
* [フォームPOSTを使った暗黙フロー](/ja-jp/get-started/authentication-and-authorization-flow/implicit-flow-with-form-post)
* [Security Assertion Markup Language（SAML）](/ja-jp/authenticate/protocols/saml)
* [Web Services Federationプロトコル（WS-Fed）](/ja-jp/authenticate/protocols/ws-fed-protocol)

2024年2月21日より、Auth0のリストアップされている認可フローの最長有効期間が1時間になりました。トランザクションは1時間後に有効期限切れになります。有効期限が切れると、メールやパスワードの入力、[Auth0アクション](/ja-jp/customize/actions)へのリダイレクトなど、エンドユーザーのブラウザからの操作は次のようになります。

* 紐づけられたアプリケーションのデフォルトのログインルートにリダイレクトされ、新しいログイントランザクションとしてフローが再開される
  または
* アプリケーションのデフォルトのログインルートを設定していない場合、またはクラシックログインを使用している場合は、エラーページを表示する。エンドユーザーは、ログイントランザクションを再開するためにアプリケーションに戻る必要があります。このエラーページは、ユニバーサルログインを使ってカスタマイズできます。

## アクション

[ログアウト後にユーザーをリダイレクトする](/ja-jp/customize/actions/explore-triggers/signup-and-login-triggers/login-trigger/redirect-with-actions)場合は、ユニバーサルログイン`/authorize`エンドポイントに直接リダイレクトするのではなく、ユーザーのアクション（ログインボタンをクリックするなど）に基づいてユーザーが再度ログインできるようにするアプリケーションのページにリダイレクトします。ユーザーが明示的に開始したアクションなしに新しいログイントランザクションを開始するパターンは、新しいログイン試行がブラウザーウィンドウに放置され、悪意のある攻撃を受ける可能性があるため、トランザクションの完了に時間がかかりすぎる主な原因です。

ユニバーサルログインを使用している場合：

* <Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=auth0-dashboard" tip="Auth0 Dashboard: サービスを構成するためのAuth0の主製品。" cta="用語集の表示">Auth0 Dashboard</Tooltip>たはAuth0 <Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>経由でアプリケーションの[デフォルトのログインルートを設定する](https://auth0.com/docs/authenticate/login/auth0-universal-login/configure-default-login-routes)ことをお勧めします。この方法では、ログイントランザクションが自動的に開始され、トランザクションの有効期限が切れるとアクティブなエンドユーザーのログインフローがシームレスに再開されるため、最高のユーザーエクスペリエンスが実現します。
* 設定でデフォルトのログインルートが許可されていない場合は、より良いユーザーエクスペリエンスを提供するために[Auth0エラーページをカスタマイズする](https://auth0.com/docs/customize/universal-login-pages/custom-error-pages)ことをお勧めします。エラーページを使用して、ユーザーにアプリケーションに戻ってログイン試行を再開するように指示できます。
* 上記のどちらも行わない場合は、[デフォルトのAuth0エラーページ](https://auth0.com/docs/authenticate/login/auth0-universal-login/error-pages)が表示されます。

<Frame>![](/images/ja-jp/cdy7uua7fh8z/7ET2UOsS5DtySCwFP86Ao9/4bbb7e702df15feaaadb3301cd7e29eb/2023-08-01_12-37-25.png)</Frame>

クラシックログインを使用している場合、ログインウィジェットにエラーが表示され、ユーザーはアプリケーションに戻って、期限切れのトランザクションのログインを再試行する必要があります。

## テナントログをレビューする

テナント内で影響を受けるトランザクションとアプリケーションの数についてさらに詳しく知りたい場合は、[［Auth0 Dashboard（Auth0ダッシュボード）］>［Monitoring（モニタリング）］>［Logs（ログ）］](https://manage.auth0.com/#/monitoring/logs)でログを確認してください。次の検索で`廃止通知`ログを探します。`type:depnote AND description:*Long*state*expirations*`。これらの結果は、1時間以上継続するログイントランザクションとアプリケーション（`client_id`など）を示します。

これらのログはレート制限されており、`client_id`ごとに1時間で1つ表示されることに注意してください。

## 移行を確認する

デフォルトのログインルートを設定するか、エンドユーザー向けの具体的な指示でAuth0エラーページを更新した後、2024年2月21日より前にいつでも1時間の有効期限を有効（無効）にして、ログイン動作を確認することができます。

1. [［Auth0 Dashboard（Auth0ダッシュボード）］>［Tenant Settings（テナント設定）］>［Advanced（詳細）］](https://manage.auth0.com/#/tenant/advanced)に移動して、移行セクションを検索します。
2. **［Long state expirations（長い状態の有効期限）］** のトグルをオフにします。この設定を無効にすると、トランザクションは1時間のみに制限されます。この設定を有効にすると、トランザクションは最大3日間まで許容されます。