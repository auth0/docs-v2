---
title: "Unbounceのランディングページでユーザー情報を取得する"
permalink: "get-user-information-on-unbounce-landing-pages"
'description': "Unbounceのランディングページでワンクリックのソーシャル認証を使用してユーザー情報を取得する方法について説明します。"
'og:title': "Unbounceのランディングページでユーザー情報を取得する"
'og:description': "Unbounceのランディングページでワンクリックのソーシャル認証を使用してユーザー情報を取得する方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Unbounceのランディングページでユーザー情報を取得する"
'twitter:description': "Unbounceのランディングページでワンクリックのソーシャル認証を使用してユーザー情報を取得する方法について説明します。"
---

## Auth0の構成

1. Auth0アカウントを作成して、[Dashboard](https://manage.auth0.com/#)に移動します。
2. [［Dashboard］>［Applications（アプリケーション）］](https://manage.auth0.com/#/applications)に移動して、**［+ Create Application（アプリケーションの作成）］** をクリックします。`［Single-Page Application（シングルページアプリケーション）］`オプションを選択して、**［Settings（設定）］** に移動します。**クライアントID** と **ドメイン** をメモします。
3. `コールバックURL`を **［Allowed Callback URLs（許可されているCallback URL）］** と **［Allowed Origins (CORS)（許可されているオリジン（CORS））］** の方法に追加します。それをUnbounceページのURLにします。例：`http://unbouncepages.com/changeit`.
4. [［Dashboard］>［Authentication（認証）］>［Social（ソーシャル）］](https://manage.auth0.com/#/connections/social)に移動して、対応したいソーシャルプロバイダーを有効にします。

## Unbounceの構成

1. プロバイダーでのログインをトリガーするボタンなどのUI要素を作成します。**［Properties（プロパティ）］>［Element Metadata（要素のメタデータ）］** にあるUI要素のIDをメモします。
2. 新しいJavaScriptをUnbounceのランディングページに追加して、［`Placement`（配置）］に［`Before Body End Tag`（ボディの終了タグの前）］を選択し、以下のコードを追加します。また、依存関係として［jQuery］を選択します。

```html lines
<script src="https://cdn.auth0.com/js/auth0/9.11/auth0.min.js"></script>
<script type="application/javascript">
  var webAuth = new auth0.WebAuth({
    domain:       '{yourDomain}',
    clientID:     '{yourClientId}',
    audience: 'https://{yourClientId}/userinfo'
    redirectUri:  '{yourUnbouncePageUrl}', // e.g http://unbouncepages.com/changeit
    scope: 'openid profile email',
    responseType: 'token id_token',
  });
</script>
```

先ほど構成したアプリケーションのクライアントIDとドメインを使用します。

次に、ソーシャルプロバイダーからの情報をUnbounceに渡す方法が必要です。

1. フォームを作成して、それぞれのフィールドに`Hidden fields`（隠しフィールド）を追加します。たとえば、`name`や`email`のフィールドです。
2. UnbounceのJavaScriptエディターに戻ります。
3. ソーシャル認証をトリガーするボタンのそれぞれにクリックハンドラーを追加します。

   1. 前の手順でメモしたボタンIDと[接続名](/ja-jp/authenticate/identity-providers/locate-the-connection-id)を置き換えます。たとえば、Googleであれば`google-oauth2`、LinkedInであれば`linkedin`を使用します。
   2. IDは必ず正しく置換してください。`#name`や`#email`ではなく、フォームにあるそのフィールドのIDを入力します（フォームの編集中に［`Field Name and ID`（フィールド名とID）］の下に表示されます）。

```javascript lines
$('#{buttonId}').bind('click', function() { 
  webAuth.authorize({
    connection: '{yourConnectionName}'
  });
});

// After authentication occurs, the parseHash method parses a URL hash fragment to extract the result of an Auth0 authentication response.

webAuth.parseHash({ hash: window.location.hash }, function(err, authResult) { 
  if (err) { 
    return console.log(err); 
  }

  if (authResult != null && authResult.accessToken != null) {
    webAuth.client.userInfo(authResult.accessToken, function(err, user) {
      $('#name').val(user.name); 
      $('#email').val(user.email); 
    }); 
  } 

});
```

これで、ユーザーがフォームを送信すると、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-2" href="/ja-jp/glossary?term=idp" tip="IDプロバイダー（IdP）: デジタルIDを保存および管理するサービス。" cta="用語集の表示">IdP</Tooltip>からの情報をUnbounce Admin Panelの`Leads`セクションで確認できるようになりました。