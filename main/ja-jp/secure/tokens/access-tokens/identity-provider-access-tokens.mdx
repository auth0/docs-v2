---
title: "IDプロバイダーのアクセストークン"
permalink: "identity-provider-access-tokens"
'description': "ユーザーの認証後にIDプロバイダーが発行するサードパーティーのアクセストークンと、それらを使ってサードパーティーのAPIを呼び出す方法について理解します。"
'og:title': "IDプロバイダーのアクセストークン"
'og:description': "ユーザーの認証後にIDプロバイダーが発行するサードパーティーのアクセストークンと、それらを使ってサードパーティーのAPIを呼び出す方法について理解します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "IDプロバイダーのアクセストークン"
'twitter:description': "ユーザーの認証後にIDプロバイダーが発行するサードパーティーのアクセストークンと、それらを使ってサードパーティーのAPIを呼び出す方法について理解します。"
---

IDプロバイダーは、ユーザーを認証した後でサードパーティーのアクセストークンを発行します。このアクセストークンは、発行元のサードパーティープロバイダーのAPIを呼び出すのに使用することができます。たとえば、Facebookとのユーザー認証後に発行されたアクセストークンを使用して、Facebook Graph APIを呼び出すことができます。

個々のユーザーについては、IDプロバイダーのトークンは、特定の接続の要素の下の`user` オブジェクトの`identities`配列の中で利用できます。特定のユーザーのトークンに安全にアクセスするには、`read:user_idp_tokens`スコープを含む[Management APIのアクセストークン](/ja-jp/secure/tokens/access-tokens/management-api-access-tokens)が必要です。その後、[ユーザー取得エンドポイント](/ja-jp/api/management/v2/#!/Users/get_users_by_id)にHTTP GET呼び出しを行い、トークンを取得します。

<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-1" href="/ja-jp/glossary?term=oath2" tip="OAuth 2.0: 認可プロトコルとワークフローを定義する認可フレームワーク。" cta="用語集の表示">OAuth 2.0</Tooltip>の同意フローを使用したエンタープライズ接続セットアップの管理者ユーザーについては、IDプロバイダーのトークンは`connection`オブジェクトで利用できます。接続のトークンに安全にアクセスするには、`read:connections`スコープを含む[Management APIのアクセストークン](/ja-jp/secure/tokens/access-tokens/management-api-access-tokens)が必要です。その後、[接続取得エンドポイント](/ja-jp/api/management/v2/connections/get-connections-by-id)にHTTP GET呼び出しを行い、トークンを取得します。

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

サードパーティのアクセストークンの内容は、発行しているIDプロバイダーによって異なります。サードパーティ（FacebookやGitHubなど）が作成・管理するトークンであるため、有効期間は発行者によって異なります。これらのトークンが侵害されたと思われる場合は、発行したサードパーティに失効またはリセットしてもらわなければなりません。

</Callout>

## サードパーティーのトークンを更新する

Auth0を介してIDプロバイダーのアクセストークンを更新するのに、標準的な手段はありません。IDプロバイダーのアクセストークンを更新するメカニズムは、各プロバイダーに依存します。Auth0は、特定のIDプロバイダーに対して[リフレッシュトークン](/ja-jp/secure/tokens/refresh-tokens)も保管します。保管されたトークンを使って、IDプロバイダーの新しいアクセストークンを取得できます。以下のようなIDプロバイダーがあります。

* BitBucket
* Google OAuth 2.0（Auth0 `/authorize`エンドポイントを呼び出すときに、パラメーター`access_type=offline`、および 必要なスコープを含んだ`connection_scope`パラメーターを渡します）
* 他のOAuth 2.0 IDプロバイダー
* SharePoint
* Microsoft Entra ID

アクセストークンを取得したのと同じ方法でリフレッシュトークンを取得できます。詳細については、上述のガイドラインをご覧ください。

## サードパーティーのトークンを検証する

一般的に、IDプロバイダーから受け取ったアクセストークンは、検証する必要はありません。発行者に渡せば、発行者が処理をします。

## もっと詳しく

* [Management APIのアクセストークン](/ja-jp/secure/tokens/access-tokens/management-api-access-tokens)