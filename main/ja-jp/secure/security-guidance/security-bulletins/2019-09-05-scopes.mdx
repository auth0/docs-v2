---
title: "メールアドレスに基づいたスコープの割り当てに関するAuth0のセキュリティ情報"
permalink: "2019-09-05-scopes"
'description': "不適切なカスタムルールコードによって認証フローに脆弱性が生じる可能性があるケースについて説明します。"
'og:title': "メールアドレスに基づいたスコープの割り当てに関するAuth0のセキュリティ情報"
'og:description': "不適切なカスタムルールコードによって認証フローに脆弱性が生じる可能性があるケースについて説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "メールアドレスに基づいたスコープの割り当てに関するAuth0のセキュリティ情報"
'twitter:description': "不適切なカスタムルールコードによって認証フローに脆弱性が生じる可能性があるケースについて説明します。"
---

## 概要

以下に当てはまる場合：

* ユーザーのメールアドレスに基づいてスコープを割り当てるルールを使用している。**かつ**
* アプリケーションが複数の接続を使用している。

スコープのセキュリティが危険にさらされている可能性があります。

## 仕組み

Auth0では、メールアドレスは接続ごとに一意でなければなりません。しかし、アプリケーションごとには制限がありません。

したがって、ユーザーAがある接続を使用してアプリケーションにサインアップし、ユーザーBが別の接続を使用して同じメールアドレスでそのアプリケーションにサインアップすることが可能です。

この状況でルールによりメールアドレスに基づいてユーザーにスコープを割り当てると、ユーザーBには、別人であるにも関わらず、ユーザーAと同じスコープが割り当てられます。

## どうすれば解決できますか？

もっとも簡単な対応策は、サインアップ後のログイン前に、ユーザーにメールアドレスの確認を要求することです。