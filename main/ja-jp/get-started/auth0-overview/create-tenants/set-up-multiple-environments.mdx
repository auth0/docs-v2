---
title: "複数環境をセットアップする"
permalink: "set-up-multiple-environments"
'description': "複数のAuth0テナントを使ってさまざまな環境を管理する方法を説明します。"
'og:title': "複数環境をセットアップする"
'og:description': "複数のAuth0テナントを使ってさまざまな環境を管理する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "複数環境をセットアップする"
'twitter:description': "複数のAuth0テナントを使ってさまざまな環境を管理する方法を説明します。"
---

Auth0では、開発・ステージング・運用環境を簡単にセットアップできます。環境ごとに新しいテナントを作成するだけで、一つひとつが確実に分離されます。Dashboardの左上のメニューにあるテナントチューザーを使うと、テナントを簡単に切り替えることができます。また、テナントごとに異なる管理者を設定することも可能です。

運用の[レート制限](/ja-jp/troubleshoot/customer-support/operational-policies/rate-limit-policy)は`Production`（運用）タグが付けられたテナントにのみ適用されます。公開前にテナントの環境タグが`Production`（運用）に設定されていることを確認し、レート制限がテナント・環境・料金体系によって異なることに留意してください。

マルチ環境には、任意の名前を付けることができます。運用環境には[カスタムドメイン](/ja-jp/customize/custom-domains)の使用を強くお勧めします。

エンタープライズサブスクリプションプランをご利用の場合には、[テナントをリンク](/ja-jp/get-started/auth0-overview/create-tenants/child-tenants)することで、開発・ステージング・テスト環境で有料機能やアップグレード機能が使える運用環境に等しい環境が作成できます。

## 環境にタグを付ける

新しいテナントを作成したら、必ず環境を指定してください。開発・ステージング・運用環境を区別するために、テナントにEnvironment（環境）タグを割り当てることができます。

テナントが多目的な場合は、上位の環境を選択します。たとえば、開発と運用の両方に使用するテナントには、**Production（運用）** タグを付けます。

1. テナントにEnvironment （環境）タグを付けるには、[［Dashboard］>［Settings（設定）］>［General（一般設定）］](https://manage.auth0.com/#/tenant/general)に移動します。

   <Frame>![Dashboard テナントの設定 一般設定タブ](/images/ja-jp/cdy7uua7fh8z/4okToiwlkNQBxwr8QGE3Rs/440d2aa39a898799edd43316486a130a/Basic_Settings_-_JP.png)</Frame>

2. **［Assign Environment Tag（環境タグの割り当て）］** で、テナントの環境を **［Development（開発）］**、**［Staging（ステージング）］** または **［Production（運用）］** に指定します。

   <Frame>![undefined](/images/ja-jp/cdy7uua7fh8z/27OH1jFXce97CSjk7TPeD7/1ee7cb22d4b19c9b10630c12ff4abcf5/Tenant_environment_tags.png)</Frame>

3. 環境を選択したら、**［Save（保存）］** をクリックします。

## 移行

[Management API v2](/ja-jp/api/management/v2)を使用すると、テナント間でアセット（[ルール](/ja-jp/customize/rules)やデータベース[接続](/ja-jp/connections)など）の移行を自動化することができます。

構成を管理しやすくするために、構成値は[Dashboard](https://manage.auth0.com/#/rules)に保存して、**ルール** や**データベース接続** のスクリプトに埋め込むことは避けてください。

たとえば、ログのURLを設定するとします。1つの方法は、ルールにハードコードすることです。

```javascript lines
function(user, context, callback){
      var log_url = 'https://someurl/log';
      ...
    }
```

ただし、開発から運用に移った時点でURLが変更される可能性が高いため、このコードは移植可能ではありません。

開発から運用に移ってもコードを使い続けるためには、[［Rules（ルール）］](https://manage.auth0.com/#/rules)セクションの使用をお勧めします。ルールを作成していない場合は、ルールを作成する必要があります。（作成済みの場合は、ステップ4に進んでください。）

1. **［Create Your First Rule（初めてルールを作成）］** をクリックします。
2. **空のルール** テンプレートを選択します。
3. 新しいルールの名前を入力し、**［Save（保存）］** をクリックします。
4. [［Dashboard］>［Rules（ルール）］](https://manage.auth0.com/#/rules)に移動して、ページの終わりまでスクロールし、構成値を設定（この例ではキー名には`log_url`、値には`https://someurl/log`を使用）してから **［Create（作成）］** をクリックします。
5. これでルールを書く準備ができました。作成したルールを編集し、コード領域に以下のコードを入力してから、**［Save（保存）］** をクリックします。

   ```javascript lines
   function(user, context, callback){
         var log_url = configuration.log_url;
         ...
       }
   ```

   

   

このコードは移植可能なため、運用に移行する際に必要なのは設定を変更することだけで、スクリプトを探す必要がありません。

## AD/LDAPコネクター

AD/LDAPで複数のAuth0テナントを使用する場合は、AD/LDAP接続を作成して、各テナント用にAD/LDAPコネクターをセットアップする必要があります。これは、それぞれのAD/LDAPコネクターが、Auth0テナント内で特定の接続に関連付けられているためです。

複数のAD/LDAPコネクターが同じAD・LDAPディレクトリを指すことはできますが、AD/LDAPコネクターは、それぞれ、Auth0テナント内にある1つの接続によってのみ使用されます。

複数のAD/LDAPディレクトリがあり、それを照会してユーザー認証を行う（たとえば、異なる部署・顧客が独自のディレクトリを使用できるようにする）場合は、各Auth0テナント内に複数のAD/LDAPコネクターをセットアップできます。

## もっと詳しく

* [複数のテナントの作成](/ja-jp/get-started/auth0-overview/create-tenants/create-multiple-tenants)
* [テナントを削除またはリセットする](/ja-jp/troubleshoot/customer-support/manage-subscriptions/delete-or-reset-tenant)
* [複数のテナントをシングルサブスクリプションでリンクする](/ja-jp/get-started/auth0-overview/create-tenants/child-tenants)