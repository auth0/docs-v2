---
title: "Expoアプリケーションにログインを追加する"
permalink: "interactive"
'description': "このガイドでは、ExpoアプリケーションにAuth0 React Native SDKを使ってAuth0を統合し、認証の追加とユーザープロファイル情報の表示を行う方法について説明します。"
'og:title': "Expoアプリケーションにログインを追加する"
'og:description': "このガイドでは、ExpoアプリケーションにAuth0 React Native SDKを使ってAuth0を統合し、認証の追加とユーザープロファイル情報の表示を行う方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/media/platforms/react.png"
'twitter:title': "Expoアプリケーションにログインを追加する"
'twitter:description': "このガイドでは、ExpoアプリケーションにAuth0 React Native SDKを使ってAuth0を統合し、認証の追加とユーザープロファイル情報の表示を行う方法について説明します。"
sidebarTitle: Expo
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import App from "/snippets/quickstart/native/react-native-expo/App.js.mdx";
import App2 from "/snippets/quickstart/native/react-native-expo/App.js2.mdx";
import App3 from "/snippets/quickstart/native/react-native-expo/App.js3.mdx";
import App4 from "/snippets/quickstart/native/react-native-expo/App.js4.mdx";
import App5 from "/snippets/quickstart/native/react-native-expo/App.js5.mdx";
import App6 from "/snippets/quickstart/native/react-native-expo/App.js6.mdx";

export const sections = [
  { id: "auth0を構成する", title: "Auth0を構成する" },
  { id: "依存関係をインストールする", title: "依存関係をインストールする" },
  { id: "auth0構成プラグインをセットアップする", title: "Auth0構成プラグインをセットアップする" },
  { id: "ネイティブソースコードを生成する", title: "ネイティブソースコードを生成する" },
  { id: "auth0providerコンポーネントを構成する", title: "Auth0Providerコンポーネントを構成する" },
  { id: "アプリケーションにログインを追加する", title: "アプリケーションにログインを追加する" },
  { id: "アプリケーションにログアウトを追加する", title: "アプリケーションにログアウトを追加する" },
  { id: "ユーザープロファイル情報を表示する", title: "ユーザープロファイル情報を表示する" }
]

<Recipe>
  <Content>
    このクイックスタートは、Expoフレームワーク用です。React NativeアプリケーションにAuth0を統合するには、「React Nativeクイックスタート」を参照してください。

    <Warning>
    このSDKは「Expo Go」アプリと互換性がありません。互換性があるのはカスタム開発クライアントとEASビルドのみです。
    </Warning>

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Auth0のサービスを利用するには、Auth0 Dashboadに設定済みのアプリケーションがある必要があります。Auth0アプリケーションは、プロジェクトに認証を構成する場所です。

      ### アプリケーションを構成する

      対話型のセレクターを使ってAuth0アプリケーションを新規作成するか、統合したいプロジェクトを表す既存のアプリケーションを選択します。Auth0のすべてのアプリケーションには英数字からなる一意のクライアントIDが割り当てられており、アプリケーションのコードがSDKを通じてAuth0 APIを呼び出す際に使用されます。

      このクイックスタートを使って構成されたすべての設定は、[Dashboard](https://manage.auth0.com/)のアプリケーションを自動更新します。今後、アプリケーションの管理もDashboardで行えます。

      完了済みの構成を見てみたい場合は、サンプルアプリケーションをご覧ください。

      ### Callback URLとログアウトURLを構成する

      Auth0はCallback URLとログアウトURLを呼び出して、ユーザーをアプリケーションにリダイレクトで戻します。Auth0は、ユーザーを認証した後にCallback URLを呼び出し、セッションのクッキーを削除した後にログアウトURLを呼び出します。Callback URLとログアウトURLを設定しないと、ユーザーはアプリにログインやログアウトが行えなくなり、アプリケーションにエラーが発生します。

      アプリのプラットフォームに合わせて、対応するURLを**Callback URL** と**ログアウトURL** に追加します。カスタムドメインを使っている場合は、Auth0テナントのドメインではなく、カスタムドメインの値を使用してください。

      #### iOS

      `BUNDLE_IDENTIFIER.auth0://{yourDomain}/ios/BUNDLE_IDENTIFIER/callback`

      #### Android

      `PACKAGE_NAME.auth0://{yourDomain}/android/PACKAGE_NAME/callback`

      <Info>
      サンプルプロジェクトに沿って進めている場合には、次の値を使用します：

      - iOS：`com.auth0samples.auth0://{yourDomain}/ios/com.auth0samples/callback`
      - Android：`com.auth0samples.auth0://{yourDomain}/android/com.auth0samples/callback`
      </Info>
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      このセクションでは、React Native Auth0モジュールをインストールする方法について説明します。

      <Info>
      React Nativeの追加情報については、[公式ドキュメント](https://facebook.github.io/react-native/)を参照してください。
      </Info>

      ### Yarn

      `yarn add react-native-auth0`

      <Info>
      `yarn`の詳細については、[公式ドキュメント](https://yarnpkg.com/en/docs)を確認してください。
      </Info>

      ### npm

      `npm install react-native-auth0 --save`
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      Auth0パッケージはカスタムネイティブコードを実行し、これはビルド時に構成しておく必要があります。これを実現するには、[Expo構成プラグイン](https://docs.expo.dev/guides/config-plugins/)を使用します。

      `react-native-auth0`プラグインが[Expo構成](https://docs.expo.dev/workflow/configuration/)に追加されます。
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      上記の構成を設定するには、ネイティブコードを生成する必要があります。これを行うには、次のコマンドを実行します：

      `expo prebuild`

      Expoの構成に存在しない場合には、[Androidパッケージ](https://github.com/expo/fyi/blob/main/android-package.md)と[iOSバンドル識別子](https://github.com/expo/fyi/blob/main/bundle-identifier.md)の提供が促されます。

      <AuthCodeBlock icon="file-code">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      これらの値は、Callback URLとログアウトURLの設定に使用されます。
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      `useAuth0`フックはReact Contextに依存して状態を管理します。このコンテキストは`Auth0Provider`コンポーネントが提供します。

      `react-native-auth0`パッケージから`useAuth0`フックと`Auth0Provider`コンポーネントをインポートします：

      <AuthCodeBlock icon="file-code" language="js">
      AUTH0_SECRET='use [openssl rand -hex 32] to generate a 32 bytes value'
      APP_BASE_URL='http://localhost:3000'
      AUTH0_DOMAIN='https://{USER_DOMAIN}'
      AUTH0_CLIENT_ID='{USER_CLIENT_ID}'
      AUTH0_CLIENT_SECRET='{USER_CLIENT_SECRET}'
      </AuthCodeBlock>

      SDKが正しく機能するためには、アプリケーションを`Auth0Provider`コンポーネントでラップし、次のプロパティを設定しなければなりません：

      - `domain`：Auth0テナントのドメインです。通常、Auth0 Dashboardにある**アプリケーションの設定** の**［Domain（ドメイン）］** フィールドで確認できます。カスタムドメインを使用している場合には、この値をカスタムドメインの値に設定してください。
      - `clientId`：このクイックスタートで前にセットアップした、Auth0アプリケーションのクライアントIDです。これは、Auth0 Dashboardにある**アプリケーションの設定** の**［Client ID（クライアントID）］** フィールドで確認できます。

      <Note>
      ##### チェックポイント
      Auth0Providerコンポーネントが構成されました。アプリケーションを実行して次の点を確認します：
      SDKが正しく初期化している
      アプリケーションがAuth0に関連したエラーを投入していない
      </Note>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      ユーザーを認証するには、`useAuth0`フックが提供する`authorize`メソッドを呼び出します。これは、認証のためにユーザーをAuth0のユニバーサルログインページへリダイレクトし、アプリへ戻します。

      ユーザーのログインが成功したことを確認するには、フックの提供する`user`プロパティが`null`でないことを確認してください。

      <Note>
      ##### チェックポイント
      クリックでauthorizeを呼び出すボタンコンポーネントを追加します。ログインページにリダイレクトされてから、アプリケーションに戻されることを確認します。
      </Note>
      </Section>

      <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      ユーザーをログアウトさせるには、`clearSession`を呼び出して、ユーザーをAuth0のログアウトエンドポイントにリダイレクトします。そうすると、ユーザーのセッションが認可サーバーから削除され、ユーザーがアプリケーションからログアウトされます。

      <Note>
      ##### チェックポイント
      clearSessionを呼び出すログアウトボタンを追加して、Auth0のログアウトエンドポイントにリダイレクトされ、再び戻されることを確認してください。アプリケーションにはログインされていないはずです。
      </Note>
      </Section>

      <Section id={sections[7].id} title={sections[7].title} stepNumber="8">
      `useAuth0`フックは、認証済みユーザーの情報を含む`user`オブジェクトを公開します。これを使用すれば、認証済みユーザーについてデコードされたユーザープロファイル情報に、[IDトークン](/ja-jp/secure/tokens/id-tokens)からアクセスできます。

      ユーザーが認証されていない場合、このプロパティは`null`になります。

      <Note>
      ##### チェックポイント
      ログインして、結果のuserプロパティを調査します。emailやnameなど、現在のユーザーのプロファイル情報を確認します。
      </Note>
      </Section>

    ## 次のステップ

    成功です！ここまで来れば、アプリケーションにログイン、ログアウト、ユーザープロファイル情報が備わっているはずです。

    これでクイックスタートチュートリアルは終了ですが、機能はまだまだたくさんあります。Auth0でできることについて詳しくは、以下をご覧ください。

    *   [Auth0 Dashboard](https://manage.auth0.com/#) - Auth0のテナントやアプリケーションを構成して管理する方法について説明します
    *   [react-native-auth0 SDK](https://github.com/auth0/react-native-auth0) - このチュートリアルで使用されているSDKをより詳しく説明します
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0の機能性を拡張できる各種の統合を見つけられます
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <App />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <App2 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <App3 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <App4 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[6].id}>
        <App5 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[7].id}>
        <App6 />
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
